"use strict";(self.webpackChunkcoeqwal_website=self.webpackChunkcoeqwal_website||[]).push([[805],{4805:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.r(e),a.d(e,{default:()=>p});a(5043);var r=a(4096),s=a(6313),o=a(5621),i=a(4654),c=a(4293),l=a(9336),d=a(579),u=t([s,o,i,c,l]);function p(){const t=(0,l.A)();return(0,d.jsxs)(r.B.Provider,{value:t,children:[(0,d.jsxs)("div",{className:"bubbles-wrapper",children:[(0,d.jsx)("div",{id:"mosaic-webgl"}),(0,d.jsx)("svg",{id:"mosaic-svg",children:(0,d.jsx)("g",{className:"svg-trans"})})]}),(0,d.jsx)(i.A,{}),(0,d.jsx)(s.A,{}),(0,d.jsx)(o.A,{}),(0,d.jsx)(c.A,{}),t.goBack&&(0,d.jsx)("button",{className:"go-back-btn",onClick:t.goBack,children:(0,d.jsx)("span",{children:"\u2190"})})]})}[s,o,i,c,l]=u.then?(await u)():u,n()}catch(h){n(h)}}))},4096:(t,e,a)=>{a.d(e,{B:()=>n});const n=(0,a(5043).createContext)({})},3408:(t,e,a)=>{a.d(e,{Qj:()=>l,Uy:()=>c,fq:()=>i});var n=a(1676);const r=40,s=3;let o=0;function i(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.scaleLinear();return function(n){return n.map((n=>({x:-t,y:e-a(n)*e-e/2,width:2*t,height:2*e})))}}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.each((function(t){const e=n.select(this),a=e.attr("cur-level")||0;e.attr("prev-level",a),e.attr("cur-level",t.y)})),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(n.easeQuad).attrTween("transform",(function(t,a){const s=n.select(this),o=parseFloat(s.attr("prev-level")),i=Math.abs(o-t.y)/200*e;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*i+.5),4*Math.PI))*i*r*(1-t),", ",0,", ",0,")")}));return t.transition("liquidLevel").ease(n.easeElasticOut.period(.6)).delay(((e,a)=>a*(100/t.size()))).duration(1e3)}function l(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;return function(i){const c=o++;i.append("defs").attr("class","clip-def").append("clipPath").attr("id","bucket-mask-"+c).append("path").attr("class","bucket-mask-path"),i.append("g").attr("class","masked-area").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("clip-path","url(#bucket-mask-".concat(c,")")),i.append("path").attr("class","bucket-outline").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",s).attr("fill","none"),i.call(function(t){let{drawFunc:e,drawOutlineFunc:a=e,width:r,height:s}=t;return function(t){const o=t=>{const e=n.path();return t(e,r,s),e.toString()};t.select(".bucket-mask-path").attr("d",o(e)),t.select(".bucket-outline").attr("d",o(a))}}({drawFunc:a,drawOutlineFunc:r,width:t,height:e}))}}function d(t,e,a){u(t,e,a,!0)}function u(t,e,a,n){const r=.8*e/2,s=-.8*e/2;t.moveTo(e/2,-a/2),t.lineTo(r,a/2),t.lineTo(s,a/2),t.lineTo(-e/2,-a/2),n&&t.closePath()}},1684:(t,e,a)=>{a.d(e,{E3:()=>r,Hf:()=>c,YW:()=>s,kd:()=>i,m8:()=>o});var n=a(1676);a(3408);function r(t,e,a){let r=t.map((t=>Math.round(t.length/e))),s=n.sum(r);for(;s>a;)r[n.minIndex(t,((t,a)=>0!==t.length?t.length/e-r[a]:1/0))]-=1,s=n.sum(r);for(;s<a;)r[n.maxIndex(t,((t,a)=>0!==t.length?t.length/e-r[a]:-1/0))]+=1,s=n.sum(r);return r}const s=t=>n.interpolateBlues(n.scaleLinear([.2,1])(t));function o(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}function i(t,e,a){return n.range(a).map((n=>n/(a-1)*(e-t)+t))}function c(t,e){let a=0;return n=>(a=>0!=a&&Math.abs(t[a-1].y-t[a].y)<e)(n)?-3*++a:a=0}},3054:(t,e,a)=>{a.d(e,{w:()=>o});var n=a(9128),r=a(4956),s=a(579);function o(t){let e,a,o,{appCtx:i,handleClickFilter:c,handleClickExamine:l,handleClickDeselectAll:d,handleClickCompare:u}=t;return(0,r.ad)(i.state,"WideView")&&(e=(0,s.jsxs)("button",{onClick:c,className:"wide-view-action-btn fancy-font",children:[(0,s.jsx)(n.YOb,{}),(0,s.jsx)("span",{children:"Filter"})]}),1===i.activeWaterdrops.length?a=(0,s.jsxs)("button",{onClick:l,className:"wide-view-action-btn fancy-font",children:[(0,s.jsx)(n.WEK,{}),(0,s.jsx)("span",{children:"examine"})]}):i.activeWaterdrops.length&&(o=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:u,className:"wide-view-action-btn fancy-font",children:[(0,s.jsx)(n.IS1,{}),(0,s.jsx)("span",{children:"compare"})]}),(0,s.jsx)("button",{onClick:d,className:"fancy-font supplement-btn",children:(0,s.jsx)("span",{children:"deselect all"})})]}))),(0,s.jsxs)(s.Fragment,{children:[e,a,o]})}},4353:(t,e,a)=>{a.d(e,{A:()=>d});var n=a(1676),r=a(5043),s=a(3408),o=a(1684),i=a(579);const c=10;function l(t,e,a){const n=a/2,r=2*n/3,s=r/2,o=s/3,i=o/2;t.moveTo(r/2,-a/2),t.lineTo(-n/2+o,-a/2),t.arc(-n/2+o,-a/2+o,o,3*Math.PI/2,Math.PI,!0),t.lineTo(-n/2,a/2-o),t.arc(-n/2+o,a/2-o,o,Math.PI,Math.PI/2,!0),t.lineTo(n/2-o,a/2),t.arc(n/2-o,a/2-o,o,Math.PI/2,0,!0),t.lineTo(n/2,-a/2+o),t.arc(n/2-o,-a/2+o,o,0,3*Math.PI/2,!0),t.lineTo(r/2,-a/2),t.lineTo(r/2,-a/2-s+i),t.arc(r/2-i,-a/2-s+i,i,0,3*Math.PI/2,!0),t.lineTo(-r/2+i,-a/2-s),t.arc(-r/2+i,-a/2-s+i,i,3*Math.PI/2,Math.PI,!0),t.lineTo(-r/2,-a/2)}function d(t){let{levelInterp:e,maxValue:a=100,colorInterp:d=o.YW,width:u=200,height:h=400,resolution:p=c}=t;const m={top:1.5+h/6,right:1.5,bottom:1.5,left:1.5},f=(0,r.useRef)();return(0,r.useLayoutEffect)((function(){const t=f.current.attr("width",u+m.left+m.right).attr("height",h+m.top+m.bottom).append("g").attr("class","bucket").attr("transform","translate(".concat(m.left,",").concat(m.top,")"));t.call((0,s.Qj)(u,h,l));const e=n.path();!function(t,e,a){const n=a/2*2/3,r=n/2,s=r/3/2;t.moveTo(n/2,-a/2),t.lineTo(n/2,-a/2-r+s),t.arc(n/2-s,-a/2-r+s,s,0,3*Math.PI/2,!0),t.lineTo(-n/2+s,-a/2-r),t.arc(-n/2+s,-a/2-r+s,s,3*Math.PI/2,Math.PI,!0),t.lineTo(-n/2,-a/2),t.closePath()}(e,0,h),t.append("path").attr("class","bottlecap").attr("transform","translate(".concat(u/2,", ").concat(h/2,")")).attr("stroke","none").attr("fill","lightgray").attr("d",e.toString()),t.append("g").attr("class","bottle-axis").attr("transform","translate(".concat(u/2-h/8,", ").concat(h/2,")"))}),[]),(0,r.useLayoutEffect)((function(){const t=.95,r=(0,o.kd)(0,1,p+1).map((a=>e(a)*t)),i=(0,s.fq)(u,h),c=n.scaleLinear().domain([.05*a,a]).range([h/2-h*t*.05,h/2-h*t]);f.current.select(".bottle-axis").call(n.axisRight(c).ticks(4).tickSize(12).tickFormat(n.format(".2s")));const l=f.current.select(".masked-area").selectAll(".bucket-box").data(i(r)).join("rect").attr("class","bucket-box").attr("width",(t=>t.width)).attr("height",(t=>t.height)).attr("x",(t=>t.x)).attr("fill",((t,e)=>d(e/p)));(0,s.Uy)(l,200/h).attr("y",(t=>t.y))}),[e]),(0,i.jsx)("div",{className:"bottle-wrapper",children:(0,i.jsx)("svg",{ref:t=>{f.current=n.select(t)}})})}},8441:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{D:()=>l});var r=a(7073),s=a(2101),o=a(579),i=t([r]);function l(t){let{id:e,bucketInterper:a,label:n}=t;return(0,o.jsxs)("div",{className:"tut-graph",children:[(0,o.jsx)("svg",{id:e}),(0,o.jsx)(s.A,{levelInterp:a,maxValue:r.A.MAX_DELIVS,width:300,height:r.A.BAR_CHART_HEIGHT,resolution:4}),(0,o.jsx)("p",{className:"fancy-font objective-label",children:n})]})}r=(i.then?(await i)():i)[0],n()}catch(c){n(c)}}))},3362:(t,e,a)=>{a.d(e,{S:()=>r});a(5043);var n=a(579);function r(t){let{onClick:e}=t;return(0,n.jsx)("div",{className:"cte",id:"cte",children:(0,n.jsxs)("div",{className:"cte-container",children:["Thus, tradeoffs must often be made when managing California's water supply. What are the ways we can manage California's water, and how do their outcomes compare? Go to the next step to find out!",(0,n.jsx)("button",{className:"fancy-font",onClick:e,children:"click to explore!"})]})})}},6332:(t,e,a)=>{a.d(e,{Y:()=>s});var n=a(5043),r=a(579);const s=(0,n.forwardRef)((function(t,e){let{id:a,children:n}=t;return(0,r.jsx)("div",{id:a,ref:e,className:"tut-text-card-wrapper",children:(0,r.jsx)("div",{className:"tut-text-card",children:(0,r.jsx)("div",{className:"tut-text-card-container",children:n})})})}))},5831:(t,e,a)=>{a.d(e,{D:()=>r});a(5043);var n=a(579);function r(){return(0,n.jsxs)("div",{className:"tut-comparer-graphics-wrapper",children:[(0,n.jsx)("p",{className:"bigdrop-describe",children:"These are all possible scenarios sorted bottom-to-top by decreasing average deliveries."}),(0,n.jsx)("svg",{id:"comparer-graphics"})]})}},8272:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{m:()=>l});a(5043);var r=a(2799),s=a(8429),o=a(579),i=t([r]);function l(t){let{appCtx:e,storyVars:a}=t;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"create-buckets-section",children:[(0,o.jsx)(s.d,{}),(0,o.jsx)(r.v,{storyVars:a,size:.4*e.appHeight})]})})}r=(i.then?(await i)():i)[0],n()}catch(c){n(c)}}))},2799:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{v:()=>d});a(5043);var r=a(7073),s=a(1802),o=a(8441),i=a(579),c=t([r,s,o]);function d(t){let{storyVars:e}=t;return(0,i.jsxs)("div",{className:"tut-graph-wrapper",children:[(0,i.jsx)(o.D,{id:"pag-bar-graph",label:s.G[r.A.PAG_OBJECTIVE].display_name,bucketInterper:e.bucketInterperPAG}),(0,i.jsx)(o.D,{id:"prf-bar-graph",label:s.G[r.A.PRF_OBJECTIVE].display_name,bucketInterper:e.bucketInterperPRF})]})}[r,s,o]=c.then?(await c)():c,n()}catch(l){n(l)}}))},8429:(t,e,a)=>{a.d(e,{d:()=>r});a(5043);var n=a(579);function r(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{children:"From Bar Graphs to Buckets"}),(0,n.jsxs)("p",{children:["This is the average yearly amount of water each group receives, specifically from the ",(0,n.jsx)("b",{children:"Central Valley Project"}),", one of two water municipalities in California."]}),(0,n.jsxs)("ul",{className:"ag-annot",children:[(0,n.jsx)("li",{children:"higher water supply"}),(0,n.jsx)("li",{children:"but more likely to be around 300-500 TAF"})]}),(0,n.jsx)("ul",{className:"ref-annot",children:(0,n.jsx)("li",{children:"consistently lower water supply"})})]})}},9246:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{k:()=>h});a(5043);var r=a(7073),s=a(1802),o=a(6531),i=a(3403),c=a(355),l=a(579),d=t([r,s,o]);function h(t){let{storyVars:e,size:a}=t;return(0,l.jsxs)("div",{className:"tut-drop-graphics-wrapper",children:[(0,l.jsx)("h2",{children:"Seeing Scenarios"}),(0,l.jsxs)("div",{className:"waterdrop-graphics-wrapper",children:[(0,l.jsx)(c.f,{objectiveLabel:s.G[r.A.PAG_OBJECTIVE].display_name,dropInterper:e.dropInterper,histData:r.A.PAG_DELIVS,histRange:[0,o.j.MAX_DELIVS],goal:e.userGoal,setGoal:t=>{e.setUserGoal(t)},size:a}),(0,l.jsx)(i.V,{variations:r.A.DROP_VARIATIONS.map((t=>({...t,interper:e.variationInterpers[t.idx],histData:r.A.VARIATIONS_DELIVS[t.idx]}))),goal:e.userGoal,setGoal:t=>{e.setUserGoal(t)},histRange:[0,o.j.MAX_DELIVS],size:a})]})]})}[r,s,o]=d.then?(await d)():d,n()}catch(u){n(u)}}))},7187:(t,e,a)=>{a.d(e,{P:()=>s});a(5043);var n=a(972),r=a(579);function s(t){let{connectLine:e}=t;return(0,r.jsx)("div",{className:"connect-line",style:(0,n.Ej)(...e),children:(0,r.jsx)("div",{className:"connect-line-container"})})}},4636:(t,e,a)=>{a.d(e,{m:()=>o});var n=a(1676),r=(a(5043),a(3999)),s=a(579);function o(t){let{setCurrentIndex:e,children:a}=t;return(0,s.jsx)(r.h,{offset:.8,onStepEnter:async t=>{var a;let{data:n,direction:r,element:s}=t;e(n.idx),"up"!==r&&(null===(a=n.animHandler)||void 0===a||a.do())},onStepExit:async t=>{var e;let{data:a,direction:n,element:r}=t;"down"!==n&&(null===(e=a.animHandler)||void 0===e||e.undo())},onStepProgress:async t=>{let{data:e,direction:a,element:r,progress:s}=t;n.select(r).select("div").style("transform","translateY(".concat(n.scaleLinear().domain([0,.2,.8,1]).range([200,0,0,200])(s),"%)")).style("opacity","".concat(n.scaleLinear().domain([0,.2,.8,1]).range([0,1,1,0])(s)))},threshold:1,children:a})}},7919:(t,e,a)=>{a.d(e,{A:()=>h});var n=a(1676),r=a(5043),s=a(1684);function o(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return function(o){a=a||1,r=r||n.extent(o);const i=o.length/a,c=n.bin().value((t=>t)).domain(r).thresholds(function(t,e,a){return n.range(a).map((n=>n/(a-1)*(e-t)+t))}(...r,Math.ceil(t/(e/i))))(o),l=(0,s.E3)(c,a,i),d=[];for(let t=0;t<l.length;t++)for(let e=0;e<l[t];e++)d.push([(c[t].x1+c[t].x0)/2,(e+.5)/i*o.length]);return d}}var i=a(9550),c=a(579);const l=20,d={top:20,right:20,bottom:45,left:20},u={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}};function h(t){let{data:e,range:a=[0,n.max(e)],goal:s,setGoal:h,width:p=600,height:m=400,shortForm:f=!1}=t;const g=(0,r.useRef)(),y=(0,r.useRef)(),A=(0,r.useRef)(),x=(0,r.useMemo)((()=>o(p,m,e.length/l,a)(e)),[e]),_=[0,e.length],v=n.scaleLinear().domain(a).range([0,p]),w=n.scaleLinear().domain(_).range([m,0]),b=x.filter((t=>t[0]>s)).length;return(0,r.useLayoutEffect)((()=>{A.current.attr("width",p+d.left+d.right).attr("height",m+d.top+d.bottom).style("pointer-events","none").append("g").attr("class","graph-area").attr("transform","translate(".concat(d.left,",").concat(d.top,")")).append("g").attr("transform","translate(0, ".concat(m,")")).call(n.axisBottom().scale(n.scaleLinear().domain(a).range([0,p])).ticks(8).tickFormat(n.format(".2s"))).call((t=>{t.selectAll("line").attr("stroke","gray"),t.selectAll("path").attr("stroke","gray"),t.selectAll("text").attr("fill","gray")})).append("text").attr("fill","black").attr("transform","translate(".concat(p/2,", ",40,")")).text("Delivery (TAF)"),g.current.style.transform="translateX(".concat(n.scaleLinear().domain(a).range([d.left,p+d.left]).clamp(!0)(s),"px)");const t=t=>t.preventDefault();let e=!1;g.current.addEventListener("mousedown",(()=>{e=!0,window.addEventListener("selectstart",t)})),document.addEventListener("mouseup",(()=>{e=!1,window.removeEventListener("selectstart",t)})),y.current.addEventListener("mousemove",(t=>{if(e&&t.target===y.current){const e=(0,i.qE)(t.offsetX,d.left,d.left+p);n.select(g.current).style("transform","translateX(".concat(e,"px)")),h(n.scaleLinear().domain([d.left,p+d.left]).range(a).clamp(!0)(t.offsetX))}}))}),[]),(0,r.useLayoutEffect)((()=>{A.current.select(".graph-area").selectAll(".icons").data(x).join((t=>t.append("g").call((t=>t.append("path"))))).attr("class","icons").call((t=>{t.selectAll("path").attr("d",n.symbol(u,m/l))})).attr("transform",(t=>"translate(".concat(v(t[0]),",").concat(w(t[1]),")"))).attr("fill",(t=>t[0]>s?"steelblue":"black")),g.current.style.transform="translateX(".concat(n.scaleLinear().domain(a).range([d.left,p+d.left]).clamp(!0)(s),"px)")}),[s,x]),(0,c.jsxs)("div",{className:"dot-histogram-wrapper",ref:t=>y.current=t,children:[(0,c.jsx)("div",{className:"pdf-razor "+(f?"short-form":""),ref:t=>g.current=t,children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("span",{children:[(0,c.jsxs)("u",{children:[x.length-b," / ",l]})," ",f?"":"yrs WILL NOT meet demand"]}),(0,c.jsxs)("span",{children:[(0,c.jsxs)("u",{children:[b," / ",l]})," ",f?"":"yrs WILL meet demand"]})]})}),(0,c.jsx)("svg",{ref:t=>{A.current=n.select(t)}})]})}},6767:(t,e,a)=>{a(1676),a(5043),a(3408),a(1684),a(579)},355:(t,e,a)=>{a.d(e,{f:()=>o});a(5043),a(6767);var n=a(7919),r=a(4353),s=a(579);function o(t){let{objectiveLabel:e,dropInterper:a,histData:o,histRange:i,goal:c,setGoal:l,size:d}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"main-waterdrop",children:[(0,s.jsx)(r.A,{levelInterp:a,maxValue:i[1],width:d,height:d,resolution:4}),(0,s.jsxs)("p",{className:"var-scen-label",children:["scenario ",(0,s.jsx)("span",{className:"scen-number",children:"0000"})]}),(0,s.jsx)("p",{className:"fancy-font objective-label",children:e})]}),(0,s.jsx)("div",{className:"main-histogram",children:(0,s.jsx)(n.A,{width:d,height:2*d/3,data:o,range:i,goal:c,setGoal:l})})]})}},2031:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{j:()=>u});var r=a(1676),s=a(5043),o=a(7073),i=a(4082),c=a(579),l=t([o,i]);function u(t){let{}=t;return(0,s.useEffect)((function(){const t=window.innerHeight,e=.9*t,a=[o.A.PAG_OBJECTIVE,o.A.PRF_OBJECTIVE],n=r.select("#tut-map-california").attr("width",e).attr("height",t),s=r.geoMercator().scale(3e3*t/800).center(i.l.CALIFORNIA_CENTER).translate([e/2,t/2]),c=[...i.l.SPATIAL_DATA.features.filter((t=>a.includes(t.properties.CalLiteID))),i.l.CALIFORNIA_OUTLINE];n.selectAll("path").data(c).join("path").attr("d",(t=>r.geoPath().projection(s)(t))).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("stroke","transparent").attr("stroke-width",1).style("transform-origin",(t=>{const[e,a]=s(t.geometry.coordinates[0][0][0]);return"".concat(e,"px ").concat(a,"px")})).attr("fill","#EFEBE0").style("filter","drop-shadow(6px 6px 18px rgba(0, 0, 0, 0.3))"),n.select(".".concat(o.A.PAG_OBJECTIVE)).attr("fill",o.A.PAG_COLOR).raise(),n.select(".".concat(o.A.PRF_OBJECTIVE)).attr("fill",o.A.PRF_COLOR).raise()}),[]),(0,c.jsx)("svg",{className:"tut-map-california",id:"tut-map-california"})}[o,i]=l.then?(await l)():l,n()}catch(d){n(d)}}))},5829:(t,e,a)=>{a.a(t,(async(t,e)=>{try{a(1676),a(5043);var n=a(7073),r=(a(579),t([n]));n=(r.then?(await r)():r)[0],e()}catch(s){e(s)}}))},8687:(t,e,a)=>{a.d(e,{A:()=>o});var n=a(1676),r=(a(5043),a(9152)),s=a(579);function o(t){let{settings:e,setColorSetting:a}=t;return(0,s.jsx)("div",{className:"scen-settings comp-settings",children:e.map(((t,e)=>(0,s.jsxs)("div",{className:"full-card",onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),title:r.xz[e],children:[(0,s.jsx)("span",{children:r.RZ[e]}),(0,s.jsx)("span",{children:r.j9[e][t]}),(0,s.jsx)("div",{className:"sett-dot-wrapper",children:n.range(r.j9[e].length).map((a=>(0,s.jsx)("span",{className:"sett-dot ".concat(a<=t?"filled":"not-filled"),style:{opacity:(a+1)/r.j9[e].length}},a)))})]},e)))})}},9083:(t,e,a)=>{a.d(e,{A:()=>o});var n=a(1676),r=(a(5043),a(9152)),s=a(579);function o(t){let{settings:e,setColorSetting:a}=t;return(0,s.jsxs)("div",{className:"scen-settings",children:[(0,s.jsx)("div",{className:"condense",children:e.map(((t,e)=>(0,s.jsxs)("div",{className:"sett-dot-wrapper",children:[(0,s.jsx)("span",{children:r.kr[e]}),n.range(t+1).map((t=>(0,s.jsx)("span",{className:"sett-dot",style:{opacity:(t+1)/r.j9[e].length}},t)))]},e)))}),(0,s.jsx)("div",{className:"full",children:(0,s.jsxs)("div",{className:"full-container",children:[(0,s.jsx)("span",{children:"The settings for this scenario are:"}),e.map(((t,e)=>(0,s.jsxs)("div",{className:"full-card",onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),title:r.xz[e],children:[(0,s.jsx)("span",{children:r.RZ[e]}),(0,s.jsx)("span",{children:r.j9[e][t]}),(0,s.jsx)("div",{className:"sett-dot-wrapper",children:n.range(r.j9[e].length).map((a=>(0,s.jsx)("span",{className:"sett-dot ".concat(a<=t?"filled":"not-filled"),style:{opacity:(a+1)/r.j9[e].length}},a)))})]},e)))]})})]})}},7940:(t,e,a)=>{a.d(e,{s:()=>o});var n=a(1676),r=a(5043),s=a(579);function o(t){let{onClick:e}=t;return(0,r.useEffect)((function(){const t=document.documentElement.scrollTop;window.addEventListener("scroll",(function(){const e=document.documentElement.scrollTop,a=Math.max(0,1-(e-t)/50);n.select(".skip-btn").style("opacity",a)}))}),[]),(0,s.jsx)("button",{className:"skip-btn",onClick:e,children:"Skip intro"})}},2101:(t,e,a)=>{a.d(e,{A:()=>u});var n=a(1676),r=a(5043),s=a(3408),o=a(1684),i=a(579);const c=10;function l(t,e,a){const n=a/2,r=2*n/3,s=r/2,o=s/3,i=o/2;t.moveTo(r/2,-a/2),t.lineTo(-n/2+o,-a/2),t.arc(-n/2+o,-a/2+o,o,3*Math.PI/2,Math.PI,!0),t.lineTo(-n/2,a/2-o),t.arc(-n/2+o,a/2-o,o,Math.PI,Math.PI/2,!0),t.lineTo(n/2-o,a/2),t.arc(n/2-o,a/2-o,o,Math.PI/2,0,!0),t.lineTo(n/2,-a/2+o),t.arc(n/2-o,-a/2+o,o,0,3*Math.PI/2,!0),t.lineTo(r/2,-a/2),t.lineTo(r/2,-a/2-s+i),t.arc(r/2-i,-a/2-s+i,i,0,3*Math.PI/2,!0),t.lineTo(-r/2+i,-a/2-s),t.arc(-r/2+i,-a/2-s+i,i,3*Math.PI/2,Math.PI,!0),t.lineTo(-r/2,-a/2)}const d=["Maximum","75th Percentile","50th Percentile","25th Percentile","Minimum"];function u(t){let{levelInterp:e,maxValue:a=100,colorInterp:u=o.YW,width:h=200,height:p=400,resolution:m=c}=t;const f={top:1.5+p/6,right:1.5,bottom:21.5,left:180},g=(0,r.useRef)();return(0,r.useLayoutEffect)((function(){const t=g.current.attr("width",h+f.left+f.right).attr("height",p+f.top+f.bottom).append("g").attr("class","bucket").attr("transform","translate(".concat(f.left,",").concat(f.top,")"));t.call((0,s.Qj)(h,p,l));const e=n.path();!function(t,e,a){const n=a/2*2/3,r=n/2,s=r/3/2;t.moveTo(n/2,-a/2),t.lineTo(n/2,-a/2-r+s),t.arc(n/2-s,-a/2-r+s,s,0,3*Math.PI/2,!0),t.lineTo(-n/2+s,-a/2-r),t.arc(-n/2+s,-a/2-r+s,s,3*Math.PI/2,Math.PI,!0),t.lineTo(-n/2,-a/2),t.closePath()}(e,0,p),t.append("path").attr("class","bottlecap").attr("transform","translate(".concat(h/2,", ").concat(p/2,")")).attr("stroke","none").attr("fill","lightgray").attr("d",e.toString()),t.append("g").attr("class","bottle-axis").attr("transform","translate(".concat(h/2-p/8,", ").concat(p/2,")"))}),[]),(0,r.useLayoutEffect)((function(){const t=.95,r=(0,o.kd)(0,1,m+1).map((a=>e(a)*t)),i=(0,s.fq)(h,p)(r),c=n.scaleLinear().domain([.05*a,a]).range([p/2-p*t*.05,p/2-p*t]);g.current.select(".bottle-axis").call(n.axisRight(c).ticks(4).tickSize(12).tickFormat(n.format(".2s")));const l=g.current.select(".masked-area").selectAll(".bucket-box").data(i).join("rect").attr("class","bucket-box").attr("width",(t=>t.width)).attr("height",(t=>t.height)).attr("x",(t=>t.x)).attr("fill",((t,e)=>u(e/m)));(0,s.Uy)(l,200/p).attr("y",(t=>t.y));const f=i.reverse(),y=(0,o.Hf)(f,30),A=g.current.select(".bucket").selectAll(".bucket-label").data(f).join((t=>t.append("g").call((t=>{t.append("rect"),t.append("text")})))).attr("class","bucket-label").transition().attr("transform",((t,e)=>"translate(".concat(-88+y(e),", ").concat(t.y+p/2,")")));A.select("text").text(((t,e)=>d[i.length-1-e])).style("fill",((t,e)=>e>i.length/2?"black":"white")),A.select("rect").attr("width",170).attr("height",30).attr("x",-85).attr("y",-15).attr("rx",8).style("fill",((t,e)=>u((i.length-1-e)/m)))}),[e]),(0,i.jsx)("div",{className:"bottle-wrapper",children:(0,i.jsx)("svg",{ref:t=>{g.current=n.select(t)}})})}},2288:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>l});a(5043);var r=a(7940),s=a(2031),o=a(579),i=t([s]);function l(t){let{appCtx:e}=t;return(0,o.jsx)("div",{className:"tut-hero",children:(0,o.jsxs)("div",{className:"tut-hero-container",children:[(0,o.jsxs)("h1",{children:["Watering ",(0,o.jsx)("br",{})," the Future"]}),(0,o.jsx)(s.j,{}),(0,o.jsx)("p",{children:"Water is limited in California, yet everyone needs it. So how can we deal with the agricultural, environmental, urban, and other water demands of California?"}),(0,o.jsxs)("p",{children:["To start off, we'll focus on two groups: the"," ",(0,o.jsx)("span",{id:"ag-group",children:"agriculture group in the north"})," and the"," ",(0,o.jsx)("span",{id:"ref-group",children:"refuge group in the south."})]}),(0,o.jsx)("p",{children:"Click on the green button on the bottom-right, or scroll through this page, to explore!"}),(0,o.jsx)(r.s,{onClick:()=>e.setState({state:"WideView"})})]})})}s=(i.then?(await i)():i)[0],n()}catch(c){n(c)}}))},3403:(t,e,a)=>{a.d(e,{V:()=>o});a(5043),a(6767);var n=a(7919),r=a(4353),s=a(579);function o(t){let{variations:e,goal:a,setGoal:o,histRange:i,size:c}=t;return e.map((t=>{let{idx:e,scen:l,clas:d,desc:u,interper:h,histData:p}=t;return(0,s.jsxs)("div",{className:"vardrop ".concat(d),desc:u,children:[(0,s.jsx)(r.A,{levelInterp:h,maxValue:i[1],width:.7*c,height:.7*c,resolution:4}),(0,s.jsxs)("p",{className:"var-scen-label",children:["scenario ",(0,s.jsx)("span",{className:"scen-number",children:l})]}),(0,s.jsx)(n.A,{shortForm:!0,width:c,height:2*c/3,data:p,range:i,goal:a,setGoal:o})]},e)}))}},3693:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{G:()=>i});var r=a(4956);async function o(){console.log("DATA: loading descriptions data");const t=await(await fetch("./descriptions.json")).json();return(0,r.Et)(t,(t=>{let{id:e}=t;return e}))}const i=await o();n()}catch(s){n(s)}}),1)},1802:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{G:()=>i});var r=a(4956);async function o(){console.log("DATA: loading descriptions tutorial data");const t=await(await fetch("./descriptions_tutorial.json")).json();return(0,r.Et)(t,(t=>{let{id:e}=t;return e}))}const i=await o();n()}catch(s){n(s)}}),1)},8058:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{j:()=>u});var r=a(1676),s=a(9152),o=a(9550),i=a(4956);const l=1;async function d(){const t="scens",e="delivs",a="expl0000",n=await async function(){console.log("DATA: loading objectives data");const a=await(await fetch("./objectives_v3.json")).json(),n=a[0][t].filter(((t,e)=>e%l===0||"expl0000"===t)).map((t=>{let{name:e}=t;return e}));for(const s of a){const a=(0,o.k4)(s[t]);for(let t=a.length-1;t>=0;t--){const s=a[t];n.includes(s.name)?s[e].sort(r.descending):a.splice(t,1)}s[t]=(0,i.Et)(s[t],(t=>{let{name:e}=t;return e}))}return(0,i.Et)(a,(t=>{let{obj:e}=t;return e}))}(),c=Object.keys(n),d=function(){const t={};for(let e=0;e<c.length;e++)t[c[e]]=0;return t}(),u=Object.keys(Object.values(n)[0][t]),h=function(){const t={},e=Object.values(s.hU);for(let a=0;a<u.length;a++){const n=u[a];t[n]=(0,s.iu)(n.slice(4)).map(((t,a)=>(t+1)/e[a]))}return t}(),p=function(){const s={};for(const o of c){const i=r.max(n[o][t][a][e]);r.min(u.map((a=>r.min(n[o][t][a][e]))));s[o]=[0,i];for(const a of u)s[o][a]=r.extent(n[o][t][a][e])}return s}(),[m,f]=function(){const a=[],s={objective:{}},o=[];let i=0;for(const d of c)for(const c of u){s.objective[d]||(s.objective[d]=[]),s.objective[d].push(i);const l=n[d][t][c][e],u=r.range(l);a.push({id:i,objective:d,scenario:c,deliveries:l,minmax:u}),o.push(r.mean(l)),i++}const l={};for(const t of Object.keys(s)){const e=[];for(const i of Object.keys(s[t])){const n=s[t][i],c=n.sort(((t,e)=>o[e]-o[t]));e.push({key:i,sorted:c,mean:r.mean(n.map((t=>{const e=a[t].deliveries,n=p[a[t].objective][1];return e.map((t=>t/n))})).flat())})}const n=e.sort(((t,e)=>e.mean-t.mean));l[t]={};for(let r=0;r<n.length;r++){const{key:e,sorted:s}=n[r],o={};for(let t=0;t<s.length;t++)o[a[s[t]].scenario]=t;l[t][e]=o,l[t][e].rank=r}}return[a,l]}();return{MAX_DELIVS:1200,SCENARIO_KEY_STRING:t,DELIV_KEY_STRING:e,BASELINE_SCEN:a,OBJECTIVES_DATA:n,OBJECTIVE_IDS:c,OBJECTIVE_GOALS_MAP:d,SCENARIO_IDS:u,KEY_SETTINGS_MAP:h,MIN_MAXES:p,FLATTENED_DATA:m,DATA_GROUPINGS:f}}const u=await d();n()}catch(c){n(c)}}),1)},6531:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{j:()=>d});var r=a(1676),s=a(9152),o=a(9550),i=a(4956);async function l(){const t="scens",e="delivs",a="baseline_yearly",n="expl0000",c=await async function(){console.log("DATA: loading objectives tutorial data");const s=await(await fetch("./objectives_tutorial.json")).json();for(const c of s){for(const s of(0,o.k4)(c[t]))s.name===n&&(c[a]=Array.from(s[e])),s[e]=s[e].sort(r.descending);c[t]=(0,i.Et)(c[t],(t=>{let{name:e}=t;return e}))}return(0,i.Et)(s,(t=>{let{obj:e}=t;return e}))}(),l=Object.keys(c),d=function(){const t={};for(let e=0;e<l.length;e++)t[l[e]]=200;return t}(),u=Object.keys(Object.values(c)[0][t]),h=function(){const t={},e=Object.values(s.hU);for(let a=0;a<u.length;a++){const n=u[a];t[n]=(0,s.iu)(n.slice(4)).map(((t,a)=>(t+1)/e[a]))}return t}(),p=function(){const a={};for(const s of l){const o=r.max(c[s][t][n][e]);r.min(u.map((a=>r.min(c[s][t][a][e]))));a[s]=[0,o]}return a}(),[m,f]=function(){const a=[],n={objective:{}},s=[];let o=0;for(const d of l)for(const i of u){n.objective[d]||(n.objective[d]=[]),n.objective[d].push(o);const l=c[d][t][i][e];a.push({id:o,objective:d,scenario:i,deliveries:l}),s.push(r.mean(l)),o++}const i={};for(const t of Object.keys(n)){const e=[];for(const i of Object.keys(n[t])){const o=n[t][i],c=o.sort(((t,e)=>s[e]-s[t]));e.push({key:i,sorted:c,mean:r.mean(o.map((t=>{const e=a[t].deliveries,n=p[a[t].objective][1];return e.map((t=>t/n))})).flat())})}const o=e.sort(((t,e)=>e.mean-t.mean));i[t]={};for(let n=0;n<o.length;n++){const{key:e,sorted:r}=o[n],s={};for(let t=0;t<r.length;t++)s[a[r[t]].scenario]=t;i[t][e]=s,i[t][e].rank=n}}return[a,i]}();return{MAX_DELIVS:800,SCENARIO_KEY_STRING:t,DELIV_KEY_STRING:e,BASELINE_YRLY_KEY_STRING:a,BASELINE_SCEN:n,OBJECTIVES_DATA:c,OBJECTIVE_IDS:l,OBJECTIVE_GOALS_MAP:d,SCENARIO_IDS:u,KEY_SETTINGS_MAP:h,MIN_MAXES:p,FLATTENED_DATA:m,DATA_GROUPINGS:f}}const d=await l();n()}catch(c){n(c)}}),1)},4082:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{l:()=>i});var r=a(4956);async function o(){const t=await async function(){console.log("DATA: loading callite spatial data");return await(await fetch("./callite_spatial.json")).json()}(),e=(0,r.Et)(t.features,(t=>{let{properties:e}=t;return e.CalLiteID})),a=await async function(){console.log("DATA: loading california spatial data");return await(await fetch("./california.json")).json()}();return{SPATIAL_DATA:t,SPATIAL_FEATURES:e,CALIFORNIA_OUTLINE:a,CALIFORNIA_CENTER:[-119,37.7749]}}const i=await o();n()}catch(s){n(s)}}),1)},9336:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>m});var r=a(1676),s=a(5043),o=a(3956),i=a(8058),c=a(3693),l=a(6924),d=t([i,c]);[i,c]=d.then?(await d)():d;const h=window.innerWidth,p=window.innerHeight;function m(){const[t,e]=(0,s.useState)({}),[a,n]=(0,s.useState)([]),[d,u]=(0,s.useState)({}),[m,f]=(0,s.useState)(null),[g,y]=(0,s.useState)(i.j.OBJECTIVE_GOALS_MAP),A=(0,s.useRef)([]),x=(0,s.useRef)(!1);(0,s.useEffect)((function(){const t=(0,l.c)(i.j,c.G);o.e.renderer.setSize(h,p),console.time("drops mesh creating"),o.e.dropsMesh.createMesh(t),console.timeEnd("drops mesh creating"),document.querySelector("#mosaic-webgl").appendChild(o.e.renderer.domElement),r.select("#mosaic-svg").attr("width",h).attr("height",p);const a=r.scaleLinear().domain([p/t.height,p/t.groups[0].height]).range([.1,1]).clamp(!0);o.e.camera.create({width:h,height:p,webglElement:r.select(".bubbles-wrapper").node(),svgElement:r.select("#mosaic-svg").select(".svg-trans").node(),zoomFn:t=>{x.current||o.e.dropsMesh.updateOutlineVisibility(a(t.k));for(const e of A.current)e(t)}}),o.e.renderer.setAnimationLoop((()=>{o.e.renderer.render(o.e.scene,o.e.camera.camera)})),u(t),e({state:"TutorialView"})}),[]);const _=(0,s.useCallback)((function(t){const e=(0,l.c)(i.j,c.G,t);o.e.dropsMesh.updateMeshes(e),u(e)}),[]),v=(0,s.useCallback)((function(){const t=r.scaleLinear().domain([p/d.height,p/d.groups[0].height]).range([.1,1]).clamp(!0);o.e.camera.setZoomFn((e=>{x.current||o.e.dropsMesh.updateOutlineVisibility(t(e.k));for(const t of A.current)t(e)}))}),[d]),w=(0,s.useCallback)((t=>r.scaleLinear().domain([p/d.height,p/d.groups[0].height]).range([.1,1]).clamp(!0)(t)),[d]),b=(0,s.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;const a=1.2*d.height,n=[0,.08*-d.height,o.e.camera.getZFromFarHeight(a)];let r=0;if(t){const[t,a]=E(n,e);r=a,t()}else o.e.camera.callZoomFromWorldViewport({worldX:n[0],worldY:-n[1],farHeight:a}),e&&e();return r}),[d]),E=(0,s.useCallback)((function(t,e){const a=o.e.camera.interpolateZoomCamera(t),n=a.duration/2;return[()=>{const t=r.timer((r=>{const s=Math.min(r/n,1);o.e.camera.callZoom(a(s)),1===s&&(t.stop(),e&&e())}))},n]}),[]),j=(0,s.useCallback)((function(t){A.current.push(t)}),[]),I=(0,s.useCallback)((function(t){x.current=t}));return{appWidth:h,appHeight:p,state:t,setState:e,activeWaterdrops:a,setActiveWaterdrops:n,setDisableCamAdjustments:I,waterdrops:d,goBack:m,setGoBack:f,zoomTo:E,resetCamera:b,getOutlineOpacity:w,addZoomHandler:j,goals:g,setGoals:y,updateWaterdrops:_,realignCamera:v,...o.e}}n()}catch(u){n(u)}}))},9514:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{C:()=>p});var r=a(1676),s=a(5043),o=a(2385),i=a(972),c=a(9550),l=a(7073),d=a(6016),u=t([l]);function p(){const[t,e]=(0,s.useState)(),a=(0,s.useRef)(),n=(0,s.useRef)({});return(0,s.useEffect)((function(){if(t){const[e,n]=d._.calcLinesAndPositions(a.current,t);!function(e){const[n,s]=e,i=a.current.groups[0].height*o.W.SPREAD_1_2/15,c=a.current.groups[0].height*o.W.SPREAD_1_2/10;r.select("#comparer-graphics").select("#member-label").text("scenario").attr("font-size",i).transition().duration(100).attr("x",n).attr("y",s-1.5*i),r.select("#comparer-graphics").select("#member-variable").attr("font-size",c).text(t.slice(4)).transition().duration(100).attr("x",n).attr("y",s)}((0,c.p6)(e)),function(t,e){r.select("#comparer-graphics .indicator-group").selectAll(".circlet").data(t).join("circle").attr("class","circlet").call(i.JB).attr("r",1.5*o.W.LOD_1_RAD_PX).transition().duration(100).attr("cx",(t=>t[0])).attr("cy",(t=>t[1])),r.select("#comparer-graphics .indicator-group").selectAll(".comp-line").data(e).join("path").attr("class","comp-line").transition().duration(100).attr("d",(t=>r.line()(t))),r.select("#comparer-graphics .indicator-group").raise()}(e,n)}}),[t]),{initComparer:function(t,s){a.current=d._.getWaterdropGroups([l.A.PAG_OBJECTIVE,l.A.PRF_OBJECTIVE],t,[0,0],.6);const c=2*t.groups[0].height*o.W.SPREAD_1_2*1,u=s.height/c;let h=s.width/2,p=s.height/2;const m={x:h,y:p,k:u};h=-a.current.groupPositions[0].x*u+s.width/2,p=a.current.groupPositions[0].y*u+s.height/2;const f={x:h,y:p,k:u};n.current.firstDrop=f,n.current.midpoint=m;const g=r.select("#comparer-graphics").attr("width",window.innerWidth-20).attr("height",window.innerHeight).append("g").attr("class","svg-group").attr("transform",r.zoomIdentity.translate(f.x,f.y).scale(f.k));d._.updateDropsSVG(g,a.current,0,{onHover:t=>{e(t.key)}});const y=g.append("g").attr("class","indicator-group");y.append("text").attr("id","member-variable"),y.append("text").attr("id","member-label"),e(l.A.DEFAULT_SCENARIO),(0,i.f2)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),g)},showOtherDrop:function(){const t=r.select("#comparer-graphics");t.select(".svg-group").transition().attr("transform",r.zoomIdentity.translate(n.current.midpoint.x,n.current.midpoint.y).scale(n.current.midpoint.k)),(0,i.YB)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),t)},hideOtherDrop:function(){const t=r.select("#comparer-graphics");t.select(".svg-group").transition().attr("transform",r.zoomIdentity.translate(n.current.firstDrop.x,n.current.firstDrop.y).scale(n.current.firstDrop.k)),(0,i.f2)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),t)}}}l=(u.then?(await u)():u)[0],n()}catch(h){n(h)}}))},4757:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{R:()=>u});var r=a(5043),s=a(9514),o=a(419),i=a(5413),c=a(7066),l=t([s,o,i]);function u(t,e){const[a,n]=(0,r.useState)([]),[c,l]=(0,r.useState)(0),d=(0,o.d)(),u=(0,s.C)();return{hookAnimations:(0,r.useCallback)((function(){u.initComparer(t,e);const a={deps:{...d,largeDropComparer:u}},r=(i.W.initShowLocationAnimGroup(a),i.W.initChartAnimGroup(a)),s=i.W.initBucketsFillAnim(a),o=i.W.initMoveBucketsAnim(a),c=i.W.initDropFillAnim(a),l=i.W.initChangeRealityAnim(a),h=i.W.initFillVarDropsAnim(a),p=i.W.initShowScenLabelAnim(a),m=i.W.initHighlightBestAnim(a),f=i.W.initShowQuantilesAnim(a),g=i.W.initComparerAnimGroup(a),y=[{name:"barsExplain",animHandler:r.barsAppear},{name:"barsCondense",animHandler:r.barsCondense},{name:"bucketsFill",animHandler:s},{name:"comparingTheTwo",animHandler:o},{name:"forNowLetsFocus",animHandler:c},{name:"ifChangeReality",animHandler:l},{name:"fortunateCanExplore",animHandler:h},{name:"theseVarsCalled",animHandler:p},{name:"atAGlance",animHandler:m},{name:"tryMoveRed",animHandler:f},{name:"soWhyNot",animHandler:g.showPAG},{name:"letsBringRefuge",animHandler:g.showPRF}];n(y.map(((t,e)=>({...t,idx:e}))))}),[t,e]),getSlidesInRange:(0,r.useCallback)((function(t,e){let n,r;for(let s=0;s<a.length;s++)if(a[s].name===t)n=s;else if(a[s].name===e){r=s;break}return h(a.slice(n,r+1))}),[a]),storyVars:d,index:c,setIndex:l}}function h(t){return t.map((t=>({...t,script:c.P[t.name]})))}[s,o,i]=l.then?(await l)():l,n()}catch(d){n(d)}}))},419:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{d:()=>l});var r=a(1676),s=a(5043),o=a(7073),i=t([o]);function l(){const[t,e]=(0,s.useState)(200),[a,n]=(0,s.useState)((()=>r.scaleLinear().range([0,0]))),[i,c]=(0,s.useState)((()=>r.scaleLinear().range([0,0]))),[l,d]=(0,s.useState)((()=>r.scaleLinear().range([0,0]))),[u,h]=(0,s.useState)((()=>o.A.VARIATIONS.map((()=>r.scaleLinear().range([0,0])))));return{userGoal:t,setUserGoal:e,bucketInterperPAG:a,setBucketInterperPAG:n,bucketInterperPRF:i,setBucketInterperPRF:c,dropInterper:l,setDropInterper:d,variationInterpers:u,setVariationInterpers:h}}o=(i.then?(await i)():i)[0],n()}catch(c){n(c)}}))},4987:(t,e,a)=>{a.d(e,{J:()=>o});var n=a(5043),r=a(972),s=a(4956);function o(t){const[e,a,o]=(0,s.iJ)([]),i=(0,n.useRef)({});(0,n.useEffect)((function(){window.addEventListener("mousemove",(t=>{void 0!==i.current.startX&&(i.current.deltaX=t.x-i.current.startX,i.current.deltaY=t.y-i.current.startY,a((t=>{if(void 0===i.current.startX)return t;const e=t.find((t=>t.id===i.current.id));return e.offsetX=e.oldOffsetX+i.current.deltaX,e.offsetY=e.oldOffsetY+i.current.deltaY,[...t]})))})),window.addEventListener("mouseup",(t=>{void 0!==i.current.startX&&(i.current={})}))}),[]);const c=(0,n.useCallback)((function(t,e){let{id:n}=e;""!==t.target.className&&(t.preventDefault(),i.current={startX:t.clientX,startY:t.clientY,id:n},a((t=>{const e=t.find((t=>t.id===n));return e.oldOffsetX=e.offsetX,e.oldOffsetY=e.offsetY,[...t]})))}),[]);return{panels:e,panelsRef:o,setPanels:a,onPanelDragStart:c,getPanelStyle:function(e){let{x:a,y:n,offsetX:s,offsetY:o}=e;const[i,c]=(0,r.UK)(a,n,t);return{left:"".concat(i+s,"px"),top:"".concat(c+o,"px")}}}}},2385:(t,e,a)=>{a.d(e,{W:()=>n});const n={LOD_1_LEVELS:4,LOD_1_RAD_PX:1,LOD_1_MIN_LEV_VAL:.1,LOD_1_SMALL_DROP_PAD_FACTOR:3,LOD_1_LARGE_DROP_PAD_FACTOR:1.2,LOD_2_SMALL_DROP_PAD_FACTOR:3,GROUP_HOVER_AREA_FACTOR:1.1/(1+Math.SQRT1_2),SPREAD_1_2:1}},3956:(t,e,a)=>{a.d(e,{e:()=>y});var n=a(9408),r=a(4473),s=a(8341),o=a(1676),i=a(1684),c=a(2385),l=a(4956),d=a(9550),u=a(972);class h{constructor(){this.added=!1}createMesh(t){this.dropsMesh?this.updateMeshes(t):this.initializeMeshes(t)}draw(t){this.added||(t.add(this.dropsMesh),t.add(this.outlineMesh),this.added=!0)}remove(t){this.added&&(t.remove(this.dropsMesh),t.remove(this.outlineMesh),this.added=!1)}initializeMeshes(t){const e=new g(h.MAX_POINTS_DROPS),a=[],r=(0,u.Ri)(2*c.W.LOD_1_RAD_PX*.975);for(let o=0;o<t.nodes.length;o++){const{id:s,globalX:h,globalY:p,levs:m,maxLev:f,globalTilt:g}=t.nodes[o];for(let t=m.length-1;t>=0;t--){const a=t!==m.length-1?m[t+1]:0,r=m[t],s=(0,u.O$)((0,i.m8)(a/f),(0,i.m8)(r/f),2*c.W.LOD_1_RAD_PX),l=new n.Q1f((0,i.YW)(t/c.W.LOD_1_LEVELS));e.addMeshCoords(s,{x:h,y:-p,rotate:g},l,o%5/50+.02)}const y=(0,d.Hb)((0,l.K7)(r),g);a.push(...y.map((t=>{let[e,a]=t;return new n.Pq0(h+e,-p-a,o%5/50+.01)})))}e.finish(),this.dropsMesh=new n.eaF(e.threeGeom,new n.V9B({vertexColors:!0,transparent:!0,opacity:1}));let s=(new n.LoY).setFromPoints(a);this.outlineMesh=new n.DXC(s,new n.mrM({color:13421772,transparent:!0,opacity:0})),this.dropsGeom=e,this.outlineGeom=s}updateOutlineVisibility(t){this.outlineMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0)}updateVisibility(t){this.outlineMesh&&this.dropsMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0,this.dropsMesh.material.opacity=t,this.dropsMesh.material.needsUpdate=!0)}updateMeshes(t){this.dropsGeom.clearMesh();const e=[],a=(0,u.Ri)(2*c.W.LOD_1_RAD_PX*.975);for(let r=0;r<t.nodes.length;r++){const{id:s,globalX:o,globalY:h,levs:p,maxLev:m,globalTilt:f}=t.nodes[r];for(let t=p.length-1;t>=0;t--){const e=t!==p.length-1?p[t+1]:0,a=p[t],s=(0,u.O$)((0,i.m8)(e/m),(0,i.m8)(a/m),2*c.W.LOD_1_RAD_PX),l=new n.Q1f((0,i.YW)(t/c.W.LOD_1_LEVELS));this.dropsGeom.addMeshCoords(s,{x:o,y:-h,rotate:f},l,r%5/50+.02)}const g=(0,d.Hb)((0,l.K7)(a),f);e.push(...g.map((t=>{let[e,a]=t;return new n.Pq0(o+e,-h-a,r%5/50+.01)})))}this.dropsGeom.finish(),this.outlineGeom.setFromPoints(e).setDrawRange(0,e.length),this.outlineMesh.geometry.attributes.position.needsUpdate=!0,this.dropsMesh.geometry.attributes.position.needsUpdate=!0}}h.MAX_POINTS_DROPS=198e3,h.MAX_POINTS_OUTLINE=105600;var p=(0,s.A)("THREEHandleZoom");class m{constructor(t){let{fov:e,near:a,far:r}=t;Object.defineProperty(this,p,{value:f}),this.raycaster=new n.tBo,this.fov=e,this.near=a,this.far=r}create(t){let{width:e,height:a,webglElement:r,svgElement:s,zoomFn:i}=t;this.width=e,this.height=a,this.camera=new n.ubm(this.fov,this.width/this.height,this.near,this.far+1),this.camera.position.set(0,0,this.far),this.webglView=o.select(r),this.svgView=o.select(s),this.setZoomFn(i),this.webglView.call(this.zoom),this.zoom.transform(this.webglView,o.zoomIdentity.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}setZoomFn(t){this.zoom=o.zoom().on("zoom",(e=>{this.curTransform=e.transform,(0,r.A)(this,p)[p](e.transform),this.svgView.attr("transform",e.transform),t&&t(e.transform)})).scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)])}callZoom(t){this.zoom.transform(this.webglView,o.zoomIdentity.translate(t.x,t.y).scale(t.k))}callZoomFromWorldViewport(t){let{worldX:e,worldY:a,farHeight:n}=t;const r=this.height/n,s=-e*r+this.width/2,o=a*r+this.height/2;this.callZoom({x:s,y:o,k:r})}interpolateZoomCamera(t){let[e,a,n]=t;const r=o.interpolateZoom([this.camera.position.x,this.camera.position.y,this.height/this.curTransform.k],[e,-a,this.getFarHeightFromZ(n)]),s=t=>{const[e,a,n]=r(t),s=this.height/n;return{x:-e*s+this.width/2,y:a*s+this.height/2,k:s}};return s.duration=r.duration,s}getZFromFarHeight(t){return Math.tan((0,d.eh)(90-this.fov/2))*t/2}getFarHeightFromZ(t){return Math.tan((0,d.eh)(this.fov)/2)*t*2}getScaleFromZ(t){const e=this.getFarHeightFromZ(t);return this.height/e}getZFromScale(t){const e=this.height/t;return this.getZFromFarHeight(e)}intersectObject(t,e,a){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(a)}worldToScreen(t,e){return(0,u.UK)(t,e,this.curTransform)}screenToWorld(t,e){return(0,u.UT)(t,e,this.curTransform)}}function f(t){const e=t.k,a=-(t.x-this.width/2)/e,n=(t.y-this.height/2)/e,r=this.getZFromScale(e);this.camera.position.set(a,n,r)}class g{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.threeGeom=new n.LoY,this.triangleIdx=0,this.threeGeom.setAttribute("position",new n.THS(new Float32Array(3*t),3)),e&&this.threeGeom.setAttribute("color",new n.THS(new Float32Array(3*t),3)),this.positionAttribute=this.threeGeom.getAttribute("position"),this.colorAttribute=this.threeGeom.getAttribute("color")}clearMesh(){this.triangleIdx=0}addMeshCoords(t,e,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(let r=0;r<t.length;r++){const[s,o,i]=(0,d.Hb)((0,l.K7)(t[r]),e.rotate);this.positionAttribute.setXYZ(3*this.triangleIdx+0,e.x+s[0],e.y-s[1],n),this.positionAttribute.setXYZ(3*this.triangleIdx+1,e.x+o[0],e.y-o[1],n),this.positionAttribute.setXYZ(3*this.triangleIdx+2,e.x+i[0],e.y-i[1],n),a&&(this.colorAttribute.setXYZ(3*this.triangleIdx+0,a.r,a.g,a.b),this.colorAttribute.setXYZ(3*this.triangleIdx+1,a.r,a.g,a.b),this.colorAttribute.setXYZ(3*this.triangleIdx+2,a.r,a.g,a.b)),this.triangleIdx++}}finish(){this.threeGeom.setDrawRange(0,3*this.triangleIdx)}}const y=function(){const t=function(){const t=new n.Z58;return t.background=new n.Q1f(15723488),t}(),e=new h;return{scene:t,camera:new m({fov:45,near:1,far:3e3}),renderer:new n.JeP({antialias:!0}),dropsMesh:e}}()},6016:(t,e,a)=>{a.d(e,{_:()=>l});var n=a(1676),r=a(2385),s=a(9550),o=a(972);function i(t){let{nodes:e,height:a,key:s}=t;return t=>{t.attr("class","large-drop "+s),t.append("circle").attr("class","highlight-circle").attr("stroke","none").attr("fill","yellow").attr("r",2*r.W.LOD_1_RAD_PX),t.append("g").attr("class","baseline-pointer").call((function(t){t.append("path"),t.append("text").text("baseline")})),t.append("text").style("font-size",a*r.W.SPREAD_1_2/15).attr("class","drop-label fancy-font").attr("text-anchor","middle"),t.selectAll(".small-drop").data(e).enter().append("g").attr("class","small-drop").each((function(t){n.select(this).call(function(t){let{levs:e,id:a}=t;return t=>{t.append("rect").attr("class","bbox").style("visibility","hidden");const n="compare-grad-".concat(a);t.call((0,o.ji)(e,n)),t.append("path").attr("d",o.$N).attr("class","outline").attr("transform","scale(".concat(.95*r.W.LOD_1_RAD_PX,")")),t.append("path").attr("class","fill").attr("d",o.kp).attr("fill","url(#".concat(n,")")).attr("transform","scale(".concat(r.W.LOD_1_RAD_PX,")"))}}(t))}))}}function c(t,e,a){let{nodes:i,height:c,display_name:l}=t,{isLeft:d,isBottom:u}=e;return t=>{const e={};if(t.call(function(t,e){return a=>{a.select(".drop-label").attr("x",0).attr("y",e/2*r.W.SPREAD_1_2*.9).call((0,o.Y_)(t,1.2,30))}}(l,c)).selectAll(".small-drop").data(i,(t=>t.id)).attr("display","initial").attr("transform",(t=>{let{x:e,y:a,tilt:n}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(n,")")})).each((function(t){n.select(this).call(function(t,e){let{key:a,levs:n,maxLev:r,x:s,y:i}=t;return t=>{"expl0000"===a&&(e.x=s,e.y=i),t.call((0,o.GI)(n,r));const c=t.select(".fill").node().getBBox();t.select(".bbox").attr("x",c.x).attr("y",c.y).attr("width",c.width).attr("height",c.height)}}(t,e))})).transition().delay(a).duration(1e3).attr("transform",(t=>{let{x:e,y:a,tilt:n}=t;return"translate(".concat(e*r.W.SPREAD_1_2,", ").concat(a*r.W.SPREAD_1_2,") rotate(").concat(n,")")})),void 0===e.x)return void t.selectAll(".highlight-circle, .baseline-pointer").style("visibility","hidden");t.selectAll(".highlight-circle, .baseline-pointer").style("visibility","visible"),t.select(".highlight-circle").attr("cx",e.x).attr("cy",e.y-(0,s.jF)({rad:r.W.LOD_1_RAD_PX})).transition().delay(a).duration(1e3).attr("cx",e.x*r.W.SPREAD_1_2).attr("cy",e.y*r.W.SPREAD_1_2-(0,s.jF)({rad:r.W.LOD_1_RAD_PX}));const h=e.x*r.W.SPREAD_1_2,p=e.y*r.W.SPREAD_1_2-(0,s.jF)({rad:r.W.LOD_1_RAD_PX}),m=c*r.W.SPREAD_1_2/2*(d?-1:1),f=c*r.W.SPREAD_1_2/2*(u?1:-1),g=c/20,y=c/100;t.select(".baseline-pointer path").attr("d",n.line().x((t=>t[0])).y((t=>t[1]))([[h,p],[m,f]])).attr("stroke-width",y),t.select(".baseline-pointer text").attr("class","fancy-font").attr("font-size",g).attr("text-anchor",d?"end":"start").attr("transform","translate(".concat(m+g*(d?-1:1),", ").concat(f,")"))}}const l={updateDropsSVG:function(t,e,a,r){let{onClick:s,onHover:o,onUnhover:l}=r;t.selectAll(".large-drop").data(e.groups).join((t=>t.append("g").each((function(t){n.select(this).call(i(t))})))).attr("transform",(t=>{let{x:e,y:a,tilt:n}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(n,")")})).each((function(t,r){const i=n.select(this).call(c(t,e.groupPositions[r],a)).selectAll(".small-drop");s&&i.on("click",(function(t,e){s(e)})),o&&i.on("mouseenter",(function(t,e){n.select(this.parentNode).raise(),o(e)})),l&&i.on("mouseleave",(function(t,e){l(e)}))})).transition().delay(a).duration(1e3).attr("transform",((t,a)=>"translate(".concat(e.groupPositions[a].x,", ").concat(e.groupPositions[a].y,")")))},updateColorDrops:function(t,e,a,s){t.selectAll(".color-drop-group").data(e.groups).join((t=>t.append("g").each((function(t){let{nodes:e}=t;n.select(this).call((t=>{t.attr("class","color-drop-group").selectAll(".color-drop").data(e).join("circle").attr("class","color-drop").attr("r",r.W.LOD_1_RAD_PX)}))})))).attr("transform",((t,a)=>"translate(".concat(e.groupPositions[a].x,", ").concat(e.groupPositions[a].y,")"))).each((function(){n.select(this).selectAll(".color-drop").call((t=>{t.attr("opacity",(t=>{let{key:e}=t;return a(e)})).attr("fill",s)})).attr("cx",(t=>{let{x:e}=t;return e*r.W.SPREAD_1_2})).attr("cy",(t=>{let{y:e}=t;return e*r.W.SPREAD_1_2}))}))},getWaterdropGroups:function(t,e,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.75;const s=t.map((t=>e.groups.find((e=>e.key===t)))),o=[],i=s[0].height*r.W.SPREAD_1_2*n;for(let r=0,c=s.length;r<c;r++){const t=2*Math.PI/c*(r-.5)-Math.PI/2,e=a[0]+Math.cos(t)*i,n=a[1]+Math.sin(t)*i,s=e<a[0],l=n>a[1];o.push({x:e,y:n,isLeft:s,isBottom:l})}return{groups:s,groupPositions:o}},calcLinesAndPositions:function(t,e){const a=[],n=[];for(let i=0;i<t.groups.length;i++){const o=t.groups[i],c=t.groupPositions[i],l=o.nodes.find((t=>t.key===e));n.push(l),a.push([l.x*r.W.SPREAD_1_2+c.x,l.y*r.W.SPREAD_1_2+c.y-(0,s.jF)({rad:r.W.LOD_1_RAD_PX})])}const o=[];for(let i=0;i<a.length;i++){const t=Array.from(a[i]),e=Array.from(a[i+1==a.length?0:i+1]);(0,s.D5)([t,e],2*r.W.LOD_1_RAD_PX),o.push([t,e])}return[a,o,n]},updateLabelSVG:function(t,e,a){const[r,s]=t,o=a/15,i=a/10;n.select("#compare-group").select("#member-label").text("scenario").attr("font-size",o).transition().duration(100).attr("x",r).attr("y",s-1.5*o),n.select("#compare-group").select("#member-variable").attr("font-size",i).text(e).transition().duration(100).attr("x",r).attr("y",s)},updateScenIndicatorsSVG:function(t,e){n.select("#compare-group").selectAll(".circlet").data(t).join("circle").attr("class","circlet").call(o.JB).attr("display","initial").attr("r",1.5*r.W.LOD_1_RAD_PX).raise().transition().duration(100).attr("cx",(t=>t[0])).attr("cy",(t=>t[1])),n.select("#compare-group").selectAll(".comp-line").data(e).join("path").attr("class","comp-line").raise().transition().duration(100).attr("d",(t=>n.line()(t)))}}},5413:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{W:()=>d});var r=a(1676),s=a(7073),o=a(6531),i=a(972),c=a(1684),l=t([s,o]);[s,o]=l.then?(await l)():l;const d={initShowLocationAnimGroup:function(){return{showPAG:{do:function(){r.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray")},undo:function(){r.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",1).transition().attr("fill","transparent")}},showPRF:{do:function(){r.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",1).transition().attr("fill","transparent"),r.select("#tut-minimap").select(".outline."+s.A.PRF_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray")},undo:function(){r.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray"),r.select("#tut-minimap").select(".outline."+s.A.PRF_OBJECTIVE).transition().attr("fill","transparent")}}}},initChartAnimGroup:function(){let t,e,a,n,i,l;const d=40,u=30,h=40,p=60;return function(){{const e=r.select("#pag-bar-graph").attr("width",s.A.BAR_CHART_WIDTH+p+u).attr("height",s.A.BAR_CHART_HEIGHT+d+h).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(p,",").concat(d,")")),n=o.j.OBJECTIVES_DATA[s.A.PAG_OBJECTIVE][o.j.BASELINE_YRLY_KEY_STRING].map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(((t,e)=>e.val-t.val)),c=r.scaleBand().domain(n.map((t=>{let{year:e}=t;return e})).sort(r.ascending)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4),l=r.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]),m=r.axisBottom(c).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(c.domain().filter(((t,e)=>0===e||(e+1)%10===0)));e.append("g").attr("class","anim-xaxis"),e.append("g").attr("class","axis-y"),e.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).call(m).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),e.select(".axis-y").call(r.axisLeft(l)),t=c,a=m,i=n}{const t=r.select("#prf-bar-graph").attr("width",s.A.BAR_CHART_WIDTH+p+u).attr("height",s.A.BAR_CHART_HEIGHT+d+h).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(p,",").concat(d,")")),a=o.j.OBJECTIVES_DATA[s.A.PRF_OBJECTIVE][o.j.BASELINE_YRLY_KEY_STRING].map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(((t,e)=>e.val-t.val)),i=r.scaleBand().domain(a.map((t=>{let{year:e}=t;return e})).sort(r.ascending)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4),c=r.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]),m=r.axisBottom(i).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(i.domain().filter(((t,e)=>0===e||(e+1)%10===0)));t.append("g").attr("class","anim-xaxis"),t.append("g").attr("class","axis-y"),t.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).call(m).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),t.select(".axis-y").call(r.axisLeft(c)),e=i,n=m,l=a}}(),{barsAppear:{do:function(){{const e=r.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]);r.select("#pag-bar-graph .svg-group").selectAll(".bars").data(i,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(e=>t(e.year))).attr("y",s.A.BAR_CHART_HEIGHT).attr("width",t.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(t=>e(t.val))).attr("height",(t=>s.A.BAR_CHART_HEIGHT-e(t.val)))}{const t=r.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]);r.select("#prf-bar-graph .svg-group").selectAll(".bars").data(l,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(t=>e(t.year))).attr("y",s.A.BAR_CHART_HEIGHT).attr("width",e.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(e=>t(e.val))).attr("height",(e=>s.A.BAR_CHART_HEIGHT-t(e.val)))}},undo:function(){r.select("#pag-bar-graph .svg-group").selectAll(".bars").data(i,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(i.length-t.placeFromLeft-1))).attr("y",s.A.BAR_CHART_HEIGHT).attr("height",0),r.select("#prf-bar-graph .svg-group").selectAll(".bars").data(l,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(l.length-t.placeFromLeft-1))).attr("y",s.A.BAR_CHART_HEIGHT).attr("height",0)}},barsCondense:{do:async function(){const t=r.scaleBand().domain(r.range(i.length)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4);{const e=s.A.BAR_CHART_WIDTH/8,n=r.select("#pag-bar-graph .svg-group");n.select(".anim-xaxis").call(a.tickFormat(""));const o=n.selectAll(".bars");o.transition().duration(500).attr("x",((e,a)=>t(a))).transition().duration(500).attr("fill",((t,e)=>(0,c.YW)(e/(i.length-1)))).transition().delay(((t,e)=>100+1e3*(1-(1-e/i.length)**4))).duration(500).attr("width",e).attr("x",s.A.BAR_CHART_WIDTH/2-e/2).end().catch((()=>{})).then((()=>{n.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),o.transition().delay(500).attr("x",0),n.transition().delay(500).attr("transform","translate(".concat(p+s.A.BAR_CHART_WIDTH/2-e/2,",").concat(d,")"))}))}{const e=s.A.BAR_CHART_WIDTH/8,a=r.select("#prf-bar-graph .svg-group");a.select(".anim-xaxis").call(n.tickFormat(""));const o=a.selectAll(".bars");o.transition().duration(500).attr("x",((e,a)=>t(a))).transition().duration(500).attr("fill",((t,e)=>(0,c.YW)(e/(l.length-1)))).transition().delay(((t,e)=>100+1e3*(1-(1-e/l.length)**4))).duration(500).attr("width",e).attr("x",s.A.BAR_CHART_WIDTH/2-e/2).end().catch((()=>{})).then((()=>{a.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),o.transition().delay(500).attr("x",0),a.transition().delay(500).attr("transform","translate(".concat(p+s.A.BAR_CHART_WIDTH/2-e/2,",").concat(d,")"))}))}},undo:function(){const o=r.scaleBand().domain(r.range(i.length)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4);{const n=r.select("#pag-bar-graph .svg-group"),c=n.selectAll(".bars");n.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),n.transition().delay(500).attr("transform","translate(".concat(p,",").concat(d,")")),c.transition().duration(500).attr("x",((t,e)=>o(e))).attr("width",t.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{c.transition().duration(500).attr("fill","steelblue").transition().delay(((t,e)=>100+1e3*(1-(e/i.length)**4))).duration(500).attr("x",(t=>e(t.year))).end().catch((()=>{})).then((()=>{n.select(".anim-xaxis").call(a.tickFormat((t=>"year ".concat(t))))}))}))}{const t=r.select("#prf-bar-graph .svg-group"),a=t.selectAll(".bars");t.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),t.transition().delay(500).attr("transform","translate(".concat(p,",").concat(d,")")),a.transition().duration(500).attr("x",((t,e)=>o(e))).attr("width",e.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{a.transition().duration(500).attr("fill","steelblue").transition().delay(((t,e)=>100+1e3*(1-(e/l.length)**4))).duration(500).attr("x",(t=>e(t.year))).end().catch((()=>{})).then((()=>{t.select(".anim-xaxis").call(n.tickFormat((t=>"year ".concat(t))))}))}))}}}}},initBucketsFillAnim:function(t){let{deps:e}=t;return{do:function(){r.selectAll(".tut-graph-wrapper .bottle-wrapper").style("display","initial"),r.select("#pag-bar-graph").attr("opacity",0),r.select("#prf-bar-graph").attr("opacity",0),e.setBucketInterperPAG((()=>s.A.PAG_INTERPER)),e.setBucketInterperPRF((()=>s.A.PRF_INTERPER))},undo:function(){e.setBucketInterperPAG((()=>r.scaleLinear().range([0,0]))),e.setBucketInterperPRF((()=>r.scaleLinear().range([0,0]))),r.selectAll(".tut-graph-wrapper .bottle-wrapper").style("display","none"),r.select("#pag-bar-graph").transition().attr("opacity",1),r.select("#prf-bar-graph").transition().attr("opacity",1)}}},initMoveBucketsAnim:function(t){let{deps:e}=t;return{do:function(){(0,i.YB)(".ag-annot, .ref-annot")},undo:function(){(0,i.f2)(".ag-annot, .ref-annot")}}},initDropFillAnim:function(t){let{deps:e}=t;return{do:function(){e.setDropInterper((()=>s.A.PAG_INTERPER_DROP))},undo:function(){e.setDropInterper((()=>r.scaleLinear().range([0,0])))}}},initChangeRealityAnim:function(){return{do:function(){r.selectAll(".vardrop").style("display","initial").classed("hasarrow",!0),(0,i.f2)(".main-waterdrop .objective-label, .main-waterdrop .volume-not-height, .waterdrop-explain-pag")},undo:function(){r.selectAll(".vardrop").style("display","none").classed("hasarrow",!1),(0,i.YB)(".main-waterdrop .objective-label, .main-waterdrop .volume-not-height, .waterdrop-explain-pag")}}},initFillVarDropsAnim:function(t){let{deps:e}=t;return{do:function(){r.selectAll(".vardrop .bucket-outline").style("stroke-dasharray","none"),e.setVariationInterpers(s.A.VARIATIONS_INTERPERS)},undo:function(){r.selectAll(".vardrop .bucket-outline").style("stroke-dasharray","10 10"),e.setVariationInterpers(s.A.VARIATIONS.map((()=>r.scaleLinear().range([0,0]))))}}},initShowScenLabelAnim:function(){return{do:function(){r.selectAll(".var-scen-label").style("display","block")},undo:function(){r.selectAll(".var-scen-label").style("display","none")}}},initHighlightBestAnim:function(){return{do:function(){r.select(".drop1").classed("highlighted",!0)},undo:function(){r.select(".drop1").classed("highlighted",!1)}}},initShowQuantilesAnim:function(){return{do:function(){r.select(".drop1").classed("highlighted",!1),r.selectAll(".vardrop").classed("hasarrow",!1),r.selectAll(".var-scen-label").style("opacity","0.5"),r.selectAll(".var-scen-label, .scen-number").style("color","gray"),r.select(".main-waterdrop").transition().style("transform","translateY(-100px) scale(0.5)"),r.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(2)"),r.selectAll(".drop1 .bottle-wrapper, .drop3 .bottle-wrapper").transition().style("transform","translate(-50px, 15px) scale(0.5)"),r.selectAll(".drop2 .bottle-wrapper, .drop4 .bottle-wrapper").transition().style("transform","translate(50px, 15px) scale(0.5)"),r.select(".main-histogram").style("display","initial"),r.selectAll(".vardrop .dot-histogram-wrapper").style("display","flex")},undo:function(){r.select(".drop1").classed("highlighted",!0),r.selectAll(".vardrop").classed("hasarrow",!0),r.selectAll(".var-scen-label").style("opacity","1"),r.selectAll(".var-scen-label").style("color","black"),r.selectAll(".scen-number").style("color","#CC8F43"),r.select(".main-waterdrop").transition().style("transform","none"),r.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(1)"),r.selectAll(".drop1 .bottle-wrapper, .drop3 .bottle-wrapper").transition().style("transform","none"),r.selectAll(".drop2 .bottle-wrapper, .drop4 .bottle-wrapper").transition().style("transform","none"),r.select(".main-histogram").style("display","none"),r.selectAll(".vardrop .dot-histogram-wrapper").style("display","none")}}},initComparerAnimGroup:function(t){let{deps:e}=t;return{showPAG:{do:function(){(0,i.f2)(".scrollama-compare-scenobjs .waterdrop-graphics-wrapper"),(0,i.YB)(".scrollama-compare-scenobjs .tut-comparer-graphics-wrapper")},undo:function(){(0,i.YB)(".scrollama-compare-scenobjs .waterdrop-graphics-wrapper",r,"grid"),(0,i.f2)(".scrollama-compare-scenobjs .tut-comparer-graphics-wrapper")}},showPRF:{do:function(){e.largeDropComparer.showOtherDrop()},undo:function(){e.largeDropComparer.hideOtherDrop()}}}}};n()}catch(d){n(d)}}))},9152:(t,e,a)=>{a.d(e,{Dq:()=>h,Dy:()=>u,RZ:()=>m,hU:()=>g,iu:()=>A,j9:()=>f,kr:()=>p,xz:()=>y});var n,r,s,o,i,c=a(7528),l=a(1676),d=a(1684);function u(t,e,a){return l.scaleLinear().domain((0,d.kd)(0,1,t.length)).range(t.map((t=>Math.min(1,(t-e)/(a-e))))).clamp(!0)}function h(t){t=[1,...t,0];let e=0;for(let a=0;a<t.length-1;a++){e+=(t[a]-t[a+1])*(a-1)/(t.length+4)}return e}const p=["D","C","P","R","M"],m=["Demand","Carryover","Priority","Regs.","Min. Flow"],f=[[1,.9,.8,.7,.6].reverse(),[1,1.2,1.3],[0,1],[1,2,3,4],[0,.4,.6,.7,.8]],g={demand:f[0].length,carryover:f[1].length,priority:f[2].length,regs:f[3].length,minflow:f[4].length},y=[String.raw(n||(n=(0,c.A)(["Reduce total agriculture demands\n(1) Reduce 40%\n(2) Reduce 30%\n(3) Reduce 20%\n(4) Reduce 10%\n(5) Baseline"]))),String.raw(r||(r=(0,c.A)(["Modify balance of reservoir storage and delivery\n(1) Baseline\n(2) Increase carryover (relative to delivery) 10%\n(3) Increase carryover to 20%"]))),String.raw(s||(s=(0,c.A)(["Modify how CVP cuts are distributed during times of shortage\n(1) Baseline\n(2) Equal cuts"]))),String.raw(o||(o=(0,c.A)(['Selective removal/activation of D1641 regulations\n(1) Baseline (all "on")\n(2) No NDO, Rio Vista min flows\n(3) No X2/salinity\n(4) Combined no NDO + no X2']))),String.raw(i||(i=(0,c.A)(["Modify/add minimum flow on Central Valley tributaries\n(1) Baseline\n(2) 40% unimpaired flow on main tributaries\n(3) 60% unimpaired flow\n(4) 70% unimpaired flow\n(5) 80% unimpaired flow"])))];function A(t){let e=parseInt(t);const a=e%g.minflow;e=(e-a)/g.minflow;const n=e%g.regs;e=(e-n)/g.regs;const r=e%g.priority;e=(e-r)/g.priority;const s=e%g.carryover;e=(e-s)/g.carryover;const o=e%g.demand;return[g.demand-1-o,s,r,n,a]}},9060:(t,e,a)=>{a.d(e,{_:()=>i});var n=a(1676),r=a(2385),s=a(9550),o=a(972);const i={updateSmallDropSVG:function(t,e,a,i){let{onClick:c,onHover:l,onUnhover:d}=i;const u={},h=t.selectAll(".small-drop").data(e.nodes,(t=>t.id)).join((t=>t.append("g").each((function(t){n.select(this).call(function(t){let{levs:e,id:a}=t;return t=>{t.attr("class","small-drop hover-capture");const n="drop-fill-".concat(a);t.call((0,o.ji)(e,n)),t.append("path").attr("d",o.$N).attr("class","outline"),t.append("path").attr("class","fill").attr("d",o.kp).attr("fill","url(#".concat(n,")")),t.append("circle").attr("class","circlet interactive").call(o.JB).attr("cy",-(0,s.jF)({rad:1})).attr("r",1.5),t.append("rect").attr("class","bbox").style("visibility","hidden")}}(t))})))).attr("transform",(t=>{let{globalX:e,globalY:a,globalTilt:n}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(n,")")})).each((function(t){n.select(this).call(function(t,e){let{key:a,levs:n,maxLev:s,id:i,x:c,y:l}=t;return t=>{"expl0000"===a&&(e.x=c,e.y=l),t.call((0,o.GI)(n,s)),t.select(".outline").attr("transform","scale(".concat(.95*r.W.LOD_1_RAD_PX,")")),t.select(".fill").attr("transform","scale(".concat(r.W.LOD_1_RAD_PX,")")),t.select(".circlet").attr("id","i".concat(i));const d=t.select(".fill").node().getBBox();t.select(".bbox").attr("x",d.x).attr("y",d.y).attr("width",d.width).attr("height",d.height)}}(t,u))}));if(c&&h.on("click",(function(t,e){c(e)})),l&&h.on("mouseenter",(function(t,e){l(e)})),d&&h.on("mouseleave",(function(t,e){d(e)})),h.transition().delay(a).duration(1e3).attr("transform",(t=>{let{x:a,y:n,tilt:s}=t;return"translate(".concat(e.x+a*r.W.SPREAD_1_2,", ").concat(e.y+n*r.W.SPREAD_1_2,") rotate(").concat(s,")")})),void 0===u.x)return void t.selectAll(".highlight-circle, .baseline-pointer").attr("display","none");t.selectAll(".highlight-circle, .baseline-pointer").attr("display","initial");const p=e.x+u.x*r.W.SPREAD_1_2,m=e.y+u.y*r.W.SPREAD_1_2-(0,s.jF)({rad:r.W.LOD_1_RAD_PX}),f=e.x+e.height*r.W.SPREAD_1_2/2,g=e.y-e.height*r.W.SPREAD_1_2/2,y=e.height/20,A=e.height/100;t.select(".highlight-circle").attr("stroke","none").attr("fill","yellow").attr("r",2*r.W.LOD_1_RAD_PX).attr("cx",p).attr("cy",m),t.select(".baseline-pointer path").attr("d",n.line().x((t=>t[0])).y((t=>t[1]))([[p,m],[f,g]])).attr("stroke-width",A),t.select(".baseline-pointer text").attr("class","fancy-font").attr("font-size",y).attr("transform","translate(".concat(f+y,", ").concat(g,")"))},updateColorDrops:function(t,e,a,n){t.selectAll(".color-drop").data(e.nodes).join("circle").attr("class","color-drop").attr("r",r.W.LOD_1_RAD_PX).attr("opacity",(t=>{let{key:e}=t;return a(e)})).attr("fill",n).attr("cx",(t=>{let{x:a}=t;return e.x+a*r.W.SPREAD_1_2})).attr("cy",(t=>{let{y:a}=t;return e.y+a*r.W.SPREAD_1_2}))}}},9550:(t,e,a)=>{a.d(e,{D5:()=>x,Hb:()=>b,eh:()=>g,hh:()=>f,jF:()=>_,k4:()=>E,kt:()=>A,p6:()=>v,qE:()=>c,sR:()=>w,xg:()=>y});var n=a(1676),r=a(9408),s=a(3783),o=a.n(s),i=a(972);function c(t,e,a){return Math.max(e,Math.min(a,t))}function l(t){const e=t/2,a=3*Math.PI/2/16,n=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let r=0;r<=16;r++)n.push({x:Math.cos(r*a-Math.PI/4)*e,y:Math.sin(r*a-Math.PI/4)*e});return n}const d=function(){const t=l(3),e=l(1),a=[];for(let n=0;n<t.length-2;n++)a.push([t[n],t[n+(n<2?1:2)],e[n+(n<2?1:2)],e[n]]);return a}();let u,h,p,m;function f(t,e,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s&&p&&a.length===m)return p;u&&a.length===h||(u=n.range(4).map((()=>function(t,e){const a=o().Bounds.create(t),r=a.min.x,s=a.max.x,i=a.min.y,c=a.max.y,l=n.scaleLinear([r,s]),d=n.scaleLinear([i,c]),u=[];for(let n=0;n<e;n++)for(;;){const e=l(Math.random()),a=d(Math.random());if(o().Vertices.contains(t,{x:e,y:a})){u.push([e,a]);break}}return u}(l(1),h=a.length))));const c=function(t){const e=n.sum(t.map((t=>t**2*3.14)));return Math.floor(Math.sqrt(e/3.14))}(a.map((t=>{let{r:e}=t;return e})))/r,f=u[Math.floor(Math.random()*u.length)].map((t=>{let[e,a]=t;return[e*c,a*c]})),g=o().Engine,y=o().Bodies,A=o().Composite,x=g.create(),_=f.sort(((t,e)=>e[1]-t[1])),v=a.map(((t,e)=>{let{r:a,id:n}=t;const[r,s]=_[e];return y.circle(r,s,a,{restitution:0,id:n})})),w=d.map((t=>o().Body.create({position:o().Vertices.centre(t),vertices:t,isStatic:!0}))),b=o().Body.create({isStatic:!0});o().Body.setParts(b,w),o().Body.setCentre(b,{x:0,y:0}),o().Body.scale(b,c,c),A.add(x.world,[...v,b]);for(let n=0,o=60,i=.1;n<o*i;n++)g.update(x,1e3/o);const E=v.map((a=>{let{position:n,id:r}=a;return{id:r,x:n.x+t,y:n.y+e}}));return E.height=c/2/i.Sz*i.IC,!s||p&&E.length===m||(p=E,m=E.length),E}function g(t){return t*Math.PI/180}function y(t,e){let[a,n]=t,[r,s]=e;return Math.sqrt(function(t,e){let[a,n]=t,[r,s]=e;return(r-a)**2+(s-n)**2}([a,n],[r,s]))}function A(t){return[t.left+t.width/2,t.top+t.height/2]}function x(t,e,a){let[n,r]=t;const s=Math.sqrt((n[0]-r[0])**2+(n[1]-r[1])**2),o=[(r[0]-n[0])/s,(r[1]-n[1])/s];return void 0===a&&(a=e),n[0]+=o[0]*e,n[1]+=o[1]*e,r[0]-=o[0]*a,r[1]-=o[1]*a,[n,r]}function _(t){let{rad:e,height:a}=t;return void 0!==e?.08*function(t){return(1+Math.SQRT2)*t}(e):.08*a}function v(t){return[n.mean(t,(t=>t[0])),n.mean(t,(t=>t[1]))]}function w(t,e,a){const n=new r.Pq0(t,e,0).applyEuler(new r.O9p(0,0,g(a)));return[n.x,n.y]}function b(t,e){for(const a of t){const t=w(a[0],a[1],e);a[0]=t[0],a[1]=t[1]}return t}function E(t){let e=t.length;for(;0!=e;){let a=Math.floor(Math.random()*e);e--,[t[e],t[a]]=[t[a],t[e]]}return t}},4956:(t,e,a)=>{a.d(e,{Et:()=>r,K7:()=>l,LV:()=>i,ad:()=>o,iJ:()=>s,od:()=>c});var n=a(5043);function r(t,e){const a=Object.groupBy(t,e);for(const n of Object.keys(a))a[n]=a[n][0];return a}function s(t){const[e,a]=(0,n.useState)(t),r=(0,n.useRef)(t);(0,n.useEffect)((()=>{r.current=e}),[e]);const s=(0,n.useCallback)((t=>{a("function"===typeof t?e=>r.current=t(e):r.current=t)}),[]);return[e,s,r]}function o(t,e){return t&&t.state===e}function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return t.replace(new RegExp("(?![^\\n]{1,".concat(e,"}$)([^\\n]{1,").concat(e,"})\\s"),"g"),"$1\n")}function c(t,e){let a;return a="function"===typeof e?t.findIndex(e):t.indexOf(e),-1!==a&&t.splice(a,1),t}function l(t){return t.map((t=>Array.from(t)))}},972:(t,e,a)=>{a.d(e,{$N:()=>l,Ej:()=>E,GI:()=>_,IC:()=>h,JB:()=>f,O$:()=>m,Ri:()=>p,Sz:()=>u,UK:()=>v,UT:()=>w,YB:()=>g,Y_:()=>b,f2:()=>y,h7:()=>A,ji:()=>x,kp:()=>d});var n=a(1684),r=a(1676),s=a(2385),o=a(2186),i=a(4956),c=a(9550);const l="M0.333,-1L-0.389,-1A0.111,0.111,0,0,0,-0.5,-0.889L-0.5,0.889A0.111,0.111,0,0,0,-0.389,1L0.389,1A0.111,0.111,0,0,0,0.5,0.889L0.5,-0.889A0.111,0.111,0,0,0,0.389,-1L0.333,-1L0.333,-1.222A0.111,0.111,0,0,0,0.222,-1.333L-0.222,-1.333A0.111,0.111,0,0,0,-0.333,-1.222L-0.333,-1",d="M0.333,-1L-0.389,-1A0.111,0.111,0,0,0,-0.5,-0.889L-0.5,0.889A0.111,0.111,0,0,0,-0.389,1L0.389,1A0.111,0.111,0,0,0,0.5,0.889L0.5,-0.889A0.111,0.111,0,0,0,0.389,-1Z",u=Math.SQRT1_2,h=1+u;function p(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;const e=t/2,a=2*e/3,n=a/2;return[[a/2,-t/2],[-e/2,-t/2],[-e/2,-t/2],[-e/2,t/2],[-e/2,t/2],[e/2,t/2],[e/2,t/2],[e/2,-t/2],[e/2,-t/2],[a/2,-t/2],[a/2,-t/2],[a/2,-t/2-n],[a/2,-t/2-n],[-a/2,-t/2-n],[-a/2,-t/2-n],[-a/2,-t/2]]}function m(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=a/2,r=[-n/2,a/2-t*a],s=[n/2,a/2-e*a];return[[r,[n/2,a/2-t*a],s],[r,s,[-n/2,a/2-e*a]]]}function f(t){t.attr("fill","transparent").attr("stroke","#CC8F43").attr("stroke-dasharray",3).attr("stroke-width",3).attr("vector-effect","non-scaling-stroke")}function g(t,e,a){(e||r).selectAll(t).style("display",a||"block")}function y(t,e){(e||r).selectAll(t).style("display","none")}function A(t,e){(e||r).selectAll(t).remove()}function x(t,e){return a=>{const r=a.append("defs").append("linearGradient").attr("id",e).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");r.append("stop").attr("stop-color","transparent"),r.append("stop").attr("stop-color","transparent"),t.forEach(((t,e)=>{for(let a=0;a<2;a++)r.append("stop").attr("stop-color",(0,n.YW)(e/s.W.LOD_1_LEVELS))}))}}function _(t,e){return a=>{a.selectAll("stop").each((function(a,n){if(0===n)return void r.select(this).attr("offset","0%");if(n===2*(t.length+1)-1)return void r.select(this).attr("offset","100%");let s=Math.floor((n-1)/2);r.select(this).attr("offset","".concat(100*(1-(0,c.qE)(t[s]/e,0,1)),"%"))}))}}function v(t,e,a){return[t*a.k+a.x,e*a.k+a.y]}function w(t,e,a){return[(t-a.x)/a.k,(e-a.y)/a.k]}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return n=>{n.selectAll("*").remove();const r="string"===typeof t?(0,i.LV)(t,a).split("\n"):t,s=n.attr("x");r.forEach((t=>{n.append("tspan").attr("x",s).attr("dy","".concat(e,"em")).text(t)}))}}function E(t,e){const a=(0,c.xg)(t,e),n=(0,o.H)(Math.atan2(e[1]-t[1],e[0]-t[0]));return{left:"".concat(t[0],"px"),top:"".concat(t[1],"px"),width:"".concat(a,"px"),rotate:"".concat(n,"deg")}}},7066:(t,e,a)=>{a.d(e,{P:()=>r});a(5043);var n=a(579);const r={barsExplain:(0,n.jsx)(n.Fragment,{children:"Here, the data is presented as bar graphs, with the bottom axis representing the year and the side axis representing the amount of water delivered in thousand acre-feet (TAF)."}),barsCondense:(0,n.jsx)(n.Fragment,{children:"We'll condense each bar graph into a single bar with a filled gradient."}),bucketsFill:(0,n.jsxs)(n.Fragment,{children:["What we get are containers of water showing which water levels are most likely, with the darker areas being the most likely water levels.",(0,n.jsxs)("span",{className:"supplement-card-info",children:["Visuals made using"," ",(0,n.jsx)("a",{href:"https://sarahayu.github.io/bucket-glyph/",target:"_blank",children:"Bucket-Glyph"})]})]}),comparingTheTwo:(0,n.jsx)(n.Fragment,{children:"If we want a reliable supply we would want the refuge group's deliveries, but if we want a chance at higher supplies of water however with more inconsistent results, we would want the agriculture group's deliveries."}),forNowLetsFocus:(0,n.jsx)(n.Fragment,{children:"There is a chance 600 TAF of water will be delivered to this group. The darker colors, however, indicate that it's more likely that slightly less than 600 TAF of water will be delivered \u2014 around 500 TAF. As we'll later see, this is not a lot compared to other areas of California."}),ifChangeReality:(0,n.jsxs)(n.Fragment,{children:["But what if we could ",(0,n.jsx)("em",{children:"change reality"}),"? What if we could increase the likelihood of delivering as much water as possible by changing the way we manage it?"]}),fortunateCanExplore:(0,n.jsxs)(n.Fragment,{children:["Fortunately, we can explore those possibilities with the help of a simulator called",(0,n.jsx)("b",{children:" CalSim"}),"."]}),theseVarsCalled:(0,n.jsxs)(n.Fragment,{children:["These variations are called ",(0,n.jsx)("em",{children:"scenarios"})," and are labelled with unique numbers. Our reality is a scenario with no variables changed, labelled scenario 0000."]}),atAGlance:(0,n.jsx)(n.Fragment,{children:"At a glance, we can easily see that scenario 0020 appears to be the best scenario since the darker water levels reach higher than those of the other scenarios. To more concretely compare these scenarios, however, we'll use a different view."}),tryMoveRed:(0,n.jsx)(n.Fragment,{children:"Try moving the dotted line to change the minimum demand and see how well each of these scenarios meet those demands."}),soWhyNot:(0,n.jsxs)(n.Fragment,{children:["So why don't we just choose the best scenario? Well, it's because it's not just this group that wants water. Other groups, which we call"," ",(0,n.jsx)("em",{children:"objectives"}),", want scenarios that best fit ",(0,n.jsx)("em",{children:"them."})]}),letsBringRefuge:(0,n.jsx)(n.Fragment,{children:"The scenarios that benefit one objective do not always benefit another. Hover over the waterdrops to see how the same scenarios place for each objective. (Can you find a scenario that benefits both?)"})}},7073:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>d});var r=a(1676),s=a(1684),o=a(6531),i=t([o]);function l(){const t=r.interpolateRgbBasis(["#F2F5FB","#D0DDEB","#7B9BC0","#4F739F","#112A57"]),e="DEL_CVP_PAG_N",a="DEL_CVP_PRF_S",n="expl0000",i=o.j.OBJECTIVES_DATA[e][o.j.SCENARIO_KEY_STRING][n][o.j.DELIV_KEY_STRING],c=o.j.OBJECTIVES_DATA[a][o.j.SCENARIO_KEY_STRING][n][o.j.DELIV_KEY_STRING],l=["expl0020","expl0080","expl0480","expl0004"],d=l.map((t=>o.j.OBJECTIVES_DATA[e][o.j.SCENARIO_KEY_STRING][t][o.j.DELIV_KEY_STRING])),u=d.map((t=>e=>(0,s.m8)(r.scaleLinear().domain((0,s.kd)(0,1,t.length)).range(t.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(e)))),h=o.j.MAX_DELIVS;return{BAR_CHART_WIDTH:500,BAR_CHART_HEIGHT:400,INTERP_COLOR:t,PAG_OBJECTIVE:e,PRF_OBJECTIVE:a,PAG_COLOR:"#808C54",PRF_COLOR:"#60A4BF",DEFAULT_SCENARIO:n,PAG_DELIVS:i,PRF_DELIVS:c,VARIATIONS:l,VARIATIONS_DELIVS:d,VARIATIONS_INTERPERS:u,PAG_INTERPER:t=>r.scaleLinear().domain((0,s.kd)(0,1,i.length)).range(i.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t),PAG_INTERPER_DROP:t=>(0,s.m8)(r.scaleLinear().domain((0,s.kd)(0,1,i.length)).range(i.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t)),PRF_INTERPER:t=>r.scaleLinear().domain((0,s.kd)(0,1,c.length)).range(c.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t),DROP_VARIATIONS:[{idx:0,scen:"0020",clas:"drop1",desc:"change priority"},{idx:1,scen:"0080",clas:"drop2",desc:"increase carryover"},{idx:2,scen:"0480",clas:"drop3",desc:"decrease demand"},{idx:3,scen:"0004",clas:"drop4",desc:"increase minimum flow"}],MAX_DELIVS:h}}o=(i.then?(await i)():i)[0];const d=l();n()}catch(c){n(c)}}))},6924:(t,e,a)=>{a.d(e,{c:()=>l});var n=a(1684),r=a(2385),s=a(9152),o=a(9550),i=a(4956),c=a(1676);function l(t,e,a){console.time("init waterdrops");const l=t.OBJECTIVE_IDS,d=a?t.SCENARIO_IDS.filter((e=>t.MIN_MAXES[a.egoObjective][e][0]>=a.minDelivery)):t.SCENARIO_IDS,u=(l.length,d.length),h=Math.sqrt(u/Math.PI)*r.W.LOD_1_RAD_PX*2*r.W.LOD_1_SMALL_DROP_PAD_FACTOR*r.W.LOD_1_LARGE_DROP_PAD_FACTOR,p=r.W.LOD_1_RAD_PX*r.W.LOD_1_SMALL_DROP_PAD_FACTOR,m=(0,o.hh)(0,0,l.map(((t,e)=>({r:h,id:e}))),.8);for(let n=0;n<m.length;n++)m[n].tilt=40*Math.random()-20;const f=(0,i.Et)(m,(t=>{let{id:e}=t;return e})),g=(0,o.hh)(0,0,d.map(((t,e)=>({r:p,id:e})))),y=(0,i.Et)(g,(t=>{let{id:e}=t;return e})),A=[],x=[],_=[],v={},w={},b={};let E=0;for(const i of t.FLATTENED_DATA){const{id:e,objective:a,scenario:l,deliveries:u}=i;if(!d.includes(l))continue;const[h,p]=t.MIN_MAXES[a],m=(0,s.Dy)(u,h,p),g=(0,n.kd)(0,1,r.W.LOD_1_LEVELS+1).map((t=>m(t))).map(((t,e)=>Math.max(t,0==e?r.W.LOD_1_MIN_LEV_VAL:0)*r.W.LOD_1_RAD_PX)),_=a,w=l;if(void 0===b[_]){let e=[];for(let n of d)e.push(t.DATA_GROUPINGS.objective[_][n]);let a={};e.sort(c.ascending);for(let t=0;t<e.length;t++)a[e[t]]=t;b[_]=a}const j=t.DATA_GROUPINGS.objective[_].rank,I=b[_][t.DATA_GROUPINGS.objective[_][w]],R=50*Math.random()-25,T=f[j].tilt,{x:D,y:S}=y[I],[k,C]=(0,o.sR)(D,S,T),P={id:e,levs:g,maxLev:r.W.LOD_1_RAD_PX,domLev:(0,s.Dq)(g),tilt:R,dur:100*Math.random()+400,x:D,y:S,group:_,key:w,globalX:f[j].x+k,globalY:f[j].y+C,globalTilt:T+R};A.push(P),v[_]||(v[_]=[]),v[_].push(P),x[e]=E++}E=0;for(const n of l){const{x:a,y:r,tilt:s}=f[t.DATA_GROUPINGS.objective[n].rank];_.push({x:a,y:r,tilt:s,key:n,height:g.height,nodes:v[n],display_name:e[n].display_name||n}),w[n]=E++}return console.timeEnd("init waterdrops"),{nodes:A,groups:_,height:m.height,groupKeyToIdx:w,nodeKeyToIdx:x}}},8330:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{_:()=>v});var r=a(1676),s=a(4082),o=a(2385),i=a(9550),c=a(4956),l=a(972),d=t([s]);function h(){const t=r.select(this);t.append("circle").attr("class","hover-capture").attr("fill","transparent").attr("stroke-width",0).attr("r",.8),t.append("circle").attr("class","circlet interactive").call(l.JB).attr("r",1);const e=t.append("g").attr("pointer-events","none");e.append("image").attr("href","glow.png").attr("preserveAspectRatio","none").attr("opacity",.8),e.append("text").attr("class","fancy-font cloud-text").attr("text-anchor","middle").attr("font-size",0)}function p(t){r.select(this).select(".circlet").attr("id","b".concat(t.key)),r.select(this).select("text").call(m(t))}function m(t){return function(e){e.selectAll("*").remove();const a=(0,c.LV)(t.display_name).split("\n");a.forEach(((t,n)=>{e.append("tspan").attr("x",0).attr("y","".concat(-a.length/2+.5,"em")).attr("dy","".concat(n,"em")).text(t)}))}}function f(t){let{x:e,y:a,height:n}=t;return"translate(".concat(e,", ").concat(a-(0,i.jF)({height:n}),") scale(").concat(n*o.W.GROUP_HOVER_AREA_FACTOR,")")}function g(t,e,a,n){const s=window.innerHeight/9,o=a/n/e;return((i=t*o)>s?0:r.scaleLinear().domain([0,s]).range([1,.4]).clamp(!0)(i))*Math.min(o,.4);var i}function y(){const t=r.select("#minimap").attr("width",250).attr("height",300),e=r.geoMercator().scale(1e3).center(s.l.CALIFORNIA_CENTER).translate([125,150]),a=[...s.l.SPATIAL_DATA.features.filter((t=>"MultiPolygon"===t.geometry.type)),s.l.CALIFORNIA_OUTLINE],n=s.l.SPATIAL_DATA.features.filter((t=>"MultiPoint"===t.geometry.type));t.selectAll("path").data(a).join("path").attr("d",(t=>r.geoPath().projection(e)(t))).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("stroke","transparent").attr("stroke-width",1).attr("fill",(t=>t.properties.CalLiteID?"transparent":"white")).style("filter",(t=>t.properties.CalLiteID?"none":"drop-shadow(6px 6px 18px rgba(0, 0, 0, 0.1))")),t.selectAll("circle").data(n).join("circle").each((function(t){const a=r.select(this),[n,s]=e(t.geometry.coordinates[0]);a.attr("cx",n),a.attr("cy",s)})).attr("r",2).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("fill","transparent")}function A(t,e,a){let{onClick:n,onHover:s,onUnhover:o}=a;const i=t.selectAll(".large-drop").data(e.groups,(t=>{let{key:e}=t;return e})).join((t=>t.append("g").attr("class","large-drop").each(h))).each(p).attr("transform",f).select(".hover-capture");n&&i.on("click",(function(t,e){n(e)})),s&&i.on("mouseenter",(function(t,e){r.select(this.parentNode).raise(),s(e)})),o&&i.on("mouseleave",(function(t,e){o(e)}))}function x(t,e,a){return function(){const n=r.select(this).node(),[s,o]=(0,i.kt)(n.getBoundingClientRect()),c=n.getBBox().width*e.height/e.far*8,l=n.getBBox().height*e.height/e.far*10,d=(0,i.xg)([s,o],[t.mouseX,t.mouseY]);r.select(this).attr("font-size",g(d,t.zoom,e.height,a)),r.select(this.parentNode.parentNode).select("image").attr("x",-c/2).attr("y",-l/2).attr("width",c).attr("height",l)}}function _(t,e,a,n){const s=r.timer((r=>{const o=Math.min(1,r/n);t.updateVisibility(1-o),t.updateOutlineVisibility(a*(1-o)),o>=1&&(s.stop(),t.remove(e))}))}s=(d.then?(await d)():d)[0];const v={drawMinimapSVG:y,updateLargeDropSVG:A,fontSizer:x,fadeOutDrops:_};n()}catch(u){n(u)}}))},4293:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>v});var r=a(1676),s=a(5043),o=a(4096),i=a(7919),c=a(8687),l=a(8058),d=a(2385),u=a(9550),h=a(4956),p=a(972),m=a(9152),f=a(6016),g=a(4987),y=(a(6767),a(4353)),A=a(579),x=t([l]);function v(){const t=(0,s.useContext)(o.B),[e,a]=(0,s.useState)(),[n,x]=(0,s.useState)(null),[_,v]=(0,s.useState)(r.zoomIdentity),{panels:w,setPanels:b,onPanelDragStart:E,getPanelStyle:j}=(0,g.J)(_),I=(0,s.useRef)(),R=(0,s.useRef)();return(0,s.useEffect)((function(){const e=r.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","compare-group");e.append("text").attr("id","member-variable"),e.append("text").attr("id","member-label"),t.addZoomHandler((function(t){v(t)}))}),[]),(0,s.useEffect)((function(){if((0,h.ad)(t.state,"CompareView")){const e=r.select("#compare-group"),{viewCenter:n,transitionDuration:s=0}=t.state;return R.current=n,I.current=f._.getWaterdropGroups(t.activeWaterdrops,t.waterdrops,n),f._.updateDropsSVG(e,I.current,s/5,{onHover:t=>{a({key:t.key})}}),(0,p.f2)(".large-green-text, .baseline-pointer, .circlet, .comp-line, .highlight-circle",e),setTimeout((()=>{a({key:I.current.groups[0].nodes[0].key}),(0,p.YB)("#member-variable, #member-label, .large-green-text, .baseline-pointer, .circlet, .comp-line, .highlight-circle",e),(0,p.YB)(".comp-settings",r,"flex")}),s+500),t.setGoBack((()=>()=>{const e=t.resetCamera();t.setState({state:"WideView",transitionDuration:e})})),v(t.camera.curTransform),function(){(0,p.h7)(".large-drop, .circlet, .comp-line",e),(0,p.f2)("#member-variable, #member-label, .baseline-pointer",e),(0,p.f2)(".comp-settings"),b([]),t.setGoBack(null)}}}),[t.state]),(0,s.useEffect)((function(){if(e){const[t,a,n]=f._.calcLinesAndPositions(I.current,e.key);b(function(t){return e=>t.map(((t,a)=>{let n=0,r=0;e[a]&&(n=e[a].offsetX,r=e[a].offsetY);const[s,o,i]=function(t){let{x:e,y:a,isLeft:n}=t,r=e,s=a;const o=I.current.groups[0].height*d.W.SPREAD_1_2;n?r-=o:r+=o;return[r,s,n]}(I.current.groupPositions[a]);return{text:t.key,x:s,y:o,id:I.current.groups[a].key,nodeID:t.id,isLeft:i,offsetX:n,offsetY:r}}))}(n)),f._.updateLabelSVG((0,u.p6)(t),e.key.slice(4),I.current.groups[0].height*d.W.SPREAD_1_2),f._.updateScenIndicatorsSVG(t,a)}}),[e]),(0,s.useEffect)((function(){const t=r.select("#compare-group");if(null===n)return(0,p.f2)(".color-drop-group",t),void(0,p.YB)(".large-drop",t);f._.updateColorDrops(t,I.current,(t=>l.j.KEY_SETTINGS_MAP[t][n]),["red","orange","blue","green","magenta"][n]),(0,p.YB)(".color-drop-group",t),(0,p.f2)(".large-drop",t)}),[n]),(0,A.jsxs)(A.Fragment,{children:[e&&(0,A.jsx)(c.A,{settings:(0,m.iu)(e.key.slice(4)),setColorSetting:x}),w.map(((e,a)=>{let{x:n,y:r,id:s,isLeft:o,offsetX:c,offsetY:d,nodeID:u}=e;const{objective:h}=l.j.FLATTENED_DATA[u],p=l.j.FLATTENED_DATA[u].deliveries,[f,g]=l.j.MIN_MAXES[h],x=(0,m.Dy)(p,f,g);return(0,A.jsx)("div",{className:"panel compare-panel"+(o?" left":" right"),style:j({x:n,y:r,offsetX:c,offsetY:d}),onMouseDown:t=>E(t,{id:s}),children:(0,A.jsxs)("div",{className:"panel-main-container",children:[(0,A.jsx)(i.A,{width:420,height:280,data:p,range:[f,g],goal:t.goals[s],setGoal:e=>{t.setGoals((t=>(t[s]=e,{...t})))}}),(0,A.jsx)(y.A,{maxValue:g,levelInterp:x,height:200,resolution:4})]})},a)}))]})}l=(x.then?(await x)():x)[0],n()}catch(_){n(_)}}))},5621:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>w});var r=a(1676),s=a(5043),o=a(4096),i=a(7919),c=a(9083),l=a(8058),d=a(2385),u=a(4956),h=a(972),p=a(9152),m=a(9550),f=a(9060),g=a(4987),y=(a(6767),a(7187)),A=a(4353),x=a(579),_=t([l]);function w(){const t=(0,s.useContext)(o.B),e=(0,s.useRef)([]),a=(0,s.useRef)(null),[n,_]=(0,s.useState)(null),[v,w]=(0,s.useState)(r.zoomIdentity),{panels:b,panelsRef:E,setPanels:j,onPanelDragStart:I,getPanelStyle:R}=(0,g.J)(v),[T,D]=(0,s.useState)(null),S=(0,s.useRef)(null);function k(){const t=a.current.height*d.W.SPREAD_1_2/20;r.select("#examine-group .instruction-text").attr("x",a.current.x-a.current.height*d.W.SPREAD_1_2*.8).attr("y",a.current.y-t).attr("opacity",0).attr("text-anchor","end").attr("font-size",t).call((0,h.Y_)(["click to keep panels open.","you can drag panels."],1.6)).call((t=>{t.transition().attr("opacity",1)})).selectAll("tspan").each((function(e,a){r.select(this).attr("dx",a*t)}));const e=a.current.height*d.W.SPREAD_1_2/15;r.select("#examine-group .drop-label").attr("x",a.current.x).attr("y",a.current.y+a.current.height/2*d.W.SPREAD_1_2*.9).attr("opacity",0).attr("text-anchor","middle").attr("font-size",e).call((0,h.Y_)(a.current.display_name,1.2,30)).transition().attr("opacity",1),r.selectAll("#examine-group .highlight-circle, #examine-group .baseline-pointer").attr("opacity",0).transition().attr("opacity",1)}function C(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{x:s,y:o}=a.current,{x:i,y:c,id:l,key:h}=t.waterdrops.nodes[t.waterdrops.nodeKeyToIdx[e]];j((t=>{if(-1!==t.findIndex((t=>{let{id:e}=t;return l===e}))){if(!r)return t;(0,u.od)(t,(t=>t.id===l))}const a={text:h.slice(4),x:s+i*d.W.SPREAD_1_2,y:o+c*d.W.SPREAD_1_2,offsetX:20,offsetY:40,id:l,preview:n,panelKey:n?-1:e};return[...t,a]}))}function P(t){j((e=>((0,u.od)(e,(e=>{let{id:a}=e;return t===a})),[...e])))}function L(t){const a=r.select("#examine-group");e.current.includes(t.id)?((0,u.od)(e.current,t.id),a.select(".circlet#i".concat(t.id)).classed("active",!1),P(t.id),D(null)):(P(t.id),e.current.push(t.id),a.select(".circlet#i".concat(t.id)).classed("active",!0),C(t.id),D(t.id))}function O(t){e.current.includes(t.id)?(r.select(".examine-panel#p".concat(t.id)).style("z-index",100),D(t.id)):(S.current&&(clearTimeout(S.current),j((t=>((0,u.od)(t,(t=>{let{panelKey:e}=t;return-1===e})),[...t])))),C(t.id,!0))}function M(t){e.current.includes(t.id)||(S.current=setTimeout((()=>{P(t.id),S.current=null}),100)),D((e=>e===t.id?null:e)),r.select(".examine-panel#p".concat(t.id)).style("z-index",0)}if((0,s.useEffect)((function(){const e=r.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","examine-group");e.append("circle").attr("class","highlight-circle").attr("opacity",0),e.append("g").attr("class","baseline-pointer").call((function(t){t.append("path"),t.append("text").text("baseline")})).attr("opacity",0),e.append("text").attr("class","instruction-text large-green-text fancy-font"),e.append("text").attr("class","drop-label fancy-font"),t.addZoomHandler((function(t){w(t)}))}),[]),(0,s.useEffect)((function(){if((0,u.ad)(t.state,"ExamineView")){const{transitionDuration:n=0}=t.state,s=r.select("#examine-group");return a.current=t.waterdrops.groups.find((e=>e.key===t.activeWaterdrops[0])),f._.updateSmallDropSVG(s,a.current,n/2,{onClick:L,onHover:O,onUnhover:M}),setTimeout(k,1.2*n),t.setGoBack((()=>()=>{const e=t.resetCamera();t.setState({state:"WideView",transitionDuration:e})})),w(t.camera.curTransform),(0,h.YB)("#examine-group"),function(){(0,h.h7)(".small-drop, .circlet",s),(0,h.f2)("#examine-group"),r.selectAll("#examine-group .instruction-text, #examine-group .drop-label, #examine-group .highlight-circle, #examine-group .baseline-pointer").attr("opacity",0),j([]),e.current=[],a.current=null,t.setGoBack(null)}}}),[t.state]),(0,s.useEffect)((function(){const t=r.select("#examine-group");if(null===n)return(0,h.f2)(".color-drop",t),void(0,h.YB)(".small-drop",t);f._.updateColorDrops(t,a.current,(t=>l.j.KEY_SETTINGS_MAP[t][n]),["red","orange","blue","green","magenta"][n]),(0,h.YB)(".color-drop",t),(0,h.f2)(".small-drop",t)}),[n]),(0,u.ad)(t.state,"ExamineView"))return(0,x.jsxs)(x.Fragment,{children:[b.map((e=>{let{text:a,x:n,y:r,id:s,offsetX:o,offsetY:d,panelKey:u,preview:h}=e;const{objective:m,scenario:f}=l.j.FLATTENED_DATA[s],g=l.j.FLATTENED_DATA[s].deliveries,[y,v]=l.j.MIN_MAXES[m],w=(0,p.Dy)(g,y,v);return(0,x.jsxs)("div",{className:"panel examine-panel ".concat(h?"preview":""),id:"p".concat(s),style:R({x:n,y:r,offsetX:o,offsetY:d}),onMouseDown:t=>!h&&I(t,{id:s}),onMouseEnter:()=>!h&&O({id:s}),onMouseLeave:()=>!h&&M({id:s}),children:[(0,x.jsxs)("div",{className:"panel-tab",children:["scenario ",(0,x.jsx)("span",{children:a})]}),(0,x.jsxs)("div",{className:"panel-main-container",children:[(0,x.jsx)(i.A,{width:480,height:320,data:g,range:[y,v],goal:t.goals[t.activeWaterdrops[0]],setGoal:e=>{t.setGoals((a=>(a[t.activeWaterdrops[0]]=e,{...a})))}}),(0,x.jsx)(A.A,{levelInterp:w,maxValue:v,height:200,resolution:4})]}),(0,x.jsx)(c.A,{settings:(0,p.iu)(a),setColorSetting:_})]},h?-1:s)})),T&&(0,x.jsx)(y.P,{connectLine:function(e){if(-1===E.current.findIndex((t=>{let{id:a}=t;return e===a})))return;const{x:a,y:n}=E.current.find((t=>t.id===e)),[s,o]=t.camera.worldToScreen(a,n),i=r.select(".examine-panel#p".concat(e)).node().getBoundingClientRect(),[c,l]=[i.left+i.width/2,i.top+i.height/2],d=c-s,u=l-o;let h,p;return Math.abs(d)>Math.abs(u)?(p=0,h=(d<0?1:-1)*(i.width/2-5)):(h=0,p=(u<0?1:-1)*(i.height/2-5)),(0,m.D5)([[s,o],[c+h,l+p]],8,0)}(T)})]})}l=(_.then?(await _)():_)[0],n()}catch(v){n(v)}}))},4654:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>j});var r=a(5043),s=a(3999),o=a(4096),i=a(4956),c=a(4757),l=a(972),d=a(3362),u=a(6332),h=a(5831),p=a(8272),m=a(9246),f=a(4636),g=a(5829),y=a(2288),A=a(1802),x=a(6531),_=a(6924),v=a(579),w=t([c,p,m,g,y,A,x]);[c,p,m,g,y,A,x]=w.then?(await w)():w;const E=(0,_.c)(x.j,A.G);function j(){const t=(0,r.useContext)(o.B),{hookAnimations:e,getSlidesInRange:a,storyVars:n,index:g,setIndex:A}=(0,c.R)(E,t.camera);if((0,r.useLayoutEffect)((function(){if((0,i.ad)(t.state,"TutorialView"))return(0,l.f2)(".tut-graph .bottle-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-comparer-graphics-wrapper"),e(),A(-1),function(){t.resetCamera(!1),(0,l.f2)(".tutorial-view")}}),[t.state]),(0,i.ad)(t.state,"TutorialView"))return(0,v.jsxs)("div",{className:"tutorial-view",children:[(0,v.jsx)("button",{className:"scrollama-next",onClick:()=>{let t=document.getElementById("card-".concat(g+1));t||(t=document.getElementById("cte")),t.scrollIntoView({behavior:"smooth"})},children:"Click Here or Scroll to Continue"}),(0,v.jsx)(y.A,{appCtx:t}),(0,v.jsxs)("div",{className:"scrollama scrollama-create-buckets",children:[(0,v.jsx)(p.m,{appCtx:t,storyVars:n}),(0,v.jsx)(f.m,{setCurrentIndex:A,children:a("barsExplain","comparingTheTwo").map(((t,e)=>(0,v.jsx)(s.p,{data:t,children:(0,v.jsx)(u.Y,{id:"card-".concat(t.idx),children:t.script})},e)))})]}),(0,v.jsxs)("div",{className:"scrollama scrollama-compare-scenobjs scenarios-section",children:[(0,v.jsx)(m.k,{storyVars:n,size:.4*t.appHeight}),(0,v.jsx)(h.D,{}),(0,v.jsx)(f.m,{setCurrentIndex:A,children:a("forNowLetsFocus","letsBringRefuge").map(((t,e)=>(0,v.jsx)(s.p,{data:t,children:(0,v.jsx)(u.Y,{id:"card-".concat(t.idx),children:t.script})},e)))})]}),(0,v.jsx)(d.S,{onClick:()=>t.setState({state:"WideView"})})]})}n()}catch(b){n(b)}}))},6313:(t,e,a)=>{a.a(t,(async(t,n)=>{try{a.d(e,{A:()=>v});var r=a(1676),s=a(5043),o=a(7192),i=a.n(o),c=a(4096),l=a(3693),d=a(4082),u=a(2385),h=a(9550),p=a(4956),m=a(972),f=a(8330),g=a(3054),y=a(9128),A=a(579),x=t([l,d,f]);function v(){const t=(0,s.useContext)(c.B),[e,a]=(0,s.useState)({zoom:1,mouseX:0,mouseY:0}),n=(0,s.useRef)(!0),[o,x]=(0,s.useState)(null),[_,v]=(0,s.useState)(null),[w,b]=(0,s.useState)(!1),[E,j]=(0,s.useState)(null),[I,R]=(0,s.useState)(0),[T,D]=(0,s.useState)(null),[S,k]=(0,s.useState)(0),C=(0,s.useRef)(!1);(0,s.useEffect)((function(){!function(){(0,m.f2)("#infobox, #mosaic-webgl, #mosaic-svg");r.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","wide-group").append("text").attr("class","instruction-text large-green-text fancy-font")}();const e=function(){const e=t=>{a((e=>({...e,zoom:t.k})))},n=t=>{a((e=>({...e,mouseX:t.x,mouseY:t.y})))};return t.addZoomHandler(e),window.addEventListener("mousemove",n),function(){window.removeEventListener("mousemove",n)}}();return f._.drawMinimapSVG(),e}),[]),(0,s.useEffect)((function(){t.waterdrops.groups&&!E&&j(t.waterdrops.groups[0].key)}),[t.waterdrops,E]),(0,s.useEffect)((function(){if((0,p.ad)(t.state,"WideView"))return r.select("body").style("overflow","hidden"),C.current=!0,a((e=>({...e,zoom:t.camera.curTransform.k}))),console.time("drawing"),t.dropsMesh.draw(t.scene),console.timeEnd("drawing"),t.dropsMesh.updateVisibility(1),t.dropsMesh.updateOutlineVisibility(t.getOutlineOpacity(t.camera.curTransform.k)),function(){const e=r.select("#wide-group");f._.updateLargeDropSVG(e,t.waterdrops,{onClick:F,onHover:B,onUnhover:G});for(const n of t.activeWaterdrops)e.select(".circlet#b".concat(n)).classed("active",!0);const a=40*t.camera.getZFromFarHeight(t.waterdrops.height)/t.camera.height;e.select(".instruction-text").attr("x",0-.6*t.waterdrops.height).attr("y",5*-a).attr("text-anchor","end").attr("font-size",a).call((0,m.Y_)(["click to interact.","scroll to zoom.","drag to pan."],2)).selectAll("tspan").each((function(t,e){r.select(this).attr("dx",e*a)}))}(),(0,m.YB)("#infobox, #mosaic-webgl, #mosaic-svg, #wide-group"),n.current=!1,function(){(0,m.f2)("#infobox, #wide-group"),C.current=!1}}),[t.state]),(0,s.useEffect)((function(){C.current&&r.select("#wide-group").selectAll(".cloud-text").each(f._.fontSizer(e,t.camera,t.waterdrops.height))}),[e]),(0,s.useEffect)((function(){E&&!n.current&&t.updateWaterdrops({egoObjective:E,minDelivery:I})}),[E,I]),(0,s.useEffect)((function(){if(n.current)return;const e=t.resetCamera();t.setState({state:"WideView",transitionDuration:e})}),[t.waterdrops]);const P=(0,s.useCallback)((function(){D(E),k(I),b(!0)}),[t.waterdrops,E,I]),L=(0,s.useCallback)((function(){b(!1),j(T),R(S)}),[T,S]),O=(0,s.useCallback)((function(){t.setDisableCamAdjustments(!0);const{x:e,y:a,height:n}=t.waterdrops.groups[t.waterdrops.groupKeyToIdx[t.activeWaterdrops[0]]],r=[e,a,t.camera.getZFromFarHeight(n*u.W.SPREAD_1_2*1.5)],[s,o]=t.zoomTo(r,(function(){t.setDisableCamAdjustments(!1)}));s(),t.setState({state:"ExamineView",transitionDuration:o});const i=t.getOutlineOpacity(t.camera.curTransform.k);f._.fadeOutDrops(t.dropsMesh,t.scene,i,o/2)}),[t.getOutlineOpacity,t.activeWaterdrops]),M=(0,s.useCallback)((function(){t.setDisableCamAdjustments(!0);const e=(0,h.p6)(t.activeWaterdrops.map((e=>{let a=t.waterdrops.groups[t.waterdrops.groupKeyToIdx[e]];return[a.x,a.y]}))),a=[...e,t.camera.getZFromFarHeight(2*t.waterdrops.groups[0].height*u.W.SPREAD_1_2*.75*2)],[n,r]=t.zoomTo(a,(function(){t.setDisableCamAdjustments(!1)}));n(),t.setState({state:"CompareView",transitionDuration:r,viewCenter:e});const s=t.getOutlineOpacity(t.camera.curTransform.k);f._.fadeOutDrops(t.dropsMesh,t.scene,s,r/5)}),[t.getOutlineOpacity,t.activeWaterdrops]),N=(0,s.useCallback)((function(){t.setActiveWaterdrops([]),r.selectAll("#wide-group .circlet").classed("active",!1)}),[]);function F(e){const a=r.select("#wide-group");t.setActiveWaterdrops((t=>(t.includes(e.key)?(t=(0,p.od)(t,e.key),a.select(".circlet#b".concat(e.key)).classed("active",!1)):(t.push(e.key),a.select(".circlet#b".concat(e.key)).classed("active",!0)),[...t])))}function B(t){var e;x({id:t.key,description:(null===(e=l.G[t.key])||void 0===e?void 0:e.desc)||t.key}),r.select("#minimap").select(".outline."+t.key).attr("fill","gray")}function G(t){x(null),r.select("#minimap").select(".outline."+t.key).attr("fill","transparent")}const V=(0,s.useMemo)((()=>null===_?[]:i().go(_,t.waterdrops.groups,{keys:[t=>l.G[t.key].id,t=>l.G[t.key].display_name,t=>l.G[t.key].desc],limit:10,all:!0})),[_,t.waterdrops]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{id:"infobox",children:[(0,A.jsx)("svg",{id:"minimap"}),o&&(0,A.jsxs)("div",{className:"details",children:[!d.l.SPATIAL_FEATURES[o.id]&&(0,A.jsx)("p",{className:"no-loc-data",children:"No Location Data"}),(0,A.jsx)("p",{className:"curDesc",children:o.description}),(0,A.jsxs)("p",{className:"curKey",children:["id: ",(0,A.jsxs)("span",{children:[" ",o.id," "]})]})]}),!o&&(0,A.jsxs)("div",{className:"searchbox",tabIndex:-1,onBlur:t=>{const e=t.currentTarget;requestAnimationFrame((()=>{e.contains(document.activeElement)||(v(null),r.select(".results").style("display","none"))}))},children:[(0,A.jsx)("input",{type:"text",placeholder:"search",value:_||"",onChange:t=>v(t.target.value),onFocus:()=>{v(""),r.select(".results").style("display","flex")}}),(0,A.jsx)("div",{className:"results",style:{display:"none"},children:V.map((t=>{let{obj:e}=t;return(0,A.jsx)("button",{onClick:()=>{F(e),v(null),r.select(".results").style("display","none")},children:e.display_name},e.key)}))})]})]}),(0,A.jsx)("div",{className:"action-btn-wrapper",children:(0,A.jsx)(g.w,{appCtx:t,handleClickExamine:O,handleClickFilter:P,handleClickDeselectAll:N,handleClickCompare:M})}),w&&(0,A.jsxs)("div",{id:"filterbox",children:["I'm only interested in scenarios where"," ",(0,A.jsx)("select",{name:"ego-obj",id:"ego-obj",value:T,onChange:t=>{D(t.target.value)},children:t.waterdrops.groups.map((t=>(0,A.jsx)("option",{value:l.G[t.key].id,children:l.G[t.key].display_name||l.G[t.key].id},l.G[t.key].id)))})," ","gets at least"," ",(0,A.jsx)("input",{type:"number",name:"min-deliv",id:"min-deliv",value:S,onChange:t=>{k(t.target.value)}})," ","TAF in deliveries.",(0,A.jsxs)("button",{onClick:L,className:"fancy-font",children:[(0,A.jsx)(y.mmP,{}),(0,A.jsx)("span",{children:"Done"})]})]})]})}[l,d,f]=x.then?(await x)():x,n()}catch(_){n(_)}}))}}]);
//# sourceMappingURL=805.b5cbea38.chunk.js.map