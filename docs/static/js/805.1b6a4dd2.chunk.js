"use strict";(self.webpackChunkcoeqwal_website=self.webpackChunkcoeqwal_website||[]).push([[805],{4805:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.r(e),a.d(e,{default:()=>p});a(5043);var n=a(4096),s=a(6313),o=a(5621),i=a(4654),c=a(4293),l=a(9336),d=a(579),u=t([s,o,i,c,l]);function p(){const t=(0,l.A)();return(0,d.jsxs)(n.B.Provider,{value:t,children:[(0,d.jsxs)("div",{className:"bubbles-wrapper",children:[(0,d.jsx)("div",{id:"mosaic-webgl"}),(0,d.jsx)("svg",{id:"mosaic-svg",children:(0,d.jsx)("g",{className:"svg-trans"})})]}),(0,d.jsx)(i.A,{}),(0,d.jsx)(s.A,{}),(0,d.jsx)(o.A,{}),(0,d.jsx)(c.A,{}),t.goBack&&(0,d.jsx)("button",{className:"go-back-btn",onClick:t.goBack,children:(0,d.jsx)("span",{children:"\u2190"})})]})}[s,o,i,c,l]=u.then?(await u)():u,r()}catch(h){r(h)}}))},4096:(t,e,a)=>{a.d(e,{B:()=>r});const r=(0,a(5043).createContext)({})},3408:(t,e,a)=>{a.d(e,{Qj:()=>l,R1:()=>p,Uy:()=>c,X1:()=>d,fq:()=>i,hM:()=>u});var r=a(1676);const n=40,s=3;let o=0;function i(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.scaleLinear();return function(r){return r.map((r=>({x:-t,y:e-a(r)*e-e/2,width:2*t,height:2*e})))}}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.each((function(t){const e=r.select(this),a=e.attr("cur-level")||0;e.attr("prev-level",a),e.attr("cur-level",t.y)})),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(r.easeQuad).attrTween("transform",(function(t,a){const s=r.select(this),o=parseFloat(s.attr("prev-level")),i=Math.abs(o-t.y)/200*e;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*i+.5),4*Math.PI))*i*n*(1-t),", ",0,", ",0,")")}));return t.transition("liquidLevel").ease(r.easeElasticOut.period(.6)).delay(((e,a)=>a*(100/t.size()))).duration(1e3)}function l(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;return function(i){const c=o++;i.append("defs").attr("class","clip-def").append("clipPath").attr("id","bucket-mask-"+c).append("path").attr("class","bucket-mask-path"),i.append("g").attr("class","masked-area").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("clip-path","url(#bucket-mask-".concat(c,")")),i.append("path").attr("class","bucket-outline").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",s).attr("fill","none"),i.call(function(t){let{drawFunc:e,drawOutlineFunc:a=e,width:n,height:s}=t;return function(t){const o=t=>{const e=r.path();return t(e,n,s),e.toString()};t.select(".bucket-mask-path").attr("d",o(e)),t.select(".bucket-outline").attr("d",o(a))}}({drawFunc:a,drawOutlineFunc:n,width:t,height:e}))}}function d(t,e,a){h(t,e,a,!0)}function u(t,e,a){h(t,e,a,!1)}function h(t,e,a,r){const n=.8*e/2,s=-.8*e/2;t.moveTo(e/2,-a/2),t.lineTo(n,a/2),t.lineTo(s,a/2),t.lineTo(-e/2,-a/2),r&&t.closePath()}function p(t,e,a){const r=Math.SQRT2,n=1/(1+1*r),s=Math.min(e/2,a*n),o=s/(1/r),i=s+o;t.moveTo(0,-i/2),t.lineTo(o/2,-i/2+o/2),t.arc(0,-i/2+o,s,-Math.PI/4,5*Math.PI/4),t.closePath()}},1684:(t,e,a)=>{a.d(e,{E3:()=>n,Hf:()=>c,YW:()=>s,kd:()=>i,m8:()=>o});var r=a(1676);a(3408);function n(t,e,a){let n=t.map((t=>Math.round(t.length/e))),s=r.sum(n);for(;s>a;)n[r.minIndex(t,((t,a)=>0!==t.length?t.length/e-n[a]:1/0))]-=1,s=r.sum(n);for(;s<a;)n[r.maxIndex(t,((t,a)=>0!==t.length?t.length/e-n[a]:-1/0))]+=1,s=r.sum(n);return n}const s=t=>r.interpolateBlues(r.scaleLinear([.2,1])(t));function o(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}function i(t,e,a){return r.range(a).map((r=>r/(a-1)*(e-t)+t))}function c(t,e){let a=0;return r=>(a=>0!=a&&Math.abs(t[a-1].y-t[a].y)<e)(r)?-3*++a:a=0}},3054:(t,e,a)=>{a.d(e,{w:()=>o});var r=a(9128),n=a(4956),s=a(579);function o(t){let e,a,{appCtx:o,handleClickExamine:i,handleClickDeselectAll:c,handleClickCompare:l}=t;return(0,n.ad)(o.state,"WideView")&&o.activeWaterdrops.length&&(1===o.activeWaterdrops.length?e=(0,s.jsxs)("button",{onClick:i,className:"wide-view-action-btn fancy-font",children:[(0,s.jsx)(r.WEK,{}),(0,s.jsx)("span",{children:"examine"})]}):a=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:l,className:"wide-view-action-btn fancy-font",children:[(0,s.jsx)(r.IS1,{}),(0,s.jsx)("span",{children:"compare"})]}),(0,s.jsx)("button",{onClick:c,className:"fancy-font supplement-btn",children:(0,s.jsx)("span",{children:"deselect all"})})]})),(0,s.jsxs)(s.Fragment,{children:[e,a]})}},8441:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{D:()=>l});a(5043);var n=a(8755),s=a(7073),o=a(579),i=t([s]);function l(t){let{id:e,bucketInterper:a,label:r}=t;return(0,o.jsxs)("div",{className:"tut-graph",children:[(0,o.jsx)("svg",{id:e}),(0,o.jsx)(n.A,{levelInterp:a,width:300,height:s.A.BAR_CHART_HEIGHT,resolution:4}),(0,o.jsx)("p",{className:"fancy-font objective-label",children:r})]})}s=(i.then?(await i)():i)[0],r()}catch(c){r(c)}}))},8755:(t,e,a)=>{a.d(e,{A:()=>d});var r=a(1676),n=a(5043),s=a(3408),o=a(1684),i=a(579);const c=10,l=["Maximum","75th Percentile","50th Percentile","25th Percentile","Minimum"];function d(t){let{levelInterp:e,colorInterp:a=o.YW,width:d=200,height:u=400,resolution:h=c}=t;const p=30,m=1.5,f=30,g=180,y=(0,n.useRef)();return(0,n.useLayoutEffect)((function(){y.current.attr("width",d+g+m).attr("height",u+p+f).append("g").attr("class","graph-area").attr("transform","translate(".concat(g,",").concat(p,")")).call((0,s.Qj)(d,u,s.X1,s.hM))}),[]),(0,n.useLayoutEffect)((function(){const t=(0,o.kd)(0,1,h+1).map((t=>e(t))),r=(0,s.fq)(d,u)(t),n=y.current.select(".masked-area").selectAll(".bucket-box").data(r).join("rect").attr("class","bucket-box").attr("width",(t=>t.width)).attr("height",(t=>t.height)).attr("x",(t=>t.x)).attr("fill",((t,e)=>a(e/h)));(0,s.Uy)(n,200/u).attr("y",(t=>t.y));const i=r.reverse(),c=(0,o.Hf)(i,30),p=y.current.select(".graph-area").selectAll(".bucket-label").data(i).join((t=>t.append("g").call((t=>{t.append("rect"),t.append("text")})))).attr("class","bucket-label").transition().attr("transform",((t,e)=>"translate(".concat(-88+c(e),", ").concat(t.y+u/2,")")));p.select("text").text(((t,e)=>l[r.length-1-e])).style("fill",((t,e)=>e>r.length/2?"black":"white")),p.select("rect").attr("width",170).attr("height",30).attr("x",-85).attr("y",-15).attr("rx",8).style("fill",((t,e)=>a((r.length-1-e)/h)))}),[e]),(0,i.jsx)("div",{className:"bucket-wrapper",children:(0,i.jsx)("svg",{ref:t=>{y.current=r.select(t)}})})}},3362:(t,e,a)=>{a.d(e,{S:()=>n});a(5043);var r=a(579);function n(t){let{onClick:e}=t;return(0,r.jsx)("div",{className:"cte",children:(0,r.jsxs)("div",{className:"cte-container",children:["Thus, tradeoffs must often be made when managing California's water supply. What are the ways we can manage California's water, and how do their outcomes compare? Go to the next step to find out!",(0,r.jsx)("button",{className:"fancy-font",onClick:e,children:"click to explore!"})]})})}},6332:(t,e,a)=>{a.d(e,{Y:()=>s});var r=a(5043),n=a(579);const s=(0,r.forwardRef)((function(t,e){let{children:a}=t;return(0,n.jsx)("div",{ref:e,className:"tut-text-card-wrapper",children:(0,n.jsx)("div",{className:"tut-text-card",children:(0,n.jsx)("div",{className:"tut-text-card-container",children:a})})})}))},5831:(t,e,a)=>{a.d(e,{D:()=>n});a(5043);var r=a(579);function n(){return(0,r.jsxs)("div",{className:"tut-comparer-graphics-wrapper",children:[(0,r.jsx)("p",{className:"bigdrop-describe",children:"These are all possible scenarios sorted bottom-to-top by decreasing average deliveries."}),(0,r.jsx)("svg",{id:"comparer-graphics"})]})}},8272:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{m:()=>l});a(5043);var n=a(2799),s=a(8429),o=a(579),i=t([n]);function l(t){let{appCtx:e,storyVars:a}=t;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"create-buckets-section",children:[(0,o.jsx)(s.d,{}),(0,o.jsx)(n.v,{storyVars:a,size:.4*e.appHeight})]})})}n=(i.then?(await i)():i)[0],r()}catch(c){r(c)}}))},2799:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{v:()=>d});a(5043);var n=a(7073),s=a(1802),o=a(8441),i=a(579),c=t([n,s,o]);function d(t){let{storyVars:e}=t;return(0,i.jsxs)("div",{className:"tut-graph-wrapper",children:[(0,i.jsx)(o.D,{id:"pag-bar-graph",label:s.G[n.A.PAG_OBJECTIVE].display_name,bucketInterper:e.bucketInterperPAG}),(0,i.jsx)(o.D,{id:"prf-bar-graph",label:s.G[n.A.PRF_OBJECTIVE].display_name,bucketInterper:e.bucketInterperPRF})]})}[n,s,o]=c.then?(await c)():c,r()}catch(l){r(l)}}))},8429:(t,e,a)=>{a.d(e,{d:()=>n});a(5043);var r=a(579);function n(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:"From Bar Graphs to Buckets"}),(0,r.jsxs)("p",{children:["This is the average yearly amount of water each group receives, specifically from the ",(0,r.jsx)("b",{children:"Central Valley Project"}),", one of two water municipalities in California."]}),(0,r.jsxs)("ul",{className:"ag-annot",children:[(0,r.jsx)("li",{children:"higher water supply"}),(0,r.jsx)("li",{children:"but more likely to be around 300-500 TAF"})]}),(0,r.jsx)("ul",{className:"ref-annot",children:(0,r.jsx)("li",{children:"consistently lower water supply"})})]})}},9246:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{k:()=>h});a(5043);var n=a(7073),s=a(1802),o=a(6531),i=a(3403),c=a(355),l=a(579),d=t([n,s,o]);function h(t){let{storyVars:e,size:a}=t;return(0,l.jsxs)("div",{className:"tut-drop-graphics-wrapper",children:[(0,l.jsx)("h2",{children:"Seeing Scenarios"}),(0,l.jsxs)("div",{className:"waterdrop-graphics-wrapper",children:[(0,l.jsx)(c.f,{objectiveLabel:s.G[n.A.PAG_OBJECTIVE].display_name,dropInterper:e.dropInterper,histData:n.A.PAG_DELIVS,histRange:[0,o.j.MIN_MAXES[n.A.PAG_OBJECTIVE][1]],goal:e.userGoal,setGoal:t=>{e.setUserGoal(t)},size:a}),(0,l.jsx)(i.V,{variations:n.A.DROP_VARIATIONS.map((t=>({...t,interper:e.variationInterpers[t.idx],histData:n.A.VARIATIONS_DELIVS[t.idx]}))),goal:e.userGoal,setGoal:t=>{e.setUserGoal(t)},histRange:[0,o.j.MIN_MAXES[n.A.PAG_OBJECTIVE][1]],size:a})]})]})}[n,s,o]=d.then?(await d)():d,r()}catch(u){r(u)}}))},7187:(t,e,a)=>{a.d(e,{P:()=>s});a(5043);var r=a(972),n=a(579);function s(t){let{connectLine:e}=t;return(0,n.jsx)("div",{className:"connect-line",style:(0,r.Ej)(...e),children:(0,n.jsx)("div",{className:"connect-line-container"})})}},4636:(t,e,a)=>{a.d(e,{m:()=>o});var r=a(1676),n=(a(5043),a(3999)),s=a(579);function o(t){let{children:e}=t;return(0,s.jsx)(n.h,{offset:.8,onStepEnter:async t=>{var e;let{data:a,direction:r,element:n}=t;"up"!==r&&(null===(e=a.animHandler)||void 0===e||e.do())},onStepExit:async t=>{var e;let{data:a,direction:r,element:n}=t;"down"!==r&&(null===(e=a.animHandler)||void 0===e||e.undo())},onStepProgress:async t=>{let{data:e,direction:a,element:n,progress:s}=t;r.select(n).select("div").style("transform","translateY(".concat(r.scaleLinear().domain([0,.2,.8,1]).range([200,0,0,200])(s),"%)")).style("opacity","".concat(r.scaleLinear().domain([0,.2,.8,1]).range([0,1,1,0])(s)))},threshold:1,children:e})}},7919:(t,e,a)=>{a.d(e,{A:()=>h});var r=a(1676),n=a(5043),s=a(1684);function o(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return function(o){a=a||1,n=n||r.extent(o);const i=o.length/a,c=r.bin().value((t=>t)).domain(n).thresholds(function(t,e,a){return r.range(a).map((r=>r/(a-1)*(e-t)+t))}(...n,Math.ceil(t/(e/i))))(o),l=(0,s.E3)(c,a,i),d=[];for(let t=0;t<l.length;t++)for(let e=0;e<l[t];e++)d.push([(c[t].x1+c[t].x0)/2,(e+.5)/i*o.length]);return d}}var i=a(9550),c=a(579);const l=20,d={top:20,right:20,bottom:45,left:20},u={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}};function h(t){let{data:e,range:a=[0,r.max(e)],goal:s,setGoal:h,width:p=600,height:m=400,shortForm:f=!1}=t;const g=(0,n.useRef)(),y=(0,n.useRef)(),A=(0,n.useRef)(),x=(0,n.useMemo)((()=>o(p,m,e.length/l,a)(e)),[e]),_=[0,e.length],v=r.scaleLinear().domain(a).range([0,p]),w=r.scaleLinear().domain(_).range([m,0]),b=x.filter((t=>t[0]>s)).length;return(0,n.useLayoutEffect)((()=>{A.current.attr("width",p+d.left+d.right).attr("height",m+d.top+d.bottom).style("pointer-events","none").append("g").attr("class","graph-area").attr("transform","translate(".concat(d.left,",").concat(d.top,")")).append("g").attr("transform","translate(0, ".concat(m,")")).call(r.axisBottom().scale(r.scaleLinear().domain(a).range([0,p])).ticks(8).tickFormat(r.format(".2s"))).call((t=>{t.selectAll("line").attr("stroke","gray"),t.selectAll("path").attr("stroke","gray"),t.selectAll("text").attr("fill","gray")})).append("text").attr("fill","black").attr("transform","translate(".concat(p/2,", ",40,")")).text("Delivery (TAF)"),g.current.style.transform="translateX(".concat(r.scaleLinear().domain(a).range([d.left,p+d.left]).clamp(!0)(s),"px)");const t=t=>t.preventDefault();let e=!1;g.current.addEventListener("mousedown",(()=>{e=!0,window.addEventListener("selectstart",t)})),document.addEventListener("mouseup",(()=>{e=!1,window.removeEventListener("selectstart",t)})),y.current.addEventListener("mousemove",(t=>{if(e&&t.target===y.current){const e=(0,i.qE)(t.offsetX,d.left,d.left+p);r.select(g.current).style("transform","translateX(".concat(e,"px)")),h(r.scaleLinear().domain([d.left,p+d.left]).range(a).clamp(!0)(t.offsetX))}}))}),[]),(0,n.useLayoutEffect)((()=>{A.current.select(".graph-area").selectAll(".icons").data(x).join((t=>t.append("g").call((t=>t.append("path"))))).attr("class","icons").call((t=>{t.selectAll("path").attr("d",r.symbol(u,m/l))})).attr("transform",(t=>"translate(".concat(v(t[0]),",").concat(w(t[1]),")"))).attr("fill",(t=>t[0]>s?"steelblue":"black")),g.current.style.transform="translateX(".concat(r.scaleLinear().domain(a).range([d.left,p+d.left]).clamp(!0)(s),"px)")}),[s,x]),(0,c.jsxs)("div",{className:"dot-histogram-wrapper",ref:t=>y.current=t,children:[(0,c.jsx)("div",{className:"pdf-razor "+(f?"short-form":""),ref:t=>g.current=t,children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("span",{children:[(0,c.jsxs)("u",{children:[x.length-b," / ",l]})," ",f?"":"yrs WILL NOT meet demand"]}),(0,c.jsxs)("span",{children:[(0,c.jsxs)("u",{children:[b," / ",l]})," ",f?"":"yrs WILL meet demand"]})]})}),(0,c.jsx)("svg",{ref:t=>{A.current=r.select(t)}})]})}},6767:(t,e,a)=>{a.d(e,{A:()=>l});var r=a(1676),n=a(5043),s=a(3408),o=a(1684),i=a(579);const c=10;function l(t){let{levelInterp:e,colorInterp:a=o.YW,width:l=200,height:d=400,resolution:u=c}=t;const h=l-6,p=d-3,m=(0,n.useRef)();return(0,n.useLayoutEffect)((function(){m.current.attr("width",l).attr("height",d).append("g").attr("class","bucket").attr("transform","translate(".concat(3,", ").concat(1.5,")")).call((0,s.Qj)(h,p,s.R1))}),[]),(0,n.useLayoutEffect)((function(){const t=(0,o.kd)(0,1,u+1).map((t=>e(t))),r=(0,s.fq)(h,p,o.m8),n=m.current.select(".masked-area").selectAll(".bucket-box").data(r(t)).join("rect").attr("class","bucket-box").attr("width",(t=>t.width)).attr("height",(t=>t.height)).attr("x",(t=>t.x)).attr("fill",((t,e)=>a(e/u)));(0,s.Uy)(n,200/d).attr("y",(t=>t.y))}),[e]),(0,i.jsx)("div",{className:"waterdrop-wrapper",children:(0,i.jsx)("svg",{ref:t=>{m.current=r.select(t)}})})}},355:(t,e,a)=>{a.d(e,{f:()=>o});a(5043);var r=a(6767),n=a(7919),s=a(579);function o(t){let{objectiveLabel:e,dropInterper:a,histData:o,histRange:i,goal:c,setGoal:l,size:d}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"main-waterdrop",children:[(0,s.jsx)(r.A,{levelInterp:a,width:d,height:d,resolution:4}),(0,s.jsxs)("p",{className:"var-scen-label",children:["scenario ",(0,s.jsx)("span",{className:"scen-number",children:"0000"})]}),(0,s.jsx)("p",{className:"fancy-font objective-label",children:e}),(0,s.jsx)("p",{className:"volume-not-height",children:"Water supply represented by volume of water inside droplet, not height of water level"})]}),(0,s.jsx)("div",{className:"main-histogram",children:(0,s.jsx)(n.A,{width:d,height:2*d/3,data:o,range:i,goal:c,setGoal:l})})]})}},2031:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{j:()=>u});var n=a(1676),s=a(5043),o=a(7073),i=a(4082),c=a(579),l=t([o,i]);function u(t){let{}=t;return(0,s.useEffect)((function(){const t=window.innerHeight,e=.9*t,a=[o.A.PAG_OBJECTIVE,o.A.PRF_OBJECTIVE],r=n.select("#tut-map-california").attr("width",e).attr("height",t),s=n.geoMercator().scale(3e3*t/800).center(i.l.CALIFORNIA_CENTER).translate([e/2,t/2]),c=[...i.l.SPATIAL_DATA.features.filter((t=>a.includes(t.properties.CalLiteID))),i.l.CALIFORNIA_OUTLINE];r.selectAll("path").data(c).join("path").attr("d",(t=>n.geoPath().projection(s)(t))).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("stroke","transparent").attr("stroke-width",1).style("transform-origin",(t=>{const[e,a]=s(t.geometry.coordinates[0][0][0]);return"".concat(e,"px ").concat(a,"px")})).attr("fill","#EFEBE0").style("filter","drop-shadow(6px 6px 18px rgba(0, 0, 0, 0.3))"),r.select(".".concat(o.A.PAG_OBJECTIVE)).attr("fill",o.A.PAG_COLOR).raise(),r.select(".".concat(o.A.PRF_OBJECTIVE)).attr("fill",o.A.PRF_COLOR).raise()}),[]),(0,c.jsx)("svg",{className:"tut-map-california",id:"tut-map-california"})}[o,i]=l.then?(await l)():l,r()}catch(d){r(d)}}))},5829:(t,e,a)=>{a.a(t,(async(t,e)=>{try{a(1676),a(5043);var r=a(7073),n=(a(579),t([r]));r=(n.then?(await n)():n)[0],e()}catch(s){e(s)}}))},8687:(t,e,a)=>{a.d(e,{A:()=>o});var r=a(1676),n=(a(5043),a(9152)),s=a(579);function o(t){let{settings:e,setColorSetting:a}=t;return(0,s.jsx)("div",{className:"scen-settings comp-settings",children:e.map(((t,e)=>(0,s.jsxs)("div",{className:"full-card",onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),title:n.xz[e],children:[(0,s.jsx)("span",{children:n.RZ[e]}),(0,s.jsx)("span",{children:n.j9[e][t]}),(0,s.jsx)("div",{className:"sett-dot-wrapper",children:r.range(n.j9[e].length).map((a=>(0,s.jsx)("span",{className:"sett-dot ".concat(a<=t?"filled":"not-filled"),style:{opacity:(a+1)/n.j9[e].length}},a)))})]},e)))})}},9083:(t,e,a)=>{a.d(e,{A:()=>o});var r=a(1676),n=(a(5043),a(9152)),s=a(579);function o(t){let{settings:e,setColorSetting:a}=t;return(0,s.jsxs)("div",{className:"scen-settings",children:[(0,s.jsx)("div",{className:"condense",children:e.map(((t,e)=>(0,s.jsxs)("div",{className:"sett-dot-wrapper",children:[(0,s.jsx)("span",{children:n.kr[e]}),r.range(t+1).map((t=>(0,s.jsx)("span",{className:"sett-dot",style:{opacity:(t+1)/n.j9[e].length}},t)))]},e)))}),(0,s.jsx)("div",{className:"full",children:(0,s.jsxs)("div",{className:"full-container",children:[(0,s.jsx)("span",{children:"The settings for this scenario are:"}),e.map(((t,e)=>(0,s.jsxs)("div",{className:"full-card",onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),title:n.xz[e],children:[(0,s.jsx)("span",{children:n.RZ[e]}),(0,s.jsx)("span",{children:n.j9[e][t]}),(0,s.jsx)("div",{className:"sett-dot-wrapper",children:r.range(n.j9[e].length).map((a=>(0,s.jsx)("span",{className:"sett-dot ".concat(a<=t?"filled":"not-filled"),style:{opacity:(a+1)/n.j9[e].length}},a)))})]},e)))]})})]})}},7940:(t,e,a)=>{a.d(e,{s:()=>o});var r=a(1676),n=a(5043),s=a(579);function o(t){let{onClick:e}=t;return(0,n.useEffect)((function(){const t=document.documentElement.scrollTop;window.addEventListener("scroll",(function(){const e=document.documentElement.scrollTop,a=Math.max(0,1-(e-t)/50);r.select(".skip-btn").style("opacity",a)}))}),[]),(0,s.jsx)("button",{className:"skip-btn",onClick:e,children:"Skip intro"})}},2288:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>l});a(5043);var n=a(7940),s=a(2031),o=a(579),i=t([s]);function l(t){let{appCtx:e}=t;return(0,o.jsx)("div",{className:"tut-hero",children:(0,o.jsxs)("div",{className:"tut-hero-container",children:[(0,o.jsxs)("h1",{children:["Watering ",(0,o.jsx)("br",{})," the Future"]}),(0,o.jsx)(s.j,{}),(0,o.jsx)("p",{children:"Water is limited in California, yet everyone needs it. So how can we deal with the agricultural, environmental, urban, and other water demands of California?"}),(0,o.jsxs)("p",{children:["To start off, we'll focus on two groups: the"," ",(0,o.jsx)("span",{id:"ag-group",children:"agriculture group in the north"})," and the"," ",(0,o.jsx)("span",{id:"ref-group",children:"refuge group in the south."})]}),(0,o.jsx)("p",{children:"Scroll through this page to explore!"}),(0,o.jsx)(n.s,{onClick:()=>e.setState({state:"WideView"})})]})})}s=(i.then?(await i)():i)[0],r()}catch(c){r(c)}}))},3403:(t,e,a)=>{a.d(e,{V:()=>o});a(5043);var r=a(6767),n=a(7919),s=a(579);function o(t){let{variations:e,goal:a,setGoal:o,histRange:i,size:c}=t;return e.map((t=>{let{idx:e,scen:l,clas:d,desc:u,interper:h,histData:p}=t;return(0,s.jsxs)("div",{className:"vardrop ".concat(d),desc:u,children:[(0,s.jsx)(r.A,{levelInterp:h,width:.7*c,height:.7*c,resolution:4}),(0,s.jsxs)("p",{className:"var-scen-label",children:["scenario ",(0,s.jsx)("span",{className:"scen-number",children:l})]}),(0,s.jsx)(n.A,{shortForm:!0,width:c,height:2*c/3,data:p,range:i,goal:a,setGoal:o})]},e)}))}},3693:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{G:()=>i});var n=a(4956);async function o(){console.log("DATA: loading descriptions data");const t=await(await fetch("./descriptions.json")).json();return(0,n.Et)(t,(t=>{let{id:e}=t;return e}))}const i=await o();r()}catch(s){r(s)}}),1)},1802:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{G:()=>i});var n=a(4956);async function o(){console.log("DATA: loading descriptions tutorial data");const t=await(await fetch("./descriptions_tutorial.json")).json();return(0,n.Et)(t,(t=>{let{id:e}=t;return e}))}const i=await o();r()}catch(s){r(s)}}),1)},8058:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{j:()=>u});var n=a(1676),s=a(9152),o=a(9550),i=a(4956);const l=1;async function d(){const t="scens",e="delivs",a="expl0000",r=await async function(){console.log("DATA: loading objectives data");const a=await(await fetch("./objectives_v3.json")).json(),r=a[0][t].filter(((t,e)=>e%l===0||"expl0000"===t)).map((t=>{let{name:e}=t;return e}));for(const s of a){const a=(0,o.k4)(s[t]);for(let t=a.length-1;t>=0;t--){const s=a[t];r.includes(s.name)?s[e].sort(n.descending):a.splice(t,1)}s[t]=(0,i.Et)(s[t],(t=>{let{name:e}=t;return e}))}return(0,i.Et)(a,(t=>{let{obj:e}=t;return e}))}(),c=Object.keys(r),d=function(){const t={};for(let e=0;e<c.length;e++)t[c[e]]=0;return t}(),u=Object.keys(Object.values(r)[0][t]),h=function(){const t={},e=Object.values(s.hU);for(let a=0;a<u.length;a++){const r=u[a];t[r]=(0,s.iu)(r.slice(4)).map(((t,a)=>(t+1)/e[a]))}return t}(),p=function(){const s={};for(const o of c){const i=n.max(r[o][t][a][e]);n.min(u.map((a=>n.min(r[o][t][a][e]))));s[o]=[0,i]}return s}(),[m,f]=function(){const a=[],s={objective:{},scenario:{}},o=[];let i=0;for(const d of c)for(const c of u){s.objective[d]||(s.objective[d]=[]),s.scenario[c]||(s.scenario[c]=[]),s.objective[d].push(i),s.scenario[c].push(i);const l=r[d][t][c][e];a.push({id:i,objective:d,scenario:c,deliveries:l}),o.push(n.mean(l)),i++}const l={};for(const t of Object.keys(s)){const e=[];for(const i of Object.keys(s[t])){const r=s[t][i],c=r.sort(((t,e)=>o[e]-o[t]));e.push({key:i,sorted:c,mean:n.mean(r.map((t=>{const e=a[t].deliveries,r=p[a[t].objective][1];return e.map((t=>t/r))})).flat())})}const r=e.sort(((t,e)=>e.mean-t.mean));l[t]={};for(let a=0;a<r.length;a++){const{key:e,sorted:n}=r[a],s={};for(let t=0;t<n.length;t++)s[n[t]]=t;l[t][e]=s,l[t][e].rank=a}}return[a,l]}();return{MAX_DELIVS:1200,SCENARIO_KEY_STRING:t,DELIV_KEY_STRING:e,BASELINE_SCEN:a,OBJECTIVES_DATA:r,OBJECTIVE_IDS:c,OBJECTIVE_GOALS_MAP:d,SCENARIO_IDS:u,KEY_SETTINGS_MAP:h,MIN_MAXES:p,FLATTENED_DATA:m,DATA_GROUPINGS:f}}const u=await d();r()}catch(c){r(c)}}),1)},6531:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{j:()=>d});var n=a(1676),s=a(9152),o=a(9550),i=a(4956);async function l(){const t="scens",e="delivs",a="baseline_yearly",r="expl0000",c=await async function(){console.log("DATA: loading objectives tutorial data");const s=await(await fetch("./objectives_tutorial.json")).json();for(const c of s){for(const s of(0,o.k4)(c[t]))s.name===r&&(c[a]=Array.from(s[e])),s[e]=s[e].sort(n.descending);c[t]=(0,i.Et)(c[t],(t=>{let{name:e}=t;return e}))}return(0,i.Et)(s,(t=>{let{obj:e}=t;return e}))}(),l=Object.keys(c),d=function(){const t={};for(let e=0;e<l.length;e++)t[l[e]]=200;return t}(),u=Object.keys(Object.values(c)[0][t]),h=function(){const t={},e=Object.values(s.hU);for(let a=0;a<u.length;a++){const r=u[a];t[r]=(0,s.iu)(r.slice(4)).map(((t,a)=>(t+1)/e[a]))}return t}(),p=function(){const a={};for(const s of l){const o=n.max(c[s][t][r][e]);n.min(u.map((a=>n.min(c[s][t][a][e]))));a[s]=[0,o]}return a}(),[m,f]=function(){const a=[],r={objective:{},scenario:{}},s=[];let o=0;for(const d of l)for(const i of u){r.objective[d]||(r.objective[d]=[]),r.scenario[i]||(r.scenario[i]=[]),r.objective[d].push(o),r.scenario[i].push(o);const l=c[d][t][i][e];a.push({id:o,objective:d,scenario:i,deliveries:l}),s.push(n.mean(l)),o++}const i={};for(const t of Object.keys(r)){const e=[];for(const i of Object.keys(r[t])){const o=r[t][i],c=o.sort(((t,e)=>s[e]-s[t]));e.push({key:i,sorted:c,mean:n.mean(o.map((t=>a[t].deliveries)).flat())})}const o=e.sort(((t,e)=>e.mean-t.mean));i[t]={};for(let a=0;a<o.length;a++){const{key:e,sorted:r}=o[a],n={};for(let t=0;t<r.length;t++)n[r[t]]=t;i[t][e]=n,i[t][e].rank=a}}return[a,i]}();return{MAX_DELIVS:800,SCENARIO_KEY_STRING:t,DELIV_KEY_STRING:e,BASELINE_YRLY_KEY_STRING:a,BASELINE_SCEN:r,OBJECTIVES_DATA:c,OBJECTIVE_IDS:l,OBJECTIVE_GOALS_MAP:d,SCENARIO_IDS:u,KEY_SETTINGS_MAP:h,MIN_MAXES:p,FLATTENED_DATA:m,DATA_GROUPINGS:f}}const d=await l();r()}catch(c){r(c)}}),1)},4082:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{l:()=>i});var n=a(4956);async function o(){const t=await async function(){console.log("DATA: loading callite spatial data");return await(await fetch("./callite_spatial.json")).json()}(),e=(0,n.Et)(t.features,(t=>{let{properties:e}=t;return e.CalLiteID})),a=await async function(){console.log("DATA: loading california spatial data");return await(await fetch("./california.json")).json()}();return{SPATIAL_DATA:t,SPATIAL_FEATURES:e,CALIFORNIA_OUTLINE:a,CALIFORNIA_CENTER:[-119,37.7749]}}const i=await o();r()}catch(s){r(s)}}),1)},9336:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>f});var n=a(1676),s=a(5043),o=a(3956),i=a(8058),c=a(3693),l=a(6924),d=t([i,c]);[i,c]=d.then?(await d)():d;const h=window.innerWidth,p=window.innerHeight,m=(0,l.c)(i.j,c.G,"objective");function f(){const[t,e]=(0,s.useState)({}),[a,r]=(0,s.useState)([]),[c,l]=(0,s.useState)(null),[d,u]=(0,s.useState)(i.j.OBJECTIVE_GOALS_MAP),f=(0,s.useRef)([]),g=(0,s.useRef)(!1);(0,s.useEffect)((function(){o.e.renderer.setSize(h,p),console.time("drops mesh creating"),o.e.dropsMesh.createMesh(m),console.timeEnd("drops mesh creating"),document.querySelector("#mosaic-webgl").appendChild(o.e.renderer.domElement),n.select("#mosaic-svg").attr("width",h).attr("height",p);const t=n.scaleLinear().domain([p/m.height,p/m.groups[0].height]).range([.1,1]).clamp(!0);o.e.camera.create({width:h,height:p,webglElement:n.select(".bubbles-wrapper").node(),svgElement:n.select("#mosaic-svg").select(".svg-trans").node(),zoomFn:e=>{g.current||o.e.dropsMesh.updateOutlineVisibility(t(e.k));for(const t of f.current)t(e)}}),o.e.renderer.setAnimationLoop((()=>{o.e.renderer.render(o.e.scene,o.e.camera.camera)})),e({state:"TutorialView"})}),[]);const y=(0,s.useCallback)((t=>n.scaleLinear().domain([p/m.height,p/m.groups[0].height]).range([.1,1]).clamp(!0)(t)),[]),A=(0,s.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;const a=1.2*m.height,r=[0,.08*-m.height,o.e.camera.getZFromFarHeight(a)];let n=0;if(t){const[t,a]=x(r,e);n=a,t()}else o.e.camera.callZoomFromWorldViewport({worldX:r[0],worldY:-r[1],farHeight:a}),e&&e();return n}),[]),x=(0,s.useCallback)((function(t,e){const a=o.e.camera.interpolateZoomCamera(t),r=a.duration/2;return[()=>{const t=n.timer((n=>{const s=Math.min(n/r,1);o.e.camera.callZoom(a(s)),1===s&&(t.stop(),e&&e())}))},r]}),[]),_=(0,s.useCallback)((function(t){f.current.push(t)}),[]),v=(0,s.useCallback)((function(t){g.current=t}));return{appWidth:h,appHeight:p,state:t,setState:e,activeWaterdrops:a,setActiveWaterdrops:r,setDisableCamAdjustments:v,waterdrops:m,goBack:c,setGoBack:l,zoomTo:x,resetCamera:A,getOutlineOpacity:y,addZoomHandler:_,goals:d,setGoals:u,...o.e}}r()}catch(u){r(u)}}))},9514:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{C:()=>p});var n=a(1676),s=a(5043),o=a(2385),i=a(972),c=a(9550),l=a(7073),d=a(6016),u=t([l]);function p(){const[t,e]=(0,s.useState)(),a=(0,s.useRef)(),r=(0,s.useRef)({});return(0,s.useEffect)((function(){if(t){const[e,r]=d._.calcLinesAndPositions(a.current,t);!function(e){const[r,s]=e,i=a.current.groups[0].height*o.W.SPREAD_1_2/15,c=a.current.groups[0].height*o.W.SPREAD_1_2/10;n.select("#comparer-graphics").select("#member-label").text("scenario").attr("font-size",i).transition().duration(100).attr("x",r).attr("y",s-1.5*i),n.select("#comparer-graphics").select("#member-variable").attr("font-size",c).text(t.slice(4)).transition().duration(100).attr("x",r).attr("y",s)}((0,c.p6)(e)),function(t,e){n.select("#comparer-graphics .indicator-group").selectAll(".circlet").data(t).join("circle").attr("class","circlet").call(i.JB).attr("r",1.5*o.W.LOD_1_RAD_PX).transition().duration(100).attr("cx",(t=>t[0])).attr("cy",(t=>t[1])),n.select("#comparer-graphics .indicator-group").selectAll(".comp-line").data(e).join("path").attr("class","comp-line").transition().duration(100).attr("d",(t=>n.line()(t))),n.select("#comparer-graphics .indicator-group").raise()}(e,r)}}),[t]),{initComparer:function(t,s){a.current=d._.getWaterdropGroups([l.A.PAG_OBJECTIVE,l.A.PRF_OBJECTIVE],t,[0,0],.6);const c=2*t.groups[0].height*o.W.SPREAD_1_2*1,u=s.height/c;let h=s.width/2,p=s.height/2;const m={x:h,y:p,k:u};h=-a.current.groupPositions[0].x*u+s.width/2,p=a.current.groupPositions[0].y*u+s.height/2;const f={x:h,y:p,k:u};r.current.firstDrop=f,r.current.midpoint=m;const g=n.select("#comparer-graphics").attr("width",window.innerWidth-20).attr("height",window.innerHeight).append("g").attr("class","svg-group").attr("transform",n.zoomIdentity.translate(f.x,f.y).scale(f.k));d._.updateDropsSVG(g,a.current,0,{onHover:t=>{e(t.key)}});const y=g.append("g").attr("class","indicator-group");y.append("text").attr("id","member-variable"),y.append("text").attr("id","member-label"),e(l.A.DEFAULT_SCENARIO),(0,i.f2)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),g)},showOtherDrop:function(){const t=n.select("#comparer-graphics");t.select(".svg-group").transition().attr("transform",n.zoomIdentity.translate(r.current.midpoint.x,r.current.midpoint.y).scale(r.current.midpoint.k)),(0,i.YB)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),t)},hideOtherDrop:function(){const t=n.select("#comparer-graphics");t.select(".svg-group").transition().attr("transform",n.zoomIdentity.translate(r.current.firstDrop.x,r.current.firstDrop.y).scale(r.current.firstDrop.k)),(0,i.f2)(".large-drop.".concat(l.A.PRF_OBJECTIVE,", .indicator-group"),t)}}}l=(u.then?(await u)():u)[0],r()}catch(h){r(h)}}))},4757:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{R:()=>u});var n=a(5043),s=a(9514),o=a(419),i=a(5413),c=a(7066),l=t([s,o,i]);function u(t,e){const[a,r]=(0,n.useState)([]),c=(0,o.d)(),l=(0,s.C)();return{hookAnimations:(0,n.useCallback)((function(){l.initComparer(t,e);const a={deps:{...c,largeDropComparer:l}},n=i.W.initShowLocationAnimGroup(a),s=i.W.initChartAnimGroup(a),o=i.W.initBucketsFillAnim(a),d=i.W.initMoveBucketsAnim(a),u=i.W.initDropFillAnim(a),h=i.W.initChangeRealityAnim(a),p=i.W.initFillVarDropsAnim(a),m=i.W.initShowScenLabelAnim(a),f=i.W.initHighlightBestAnim(a),g=i.W.initShowQuantilesAnim(a),y=i.W.initComparerAnimGroup(a),A=[{name:"howMuchIntro"},{name:"norCal",animHandler:n.showPAG},{name:"soCal",animHandler:n.showPRF},{name:"barsExplain",animHandler:s.barsAppear},{name:"barsCondense",animHandler:s.barsCondense},{name:"bucketsFill",animHandler:o},{name:"comparingTheTwo",animHandler:d},{name:"forNowLetsFocus",animHandler:u},{name:"ifChangeReality",animHandler:h},{name:"fortunateCanExplore",animHandler:p},{name:"theseVarsCalled",animHandler:m},{name:"atAGlance",animHandler:f},{name:"tryMoveRed",animHandler:g},{name:"soWhyNot",animHandler:y.showPAG},{name:"letsBringRefuge",animHandler:y.showPRF}];r(A)}),[t,e]),getSlidesInRange:(0,n.useCallback)((function(t,e){let r,n;for(let s=0;s<a.length;s++)if(a[s].name===t)r=s;else if(a[s].name===e){n=s;break}return h(a.slice(r,n+1))}),[a]),storyVars:c}}function h(t){return t.map((t=>({...t,script:c.P[t.name]})))}[s,o,i]=l.then?(await l)():l,r()}catch(d){r(d)}}))},419:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{d:()=>l});var n=a(1676),s=a(5043),o=a(7073),i=t([o]);function l(){const[t,e]=(0,s.useState)(200),[a,r]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[i,c]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[l,d]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[u,h]=(0,s.useState)((()=>o.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0])))));return{userGoal:t,setUserGoal:e,bucketInterperPAG:a,setBucketInterperPAG:r,bucketInterperPRF:i,setBucketInterperPRF:c,dropInterper:l,setDropInterper:d,variationInterpers:u,setVariationInterpers:h}}o=(i.then?(await i)():i)[0],r()}catch(c){r(c)}}))},4987:(t,e,a)=>{a.d(e,{J:()=>o});var r=a(5043),n=a(972),s=a(4956);function o(t){const[e,a,o]=(0,s.iJ)([]),i=(0,r.useRef)({});(0,r.useEffect)((function(){window.addEventListener("mousemove",(t=>{void 0!==i.current.startX&&(i.current.deltaX=t.x-i.current.startX,i.current.deltaY=t.y-i.current.startY,a((t=>{if(void 0===i.current.startX)return t;const e=t.find((t=>t.id===i.current.id));return e.offsetX=e.oldOffsetX+i.current.deltaX,e.offsetY=e.oldOffsetY+i.current.deltaY,[...t]})))})),window.addEventListener("mouseup",(t=>{void 0!==i.current.startX&&(i.current={})}))}),[]);const c=(0,r.useCallback)((function(t,e){let{id:r}=e;""!==t.target.className&&(t.preventDefault(),i.current={startX:t.clientX,startY:t.clientY,id:r},a((t=>{const e=t.find((t=>t.id===r));return e.oldOffsetX=e.offsetX,e.oldOffsetY=e.offsetY,[...t]})))}),[]);return{panels:e,panelsRef:o,setPanels:a,onPanelDragStart:c,getPanelStyle:function(e){let{x:a,y:r,offsetX:s,offsetY:o}=e;const[i,c]=(0,n.UK)(a,r,t);return{left:"".concat(i+s,"px"),top:"".concat(c+o,"px")}}}}},2385:(t,e,a)=>{a.d(e,{W:()=>r});const r={LOD_1_LEVELS:4,LOD_1_RAD_PX:1,LOD_1_MIN_LEV_VAL:.1,LOD_1_SMALL_DROP_PAD_FACTOR:3,LOD_1_LARGE_DROP_PAD_FACTOR:1.2,LOD_2_SMALL_DROP_PAD_FACTOR:3,GROUP_HOVER_AREA_FACTOR:1.1/(1+Math.SQRT1_2),SPREAD_1_2:1}},3956:(t,e,a)=>{a.d(e,{e:()=>x});var r=a(9408),n=a(4473),s=a(8341),o=a(1676),i=a(1684),c=a(2385),l=a(4956),d=a(9550),u=a(972);class h{constructor(){this.added=!1}createMesh(t){this.dropsMesh?this.updateMeshes(t):this.initializeMeshes(t)}draw(t){this.added||(t.add(this.dropsMesh),t.add(this.outlineMesh),this.added=!0)}remove(t){this.added&&(t.remove(this.dropsMesh),t.remove(this.outlineMesh),this.added=!1)}initializeMeshes(t){const e=new A(h.MAX_POINTS_DROPS),a=[],n=(0,u.bp)(0,1,2*c.W.LOD_1_RAD_PX*.975);for(let s=0;s<t.nodes.length;s++){const{id:o,globalX:h,globalY:p,levs:m,maxLev:f,globalTilt:g}=t.nodes[s];for(let t=m.length-1;t>=0;t--){const a=t!==m.length-1?m[t+1]:0,n=m[t],o=(0,u.Ng)((0,i.m8)(a/f),(0,i.m8)(n/f),2*c.W.LOD_1_RAD_PX),l=new r.Q1f((0,i.YW)(t/c.W.LOD_1_LEVELS));e.addMeshCoords(o,{x:h,y:-p,rotate:g},l,s%5/50+.02)}const y=(0,d.Hb)((0,l.K7)(n),g);a.push(...y.map((t=>{let[e,a]=t;return new r.Pq0(h+e,-p-a,s%5/50+.01)})))}e.finish(),this.dropsMesh=new r.eaF(e.threeGeom,new r.V9B({vertexColors:!0,transparent:!0,opacity:1})),this.outlineMesh=new r.DXC((new r.LoY).setFromPoints(a),new r.mrM({color:13421772,transparent:!0,opacity:0}))}updateOutlineVisibility(t){this.outlineMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0)}updateVisibility(t){this.outlineMesh&&this.dropsMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0,this.dropsMesh.material.opacity=t,this.dropsMesh.material.needsUpdate=!0)}updateMeshes(t){}}h.MAX_POINTS_DROPS=78e5,h.MAX_POINTS_OUTLINE=52e5;var p=(0,s.A)("finishCreate"),m=(0,s.A)("THREEHandleZoom");class f{constructor(t){let{fov:e,near:a,far:n}=t;Object.defineProperty(this,m,{value:y}),Object.defineProperty(this,p,{value:g}),this.raycaster=new r.tBo,this.fov=e,this.near=a,this.far=n}create(t){let{width:e,height:a,webglElement:r,svgElement:s,zoomFn:i}=t;this.width=e,this.height=a,this.webglView=o.select(r),this.svgView=o.select(s),this.zoom=o.zoom().on("zoom",(t=>{this.curTransform=t.transform,(0,n.A)(this,m)[m](t.transform),this.svgView.attr("transform",t.transform),i&&i(t.transform)})),(0,n.A)(this,p)[p]()}callZoom(t){this.zoom.transform(this.webglView,o.zoomIdentity.translate(t.x,t.y).scale(t.k))}callZoomFromWorldViewport(t){let{worldX:e,worldY:a,farHeight:r}=t;const n=this.height/r,s=-e*n+this.width/2,o=a*n+this.height/2;this.callZoom({x:s,y:o,k:n})}interpolateZoomCamera(t){let[e,a,r]=t;const n=o.interpolateZoom([this.camera.position.x,this.camera.position.y,this.height/this.curTransform.k],[e,-a,this.getFarHeightFromZ(r)]),s=t=>{const[e,a,r]=n(t),s=this.height/r;return{x:-e*s+this.width/2,y:a*s+this.height/2,k:s}};return s.duration=n.duration,s}getZFromFarHeight(t){return Math.tan((0,d.eh)(90-this.fov/2))*t/2}getFarHeightFromZ(t){return Math.tan((0,d.eh)(this.fov)/2)*t*2}getScaleFromZ(t){const e=this.getFarHeightFromZ(t);return this.height/e}getZFromScale(t){const e=this.height/t;return this.getZFromFarHeight(e)}intersectObject(t,e,a){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(a)}worldToScreen(t,e){return(0,u.UK)(t,e,this.curTransform)}screenToWorld(t,e){return(0,u.UT)(t,e,this.curTransform)}}function g(){this.zoom=this.zoom.scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]),this.camera=new r.ubm(this.fov,this.width/this.height,this.near,this.far+1),this.camera.position.set(0,0,this.far),this.webglView.call(this.zoom),this.zoom.transform(this.webglView,o.zoomIdentity.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}function y(t){const e=t.k,a=-(t.x-this.width/2)/e,r=(t.y-this.height/2)/e,n=this.getZFromScale(e);this.camera.position.set(a,r,n)}class A{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.threeGeom=new r.LoY,this.triangleIdx=0,this.threeGeom.setAttribute("position",new r.THS(new Float32Array(3*t),3)),e&&this.threeGeom.setAttribute("color",new r.THS(new Float32Array(3*t),3)),this.positionAttribute=this.threeGeom.getAttribute("position"),this.colorAttribute=this.threeGeom.getAttribute("color")}addMeshCoords(t,e,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(let n=0;n<t.length;n++){const[s,o,i]=(0,d.Hb)((0,l.K7)(t[n]),e.rotate);this.positionAttribute.setXYZ(3*this.triangleIdx+0,e.x+s[0],e.y-s[1],r),this.positionAttribute.setXYZ(3*this.triangleIdx+1,e.x+o[0],e.y-o[1],r),this.positionAttribute.setXYZ(3*this.triangleIdx+2,e.x+i[0],e.y-i[1],r),a&&(this.colorAttribute.setXYZ(3*this.triangleIdx+0,a.r,a.g,a.b),this.colorAttribute.setXYZ(3*this.triangleIdx+1,a.r,a.g,a.b),this.colorAttribute.setXYZ(3*this.triangleIdx+2,a.r,a.g,a.b)),this.triangleIdx++}}finish(){this.threeGeom.setDrawRange(0,3*this.triangleIdx)}}const x=function(){const t=function(){const t=new r.Z58;return t.background=new r.Q1f(15723488),t}(),e=new h;return{scene:t,camera:new f({fov:45,near:1,far:3e3}),renderer:new r.JeP({antialias:!0}),dropsMesh:e}}()},6016:(t,e,a)=>{a.d(e,{_:()=>l});var r=a(1676),n=a(2385),s=a(9550),o=a(972);function i(t){let{nodes:e,height:a,key:s}=t;return t=>{t.attr("class","large-drop "+s),t.append("circle").attr("class","highlight-circle").attr("stroke","none").attr("fill","yellow").attr("r",2*n.W.LOD_1_RAD_PX),t.append("g").attr("class","baseline-pointer").call((function(t){t.append("path"),t.append("text").text("baseline")})),t.append("text").style("font-size",a*n.W.SPREAD_1_2/15).attr("class","drop-label fancy-font").attr("text-anchor","middle"),t.selectAll(".small-drop").data(e).enter().append("g").attr("class","small-drop").each((function(t){r.select(this).call(function(t){let{levs:e,id:a}=t;return t=>{t.append("rect").attr("class","bbox").style("visibility","hidden");const r="compare-grad-".concat(a);t.call((0,o.ji)(e,r)),t.append("path").attr("d",o.js).attr("class","outline").attr("transform","scale(".concat(.95*n.W.LOD_1_RAD_PX,")")),t.append("path").attr("class","fill").attr("d",o.js).attr("fill","url(#".concat(r,")")).attr("transform","scale(".concat(n.W.LOD_1_RAD_PX,")"))}}(t))}))}}function c(t,e,a){let{nodes:i,height:c,display_name:l}=t,{isLeft:d,isBottom:u}=e;return t=>{const e={};t.call(function(t,e){return a=>{a.select(".drop-label").attr("x",0).attr("y",e/2*n.W.SPREAD_1_2*.9).call((0,o.Y_)(t,1.2,30))}}(l,c)).selectAll(".small-drop").data(i).attr("display","initial").attr("transform",(t=>{let{x:e,y:a,tilt:r}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(r,")")})).each((function(t){r.select(this).call(function(t,e){let{key:a,levs:r,maxLev:n,x:s,y:i}=t;return t=>{"expl0000"===a&&(e.x=s,e.y=i),t.call((0,o.GI)(r,n));const c=t.select(".fill").node().getBBox();t.select(".bbox").attr("x",c.x).attr("y",c.y).attr("width",c.width).attr("height",c.height)}}(t,e))})).transition().delay(a).duration(1e3).attr("transform",(t=>{let{x:e,y:a,tilt:r}=t;return"translate(".concat(e*n.W.SPREAD_1_2,", ").concat(a*n.W.SPREAD_1_2,") rotate(").concat(r,")")})),t.select(".highlight-circle").attr("cx",e.x).attr("cy",e.y-(0,s.jF)({rad:n.W.LOD_1_RAD_PX})).transition().delay(a).duration(1e3).attr("cx",e.x*n.W.SPREAD_1_2).attr("cy",e.y*n.W.SPREAD_1_2-(0,s.jF)({rad:n.W.LOD_1_RAD_PX}));const h=e.x*n.W.SPREAD_1_2,p=e.y*n.W.SPREAD_1_2-(0,s.jF)({rad:n.W.LOD_1_RAD_PX}),m=c*n.W.SPREAD_1_2/2*(d?-1:1),f=c*n.W.SPREAD_1_2/2*(u?1:-1),g=c/20,y=c/100;t.select(".baseline-pointer path").attr("d",r.line().x((t=>t[0])).y((t=>t[1]))([[h,p],[m,f]])).attr("stroke-width",y),t.select(".baseline-pointer text").attr("class","fancy-font").attr("font-size",g).attr("text-anchor",d?"end":"start").attr("transform","translate(".concat(m+g*(d?-1:1),", ").concat(f,")"))}}const l={updateDropsSVG:function(t,e,a,n){let{onClick:s,onHover:o,onUnhover:l}=n;t.selectAll(".large-drop").data(e.groups).join((t=>t.append("g").each((function(t){r.select(this).call(i(t))})))).attr("transform",(t=>{let{x:e,y:a,tilt:r}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(r,")")})).each((function(t,n){const i=r.select(this).call(c(t,e.groupPositions[n],a)).selectAll(".small-drop");s&&i.on("click",(function(t,e){s(e)})),o&&i.on("mouseenter",(function(t,e){r.select(this.parentNode).raise(),o(e)})),l&&i.on("mouseleave",(function(t,e){l(e)}))})).transition().delay(a).duration(1e3).attr("transform",((t,a)=>"translate(".concat(e.groupPositions[a].x,", ").concat(e.groupPositions[a].y,")")))},updateColorDrops:function(t,e,a,s){t.selectAll(".color-drop-group").data(e.groups).join((t=>t.append("g").each((function(t){let{nodes:e}=t;r.select(this).call((t=>{t.attr("class","color-drop-group").selectAll(".color-drop").data(e).join("circle").attr("class","color-drop").attr("r",n.W.LOD_1_RAD_PX)}))})))).attr("transform",((t,a)=>"translate(".concat(e.groupPositions[a].x,", ").concat(e.groupPositions[a].y,")"))).each((function(){r.select(this).selectAll(".color-drop").call((t=>{t.attr("opacity",(t=>{let{key:e}=t;return a(e)})).attr("fill",s)})).attr("cx",(t=>{let{x:e}=t;return e*n.W.SPREAD_1_2})).attr("cy",(t=>{let{y:e}=t;return e*n.W.SPREAD_1_2}))}))},getWaterdropGroups:function(t,e,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.75;const s=t.map((t=>e.groups.find((e=>e.key===t)))),o=[],i=s[0].height*n.W.SPREAD_1_2*r;for(let n=0,c=s.length;n<c;n++){const t=2*Math.PI/c*(n-.5)-Math.PI/2,e=a[0]+Math.cos(t)*i,r=a[1]+Math.sin(t)*i,s=e<a[0],l=r>a[1];o.push({x:e,y:r,isLeft:s,isBottom:l})}return{groups:s,groupPositions:o}},calcLinesAndPositions:function(t,e){const a=[],r=[];for(let i=0;i<t.groups.length;i++){const o=t.groups[i],c=t.groupPositions[i],l=o.nodes.find((t=>t.key===e));r.push(l),a.push([l.x*n.W.SPREAD_1_2+c.x,l.y*n.W.SPREAD_1_2+c.y-(0,s.jF)({rad:n.W.LOD_1_RAD_PX})])}const o=[];for(let i=0;i<a.length;i++){const t=Array.from(a[i]),e=Array.from(a[i+1==a.length?0:i+1]);(0,s.D5)([t,e],2*n.W.LOD_1_RAD_PX),o.push([t,e])}return[a,o,r]},updateLabelSVG:function(t,e,a){const[n,s]=t,o=a/15,i=a/10;r.select("#compare-group").select("#member-label").text("scenario").attr("font-size",o).transition().duration(100).attr("x",n).attr("y",s-1.5*o),r.select("#compare-group").select("#member-variable").attr("font-size",i).text(e).transition().duration(100).attr("x",n).attr("y",s)},updateScenIndicatorsSVG:function(t,e){r.select("#compare-group").selectAll(".circlet").data(t).join("circle").attr("class","circlet").call(o.JB).attr("display","initial").attr("r",1.5*n.W.LOD_1_RAD_PX).raise().transition().duration(100).attr("cx",(t=>t[0])).attr("cy",(t=>t[1])),r.select("#compare-group").selectAll(".comp-line").data(e).join("path").attr("class","comp-line").raise().transition().duration(100).attr("d",(t=>r.line()(t)))}}},5413:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{W:()=>l});var n=a(1676),s=a(7073),o=a(6531),i=a(972),c=t([s,o]);[s,o]=c.then?(await c)():c;const l={initShowLocationAnimGroup:function(){return{showPAG:{do:function(){n.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray")},undo:function(){n.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",1).transition().attr("fill","transparent")}},showPRF:{do:function(){n.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",1).transition().attr("fill","transparent"),n.select("#tut-minimap").select(".outline."+s.A.PRF_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray")},undo:function(){n.select("#tut-minimap").select(".outline."+s.A.PAG_OBJECTIVE).style("scale",10).transition().style("scale",1).attr("fill","gray"),n.select("#tut-minimap").select(".outline."+s.A.PRF_OBJECTIVE).transition().attr("fill","transparent")}}}},initChartAnimGroup:function(){let t,e,a,r,i,c;const l=40,d=30,u=40,h=60;return function(){{const e=n.select("#pag-bar-graph").attr("width",s.A.BAR_CHART_WIDTH+h+d).attr("height",s.A.BAR_CHART_HEIGHT+l+u).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(h,",").concat(l,")")),r=o.j.OBJECTIVES_DATA[s.A.PAG_OBJECTIVE][o.j.BASELINE_YRLY_KEY_STRING].map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(n.descending),c=n.scaleBand().domain(r.map((t=>{let{year:e}=t;return e})).sort(n.ascending)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4),p=n.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]),m=n.axisBottom(c).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(c.domain().filter(((t,e)=>0===e||(e+1)%10===0)));e.append("g").attr("class","anim-xaxis"),e.append("g").attr("class","axis-y"),e.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).call(m).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),e.select(".axis-y").call(n.axisLeft(p)),t=c,a=m,i=r}{const t=n.select("#prf-bar-graph").attr("width",s.A.BAR_CHART_WIDTH+h+d).attr("height",s.A.BAR_CHART_HEIGHT+l+u).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(h,",").concat(l,")")),a=o.j.OBJECTIVES_DATA[s.A.PRF_OBJECTIVE][o.j.BASELINE_YRLY_KEY_STRING].map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(n.descending),i=n.scaleBand().domain(a.map((t=>{let{year:e}=t;return e})).sort(n.ascending)).range([0,s.A.BAR_CHART_WIDTH]).padding(.4),p=n.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]),m=n.axisBottom(i).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(i.domain().filter(((t,e)=>0===e||(e+1)%10===0)));t.append("g").attr("class","anim-xaxis"),t.append("g").attr("class","axis-y"),t.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).call(m).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),t.select(".axis-y").call(n.axisLeft(p)),e=i,r=m,c=a}}(),{barsAppear:{do:function(){{const e=n.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]);n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(i,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(e=>t(e.year))).attr("y",s.A.BAR_CHART_HEIGHT).attr("width",t.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(t=>e(t.val))).attr("height",(t=>s.A.BAR_CHART_HEIGHT-e(t.val)))}{const t=n.scaleLinear().domain([0,o.j.MAX_DELIVS]).range([s.A.BAR_CHART_HEIGHT,0]);n.select("#prf-bar-graph .svg-group").selectAll(".bars").data(c,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(t=>e(t.year))).attr("y",s.A.BAR_CHART_HEIGHT).attr("width",e.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(e=>t(e.val))).attr("height",(e=>s.A.BAR_CHART_HEIGHT-t(e.val)))}},undo:function(){n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(i,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(i.length-t.placeFromLeft-1))).attr("y",s.A.BAR_CHART_HEIGHT).attr("height",0),n.select("#prf-bar-graph .svg-group").selectAll(".bars").data(c,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(c.length-t.placeFromLeft-1))).attr("y",s.A.BAR_CHART_HEIGHT).attr("height",0)}},barsCondense:{do:async function(){{const t=s.A.BAR_CHART_WIDTH/8,e=n.select("#pag-bar-graph .svg-group");e.select(".anim-xaxis").call(a.tickFormat(""));const r=e.selectAll(".bars");r.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((t=>100+1e3*(1-(1-t.placeFromLeft/i.length)**4))).duration(500).attr("width",t).attr("x",s.A.BAR_CHART_WIDTH/2-t/2).end().catch((()=>{})).then((()=>{e.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),r.transition().delay(500).attr("x",0),e.transition().delay(500).attr("transform","translate(".concat(h+s.A.BAR_CHART_WIDTH/2-t/2,",").concat(l,")"))}))}{const t=s.A.BAR_CHART_WIDTH/8,e=n.select("#prf-bar-graph .svg-group");e.select(".anim-xaxis").call(r.tickFormat(""));const a=e.selectAll(".bars");a.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((t=>100+1e3*(1-(1-t.placeFromLeft/c.length)**4))).duration(500).attr("width",t).attr("x",s.A.BAR_CHART_WIDTH/2-t/2).end().catch((()=>{})).then((()=>{e.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),a.transition().delay(500).attr("x",0),e.transition().delay(500).attr("transform","translate(".concat(h+s.A.BAR_CHART_WIDTH/2-t/2,",").concat(l,")"))}))}},undo:function(){{const r=n.select("#pag-bar-graph .svg-group"),o=r.selectAll(".bars");r.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),r.select(".anim-xaxis").call(a.tickFormat((t=>"year ".concat(t)))),r.transition().delay(500).attr("transform","translate(".concat(h,",").concat(l,")")),o.transition().delay((t=>100+1e3*(1-(t.placeFromLeft/i.length)**4))).duration(500).attr("x",(t=>e(t.year))).attr("width",t.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{o.style("mix-blend-mode","normal")}))}{const t=n.select("#prf-bar-graph .svg-group"),a=t.selectAll(".bars");t.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),t.select(".anim-xaxis").call(r.tickFormat((t=>"year ".concat(t)))),t.transition().delay(500).attr("transform","translate(".concat(h,",").concat(l,")")),a.transition().delay((t=>100+1e3*(1-(t.placeFromLeft/c.length)**4))).duration(500).attr("x",(t=>e(t.year))).attr("width",e.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{a.style("mix-blend-mode","normal")}))}}}}},initBucketsFillAnim:function(t){let{deps:e}=t;return{do:function(){n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","initial"),n.select("#pag-bar-graph").attr("opacity",0),n.select("#prf-bar-graph").attr("opacity",0),e.setBucketInterperPAG((()=>s.A.PAG_INTERPER)),e.setBucketInterperPRF((()=>s.A.PRF_INTERPER))},undo:function(){e.setBucketInterperPAG((()=>n.scaleLinear().range([0,0]))),e.setBucketInterperPRF((()=>n.scaleLinear().range([0,0]))),n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","none"),n.select("#pag-bar-graph").transition().attr("opacity",1),n.select("#prf-bar-graph").transition().attr("opacity",1)}}},initMoveBucketsAnim:function(t){let{deps:e}=t;return{do:function(){(0,i.YB)(".ag-annot, .ref-annot")},undo:function(){(0,i.f2)(".ag-annot, .ref-annot")}}},initDropFillAnim:function(t){let{deps:e}=t;return{do:function(){e.setDropInterper((()=>s.A.PAG_INTERPER_DROP))},undo:function(){e.setDropInterper((()=>n.scaleLinear().range([0,0])))}}},initChangeRealityAnim:function(){return{do:function(){n.selectAll(".vardrop").style("display","initial").classed("hasarrow",!0),(0,i.f2)(".main-waterdrop .objective-label, .main-waterdrop .volume-not-height, .waterdrop-explain-pag")},undo:function(){n.selectAll(".vardrop").style("display","none").classed("hasarrow",!1),(0,i.YB)(".main-waterdrop .objective-label, .main-waterdrop .volume-not-height, .waterdrop-explain-pag")}}},initFillVarDropsAnim:function(t){let{deps:e}=t;return{do:function(){n.selectAll(".vardrop path").style("stroke-dasharray","none"),e.setVariationInterpers(s.A.VARIATIONS_INTERPERS)},undo:function(){n.selectAll(".vardrop path").style("stroke-dasharray","10 10"),e.setVariationInterpers(s.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0]))))}}},initShowScenLabelAnim:function(){return{do:function(){n.selectAll(".var-scen-label").style("display","block")},undo:function(){n.selectAll(".var-scen-label").style("display","none")}}},initHighlightBestAnim:function(){return{do:function(){n.select(".drop1").classed("highlighted",!0)},undo:function(){n.select(".drop1").classed("highlighted",!1)}}},initShowQuantilesAnim:function(){return{do:function(){n.select(".drop1").classed("highlighted",!1),n.selectAll(".vardrop").classed("hasarrow",!1),n.selectAll(".var-scen-label").style("opacity","0.5"),n.selectAll(".var-scen-label, .scen-number").style("color","gray"),n.select(".main-waterdrop").transition().style("transform","translateY(-100px) scale(0.5)"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(2)"),n.selectAll(".drop1 .waterdrop-wrapper, .drop3 .waterdrop-wrapper").transition().style("transform","translate(-50px, 15px) scale(0.5)"),n.selectAll(".drop2 .waterdrop-wrapper, .drop4 .waterdrop-wrapper").transition().style("transform","translate(50px, 15px) scale(0.5)"),n.select(".main-histogram").style("display","initial"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","flex")},undo:function(){n.select(".drop1").classed("highlighted",!0),n.selectAll(".vardrop").classed("hasarrow",!0),n.selectAll(".var-scen-label").style("opacity","1"),n.selectAll(".var-scen-label").style("color","black"),n.selectAll(".scen-number").style("color","#CC8F43"),n.select(".main-waterdrop").transition().style("transform","none"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(1)"),n.selectAll(".drop1 .waterdrop-wrapper, .drop3 .waterdrop-wrapper").transition().style("transform","none"),n.selectAll(".drop2 .waterdrop-wrapper, .drop4 .waterdrop-wrapper").transition().style("transform","none"),n.select(".main-histogram").style("display","none"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","none")}}},initComparerAnimGroup:function(t){let{deps:e}=t;return{showPAG:{do:function(){(0,i.f2)(".scrollama-compare-scenobjs .waterdrop-graphics-wrapper"),(0,i.YB)(".scrollama-compare-scenobjs .tut-comparer-graphics-wrapper")},undo:function(){(0,i.YB)(".scrollama-compare-scenobjs .waterdrop-graphics-wrapper",n,"grid"),(0,i.f2)(".scrollama-compare-scenobjs .tut-comparer-graphics-wrapper")}},showPRF:{do:function(){e.largeDropComparer.showOtherDrop()},undo:function(){e.largeDropComparer.hideOtherDrop()}}}}};r()}catch(l){r(l)}}))},9152:(t,e,a)=>{a.d(e,{Dq:()=>h,Dy:()=>u,RZ:()=>m,hU:()=>g,iu:()=>A,j9:()=>f,kr:()=>p,xz:()=>y});var r,n,s,o,i,c=a(7528),l=a(1676),d=a(1684);function u(t,e,a){return l.scaleLinear().domain((0,d.kd)(0,1,t.length)).range(t.map((t=>Math.min(1,(t-e)/(a-e))))).clamp(!0)}function h(t){t=[1,...t,0];let e=0;for(let a=0;a<t.length-1;a++){e+=(t[a]-t[a+1])*(a-1)/(t.length+4)}return e}const p=["D","C","P","R","M"],m=["Demand","Carryover","Priority","Regs.","Min. Flow"],f=[[1,.9,.8,.7,.6].reverse(),[1,1.2,1.3],[0,1],[1,2,3,4],[0,.4,.6,.7,.8]],g={demand:f[0].length,carryover:f[1].length,priority:f[2].length,regs:f[3].length,minflow:f[4].length},y=[String.raw(r||(r=(0,c.A)(["Reduce total agriculture demands\n(1) Reduce 40%\n(2) Reduce 30%\n(3) Reduce 20%\n(4) Reduce 10%\n(5) Baseline"]))),String.raw(n||(n=(0,c.A)(["Modify balance of reservoir storage and delivery\n(1) Baseline\n(2) Increase carryover (relative to delivery) 10%\n(3) Increase carryover to 20%"]))),String.raw(s||(s=(0,c.A)(["Modify how CVP cuts are distributed during times of shortage\n(1) Baseline\n(2) Equal cuts"]))),String.raw(o||(o=(0,c.A)(['Selective removal/activation of D1641 regulations\n(1) Baseline (all "on")\n(2) No NDO, Rio Vista min flows\n(3) No X2/salinity\n(4) Combined no NDO + no X2']))),String.raw(i||(i=(0,c.A)(["Modify/add minimum flow on Central Valley tributaries\n(1) Baseline\n(2) 40% unimpaired flow on main tributaries\n(3) 60% unimpaired flow\n(4) 70% unimpaired flow\n(5) 80% unimpaired flow"])))];function A(t){let e=parseInt(t);const a=e%g.minflow;e=(e-a)/g.minflow;const r=e%g.regs;e=(e-r)/g.regs;const n=e%g.priority;e=(e-n)/g.priority;const s=e%g.carryover;e=(e-s)/g.carryover;const o=e%g.demand;return[g.demand-1-o,s,n,r,a]}},9060:(t,e,a)=>{a.d(e,{_:()=>i});var r=a(1676),n=a(2385),s=a(9550),o=a(972);const i={updateSmallDropSVG:function(t,e,a,i){let{onClick:c,onHover:l,onUnhover:d}=i;const u={},h=t.selectAll(".small-drop").data(e.nodes).join((t=>t.append("g").each((function(t){r.select(this).call(function(t){let{levs:e,id:a}=t;return t=>{t.attr("class","small-drop hover-capture");const r="drop-fill-".concat(a);t.call((0,o.ji)(e,r)),t.append("path").attr("d",o.js).attr("class","outline"),t.append("path").attr("class","fill").attr("d",o.js).attr("fill","url(#".concat(r,")")),t.append("circle").attr("class","circlet interactive").call(o.JB).attr("cy",-(0,s.jF)({rad:1})).attr("r",1.5),t.append("rect").attr("class","bbox").style("visibility","hidden")}}(t))})))).attr("transform",(t=>{let{globalX:e,globalY:a,globalTilt:r}=t;return"translate(".concat(e,", ").concat(a,") rotate(").concat(r,")")})).each((function(t){r.select(this).call(function(t,e){let{key:a,levs:r,maxLev:s,id:i,x:c,y:l}=t;return t=>{"expl0000"===a&&(e.x=c,e.y=l),t.call((0,o.GI)(r,s)),t.select(".outline").attr("transform","scale(".concat(.95*n.W.LOD_1_RAD_PX,")")),t.select(".fill").attr("transform","scale(".concat(n.W.LOD_1_RAD_PX,")")),t.select(".circlet").attr("id","i".concat(i));const d=t.select(".fill").node().getBBox();t.select(".bbox").attr("x",d.x).attr("y",d.y).attr("width",d.width).attr("height",d.height)}}(t,u))}));c&&h.on("click",(function(t,e){c(e)})),l&&h.on("mouseenter",(function(t,e){l(e)})),d&&h.on("mouseleave",(function(t,e){d(e)})),h.transition().delay(a).duration(1e3).attr("transform",(t=>{let{x:a,y:r,tilt:s}=t;return"translate(".concat(e.x+a*n.W.SPREAD_1_2,", ").concat(e.y+r*n.W.SPREAD_1_2,") rotate(").concat(s,")")}));const p=e.x+u.x*n.W.SPREAD_1_2,m=e.y+u.y*n.W.SPREAD_1_2-(0,s.jF)({rad:n.W.LOD_1_RAD_PX}),f=e.x+e.height*n.W.SPREAD_1_2/2,g=e.y-e.height*n.W.SPREAD_1_2/2,y=e.height/20,A=e.height/100;t.select(".highlight-circle").attr("stroke","none").attr("fill","yellow").attr("r",2*n.W.LOD_1_RAD_PX).attr("cx",p).attr("cy",m),t.select(".baseline-pointer path").attr("d",r.line().x((t=>t[0])).y((t=>t[1]))([[p,m],[f,g]])).attr("stroke-width",A),t.select(".baseline-pointer text").attr("class","fancy-font").attr("font-size",y).attr("transform","translate(".concat(f+y,", ").concat(g,")"))},updateColorDrops:function(t,e,a,r){t.selectAll(".color-drop").data(e.nodes).join("circle").attr("class","color-drop").attr("r",n.W.LOD_1_RAD_PX).attr("opacity",(t=>{let{key:e}=t;return a(e)})).attr("fill",r).attr("cx",(t=>{let{x:a}=t;return e.x+a*n.W.SPREAD_1_2})).attr("cy",(t=>{let{y:a}=t;return e.y+a*n.W.SPREAD_1_2}))}}},9550:(t,e,a)=>{a.d(e,{D5:()=>x,Hb:()=>b,eh:()=>g,hh:()=>f,jF:()=>_,k4:()=>E,kt:()=>A,p6:()=>v,qE:()=>c,sR:()=>w,xg:()=>y});var r=a(1676),n=a(9408),s=a(3783),o=a.n(s),i=a(972);function c(t,e,a){return Math.max(e,Math.min(a,t))}function l(t){const e=t/2,a=3*Math.PI/2/16,r=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let n=0;n<=16;n++)r.push({x:Math.cos(n*a-Math.PI/4)*e,y:Math.sin(n*a-Math.PI/4)*e});return r}const d=function(){const t=l(3),e=l(1),a=[];for(let r=0;r<t.length-2;r++)a.push([t[r],t[r+(r<2?1:2)],e[r+(r<2?1:2)],e[r]]);return a}();let u,h,p,m;function f(t,e,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s&&p&&a.length===m)return p;u&&a.length===h||(u=r.range(4).map((()=>function(t,e){const a=o().Bounds.create(t),n=a.min.x,s=a.max.x,i=a.min.y,c=a.max.y,l=r.scaleLinear([n,s]),d=r.scaleLinear([i,c]),u=[];for(let r=0;r<e;r++)for(;;){const e=l(Math.random()),a=d(Math.random());if(o().Vertices.contains(t,{x:e,y:a})){u.push([e,a]);break}}return u}(l(1),h=a.length))));const c=function(t){const e=r.sum(t.map((t=>t**2*3.14)));return Math.floor(Math.sqrt(e/3.14))}(a.map((t=>{let{r:e}=t;return e})))/n,f=u[Math.floor(Math.random()*u.length)].map((t=>{let[e,a]=t;return[e*c,a*c]})),g=o().Engine,y=o().Bodies,A=o().Composite,x=g.create(),_=f.sort(((t,e)=>e[1]-t[1])),v=a.map(((t,e)=>{let{r:a,id:r}=t;const[n,s]=_[e];return y.circle(n,s,a,{restitution:0,id:r})})),w=d.map((t=>o().Body.create({position:o().Vertices.centre(t),vertices:t,isStatic:!0}))),b=o().Body.create({isStatic:!0});o().Body.setParts(b,w),o().Body.setCentre(b,{x:0,y:0}),o().Body.scale(b,c,c),A.add(x.world,[...v,b]);for(let r=0,o=60,i=.1;r<o*i;r++)g.update(x,1e3/o);const E=v.map((a=>{let{position:r,id:n}=a;return{id:n,x:r.x+t,y:r.y+e}}));return E.height=c/2/i.Sz*i.IC,!s||p&&E.length===m||(p=E,m=E.length),E}function g(t){return t*Math.PI/180}function y(t,e){let[a,r]=t,[n,s]=e;return Math.sqrt(function(t,e){let[a,r]=t,[n,s]=e;return(n-a)**2+(s-r)**2}([a,r],[n,s]))}function A(t){return[t.left+t.width/2,t.top+t.height/2]}function x(t,e,a){let[r,n]=t;const s=Math.sqrt((r[0]-n[0])**2+(r[1]-n[1])**2),o=[(n[0]-r[0])/s,(n[1]-r[1])/s];return void 0===a&&(a=e),r[0]+=o[0]*e,r[1]+=o[1]*e,n[0]-=o[0]*a,n[1]-=o[1]*a,[r,n]}function _(t){let{rad:e,height:a}=t;return void 0!==e?.08*function(t){return(1+Math.SQRT2)*t}(e):.08*a}function v(t){return[r.mean(t,(t=>t[0])),r.mean(t,(t=>t[1]))]}function w(t,e,a){const r=new n.Pq0(t,e,0).applyEuler(new n.O9p(0,0,g(a)));return[r.x,r.y]}function b(t,e){for(const a of t){const t=w(a[0],a[1],e);a[0]=t[0],a[1]=t[1]}return t}function E(t){let e=t.length;for(;0!=e;){let a=Math.floor(Math.random()*e);e--,[t[e],t[a]]=[t[a],t[e]]}return t}},4956:(t,e,a)=>{a.d(e,{Et:()=>n,K7:()=>l,LV:()=>i,ad:()=>o,iJ:()=>s,od:()=>c});var r=a(5043);function n(t,e){const a=Object.groupBy(t,e);for(const r of Object.keys(a))a[r]=a[r][0];return a}function s(t){const[e,a]=(0,r.useState)(t),n=(0,r.useRef)(t);(0,r.useEffect)((()=>{n.current=e}),[e]);const s=(0,r.useCallback)((t=>{a("function"===typeof t?e=>n.current=t(e):n.current=t)}),[]);return[e,s,n]}function o(t,e){return t&&t.state===e}function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return t.replace(new RegExp("(?![^\\n]{1,".concat(e,"}$)([^\\n]{1,").concat(e,"})\\s"),"g"),"$1\n")}function c(t,e){let a;return a="function"===typeof e?t.findIndex(e):t.indexOf(e),-1!==a&&t.splice(a,1),t}function l(t){return t.map((t=>Array.from(t)))}},972:(t,e,a)=>{a.d(e,{Ej:()=>D,GI:()=>j,IC:()=>p,JB:()=>_,Ng:()=>x,Sz:()=>d,UK:()=>R,UT:()=>I,YB:()=>v,Y_:()=>T,bp:()=>A,f2:()=>w,h7:()=>b,ji:()=>E,js:()=>l});var r=a(1684),n=a(1676),s=a(2385),o=a(2186),i=a(4956),c=a(9550);const l="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z",d=Math.SQRT1_2,u=1,h=d+d,p=u+d,m=(d+u/2)/p;function f(t){if(t>=m){return Math.SQRT1_2*(1-t)/(1-m)}const e=2*(1-t/(h/p))-1,a=Math.acos(e);return Math.sin(a)}function g(t){return(t-d/p)*(1+Math.SQRT2)}function y(t){return t/(1+Math.SQRT2)+d/p}function A(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(Math.abs(t-e)<.01)return[];const n=a/2/u*d,s=1/r,o=[],i=[];let c,l,h,p;for(let d=1;d<=Math.ceil(1/s)&&(c=f(t+(d-1)*s),l=g(t+(d-1)*s),h=f(t+d*s),p=g(t+d*s),!(y(p)>=e));d++){const t=[-c*n,-l*n],e=[c*n,-l*n],a=[h*n,-p*n],r=[-h*n,-p*n];o.push(e,a),i.push(t,r)}h=f(e),p=g(e);const m=[-c*n,-l*n],A=[c*n,-l*n],x=[h*n,-p*n],_=[-h*n,-p*n];return o.push(A,x),i.push(m,_),o.push(...i.reverse()),o}function x(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=a/2/u*d,n=.1,s=[];let o,i,c,l;for(let d=1;d<=Math.ceil(10)&&(o=f(t+(d-1)*n),i=g(t+(d-1)*n),c=f(t+d*n),l=g(t+d*n),!(y(l)>=e));d++){const t=[-o*r,-i*r],e=[o*r,-i*r],a=[c*r,-l*r],n=[-c*r,-l*r];s.push([t,e,a]),s.push([t,a,n])}c=f(e),l=g(e);const h=[-o*r,-i*r],p=[o*r,-i*r],m=[c*r,-l*r],A=[-c*r,-l*r];return s.push([h,p,m]),s.push([h,m,A]),s}function _(t){t.attr("fill","transparent").attr("stroke","#CC8F43").attr("stroke-dasharray",3).attr("stroke-width",3).attr("vector-effect","non-scaling-stroke")}function v(t,e,a){(e||n).selectAll(t).style("display",a||"block")}function w(t,e){(e||n).selectAll(t).style("display","none")}function b(t,e){(e||n).selectAll(t).remove()}function E(t,e){return a=>{const n=a.append("defs").append("linearGradient").attr("id",e).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");n.append("stop").attr("stop-color","transparent"),n.append("stop").attr("stop-color","transparent"),t.forEach(((t,e)=>{for(let a=0;a<2;a++)n.append("stop").attr("stop-color",(0,r.YW)(e/s.W.LOD_1_LEVELS))}))}}function j(t,e){return a=>{a.selectAll("stop").each((function(a,s){if(0===s)return void n.select(this).attr("offset","0%");if(s===2*(t.length+1)-1)return void n.select(this).attr("offset","100%");let o=Math.floor((s-1)/2);n.select(this).attr("offset","".concat(100*(1-(0,r.m8)(t[o]/e)),"%"))}))}}function R(t,e,a){return[t*a.k+a.x,e*a.k+a.y]}function I(t,e,a){return[(t-a.x)/a.k,(e-a.y)/a.k]}function T(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return r=>{r.selectAll("*").remove();const n="string"===typeof t?(0,i.LV)(t,a).split("\n"):t,s=r.attr("x");n.forEach((t=>{r.append("tspan").attr("x",s).attr("dy","".concat(e,"em")).text(t)}))}}function D(t,e){const a=(0,c.xg)(t,e),r=(0,o.H)(Math.atan2(e[1]-t[1],e[0]-t[0]));return{left:"".concat(t[0],"px"),top:"".concat(t[1],"px"),width:"".concat(a,"px"),rotate:"".concat(r,"deg")}}},7066:(t,e,a)=>{a.d(e,{P:()=>n});a(5043);var r=a(579);const n={barsExplain:(0,r.jsx)(r.Fragment,{children:"Here, the data is presented as bar graphs, with the bottom axis representing the year and the side axis representing the amount of water delivered in thousand acre-feet (TAF)."}),barsCondense:(0,r.jsx)(r.Fragment,{children:"We'll condense each bar graph into a single bar with a filled gradient."}),bucketsFill:(0,r.jsxs)(r.Fragment,{children:["What we get are buckets of water showing which water levels are most likely, with the darker areas being the most likely water levels.",(0,r.jsxs)("span",{className:"supplement-card-info",children:["Visuals made using"," ",(0,r.jsx)("a",{href:"https://sarahayu.github.io/bucket-glyph/",target:"_blank",children:"Bucket-Glyph"})]})]}),comparingTheTwo:(0,r.jsx)(r.Fragment,{children:"If we want a reliable supply we would want the refuge group's deliveries, but if we want a chance at higher supplies of water however with more inconsistent results, we would want the agriculture group's deliveries."}),forNowLetsFocus:(0,r.jsx)(r.Fragment,{children:"There is a chance 600 TAF of water will be delivered to this group. The darker colors, however, indicate that it's more likely that slightly less than 600 TAF of water will be delivered \u2014 around 500 TAF. As we'll later see, this is not a lot compared to other areas of California."}),ifChangeReality:(0,r.jsxs)(r.Fragment,{children:["But what if we could ",(0,r.jsx)("em",{children:"change reality"}),"? What if we could increase the likelihood of delivering as much water as possible by changing the way we manage it?"]}),fortunateCanExplore:(0,r.jsxs)(r.Fragment,{children:["Fortunately, we can explore those possibilities with the help of a simulator called",(0,r.jsx)("b",{children:" CalSim"}),"."]}),theseVarsCalled:(0,r.jsxs)(r.Fragment,{children:["These variations are called ",(0,r.jsx)("em",{children:"scenarios"})," and are labelled with unique numbers. Our reality is a scenario with no variables changed, labelled scenario 0000."]}),atAGlance:(0,r.jsx)(r.Fragment,{children:"At a glance, we can easily see that scenario 0020 appears to be the best scenario since the darker water levels reach higher than those of the other scenarios. To more concretely compare these scenarios, however, we'll use a different view."}),tryMoveRed:(0,r.jsx)(r.Fragment,{children:"Try moving the dotted line to change the minimum demand and see how well each of these scenarios meet those demands."}),soWhyNot:(0,r.jsxs)(r.Fragment,{children:["So why don't we just choose the best scenario? Well, it's because it's not just this group that wants water. Other groups, which we call"," ",(0,r.jsx)("em",{children:"objectives"}),", want scenarios that best fit ",(0,r.jsx)("em",{children:"them."})]}),letsBringRefuge:(0,r.jsx)(r.Fragment,{children:"The scenarios that benefit one objective do not always benefit another. Hover over the waterdrops to see how the same scenarios place for each objective. (Can you find a scenario that benefits both?)"})}},7073:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>d});var n=a(1676),s=a(1684),o=a(6531),i=t([o]);function l(){const t=n.interpolateRgbBasis(["#F2F5FB","#D0DDEB","#7B9BC0","#4F739F","#112A57"]),e="DEL_CVP_PAG_N",a="DEL_CVP_PRF_S",r="expl0000",i=o.j.OBJECTIVES_DATA[e][o.j.SCENARIO_KEY_STRING][r][o.j.DELIV_KEY_STRING],c=o.j.OBJECTIVES_DATA[a][o.j.SCENARIO_KEY_STRING][r][o.j.DELIV_KEY_STRING],l=["expl0020","expl0080","expl0480","expl0004"],d=l.map((t=>o.j.OBJECTIVES_DATA[e][o.j.SCENARIO_KEY_STRING][t][o.j.DELIV_KEY_STRING])),u=d.map((t=>e=>(0,s.m8)(n.scaleLinear().domain((0,s.kd)(0,1,t.length)).range(t.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(e))));return{BAR_CHART_WIDTH:500,BAR_CHART_HEIGHT:400,INTERP_COLOR:t,PAG_OBJECTIVE:e,PRF_OBJECTIVE:a,PAG_COLOR:"#808C54",PRF_COLOR:"#60A4BF",DEFAULT_SCENARIO:r,PAG_DELIVS:i,PRF_DELIVS:c,VARIATIONS:l,VARIATIONS_DELIVS:d,VARIATIONS_INTERPERS:u,PAG_INTERPER:t=>n.scaleLinear().domain((0,s.kd)(0,1,i.length)).range(i.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t),PAG_INTERPER_DROP:t=>(0,s.m8)(n.scaleLinear().domain((0,s.kd)(0,1,i.length)).range(i.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t)),PRF_INTERPER:t=>n.scaleLinear().domain((0,s.kd)(0,1,c.length)).range(c.map((t=>t/o.j.MAX_DELIVS)).sort().reverse()).clamp(!0)(t),DROP_VARIATIONS:[{idx:0,scen:"0020",clas:"drop1",desc:"change priority"},{idx:1,scen:"0080",clas:"drop2",desc:"increase carryover"},{idx:2,scen:"0480",clas:"drop3",desc:"decrease demand"},{idx:3,scen:"0004",clas:"drop4",desc:"increase minimum flow"}]}}o=(i.then?(await i)():i)[0];const d=l();r()}catch(c){r(c)}}))},6924:(t,e,a)=>{a.d(e,{c:()=>c});var r=a(1684),n=a(2385),s=a(9152),o=a(9550),i=a(4956);function c(t,e,a){console.time("init waterdrops");const c="objective"===a?t.OBJECTIVE_IDS:t.SCENARIO_IDS,l="objective"===a?t.SCENARIO_IDS:t.OBJECTIVE_IDS,d=(c.length,l.length),u=Math.sqrt(d/Math.PI)*n.W.LOD_1_RAD_PX*2*n.W.LOD_1_SMALL_DROP_PAD_FACTOR*n.W.LOD_1_LARGE_DROP_PAD_FACTOR,h=n.W.LOD_1_RAD_PX*n.W.LOD_1_SMALL_DROP_PAD_FACTOR,p=(0,o.hh)(0,0,c.map(((t,e)=>({r:u,id:e}))),.8);for(let r=0;r<p.length;r++)p[r].tilt=40*Math.random()-20;const m=(0,i.Et)(p,(t=>{let{id:e}=t;return e})),f=(0,o.hh)(0,0,l.map(((t,e)=>({r:h,id:e})))),g=(0,i.Et)(f,(t=>{let{id:e}=t;return e})),y=[],A=[],x={};for(const i of t.FLATTENED_DATA){const{id:e,objective:c,scenario:l,deliveries:d}=i,[u,h]=t.MIN_MAXES[c],p=(0,s.Dy)(d,u,h),f=(0,r.kd)(0,1,n.W.LOD_1_LEVELS+1).map((t=>p(t))).map(((t,e)=>Math.max(t,0==e?n.W.LOD_1_MIN_LEV_VAL:0)*n.W.LOD_1_RAD_PX)),A="objective"===a?c:l,_="objective"===a?l:c,v=t.DATA_GROUPINGS[a][A].rank,w=t.DATA_GROUPINGS[a][A][e],b=50*Math.random()-25,E=m[v].tilt,{x:j,y:R}=g[w],[I,T]=(0,o.sR)(j,R,E),D={id:e,levs:f,maxLev:n.W.LOD_1_RAD_PX,domLev:(0,s.Dq)(f),tilt:b,dur:100*Math.random()+400,x:j,y:R,group:A,key:_,globalX:m[v].x+I,globalY:m[v].y+T,globalTilt:E+b};y.push(D),x[A]||(x[A]=[]),x[A].push(D)}for(const r of c){const{x:n,y:s,tilt:o}=m[t.DATA_GROUPINGS[a][r].rank];A.push({x:n,y:s,tilt:o,key:r,height:f.height,nodes:x[r],display_name:e[r].display_name||r})}return console.timeEnd("init waterdrops"),{nodes:y,groups:A,height:p.height}}},8330:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{_:()=>v});var n=a(1676),s=a(4082),o=a(2385),i=a(9550),c=a(4956),l=a(972),d=t([s]);function h(){const t=n.select(this);t.append("circle").attr("class","hover-capture").attr("fill","transparent").attr("stroke-width",0).attr("r",.8),t.append("circle").attr("class","circlet interactive").call(l.JB).attr("r",1);const e=t.append("g").attr("pointer-events","none");e.append("image").attr("href","glow.png").attr("preserveAspectRatio","none").attr("opacity",.8),e.append("text").attr("class","fancy-font cloud-text").attr("text-anchor","middle").attr("font-size",0)}function p(t){n.select(this).select(".circlet").attr("id","b".concat(t.key)),n.select(this).select("text").call(m(t))}function m(t){return function(e){e.selectAll("*").remove();const a=(0,c.LV)(t.display_name).split("\n");a.forEach(((t,r)=>{e.append("tspan").attr("x",0).attr("y","".concat(-a.length/2+.5,"em")).attr("dy","".concat(r,"em")).text(t)}))}}function f(t){let{x:e,y:a,height:r}=t;return"translate(".concat(e,", ").concat(a-(0,i.jF)({height:r}),") scale(").concat(r*o.W.GROUP_HOVER_AREA_FACTOR,")")}function g(t,e,a,r){const s=window.innerHeight/9,o=a/r/e;return((i=t*o)>s?0:n.scaleLinear().domain([0,s]).range([1,.4]).clamp(!0)(i))*Math.min(o,.4);var i}function y(){const t=n.select("#minimap").attr("width",250).attr("height",300),e=n.geoMercator().scale(1e3).center(s.l.CALIFORNIA_CENTER).translate([125,150]),a=[...s.l.SPATIAL_DATA.features.filter((t=>"MultiPolygon"===t.geometry.type)),s.l.CALIFORNIA_OUTLINE],r=s.l.SPATIAL_DATA.features.filter((t=>"MultiPoint"===t.geometry.type));t.selectAll("path").data(a).join("path").attr("d",(t=>n.geoPath().projection(e)(t))).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("stroke","transparent").attr("stroke-width",1).attr("fill",(t=>t.properties.CalLiteID?"transparent":"white")).style("filter",(t=>t.properties.CalLiteID?"none":"drop-shadow(6px 6px 18px rgba(0, 0, 0, 0.1))")),t.selectAll("circle").data(r).join("circle").each((function(t){const a=n.select(this),[r,s]=e(t.geometry.coordinates[0]);a.attr("cx",r),a.attr("cy",s)})).attr("r",2).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("fill","transparent")}function A(t,e,a){let{onClick:r,onHover:s,onUnhover:o}=a;const i=t.selectAll(".large-drop").data(e.groups,(t=>{let{key:e}=t;return e})).join((t=>t.append("g").attr("class","large-drop").each(h))).each(p).attr("transform",f).select(".hover-capture");r&&i.on("click",(function(t,e){r(e)})),s&&i.on("mouseenter",(function(t,e){n.select(this.parentNode).raise(),s(e)})),o&&i.on("mouseleave",(function(t,e){o(e)}))}function x(t,e,a){return function(){const r=n.select(this).node(),[s,o]=(0,i.kt)(r.getBoundingClientRect()),c=r.getBBox().width*e.height/e.far*8,l=r.getBBox().height*e.height/e.far*10,d=(0,i.xg)([s,o],[t.mouseX,t.mouseY]);n.select(this).attr("font-size",g(d,t.zoom,e.height,a)),n.select(this.parentNode.parentNode).select("image").attr("x",-c/2).attr("y",-l/2).attr("width",c).attr("height",l)}}function _(t,e,a,r){const s=n.timer((n=>{const o=Math.min(1,n/r);t.updateVisibility(1-o),t.updateOutlineVisibility(a*(1-o)),o>=1&&(s.stop(),t.remove(e))}))}s=(d.then?(await d)():d)[0];const v={drawMinimapSVG:y,updateLargeDropSVG:A,fontSizer:x,fadeOutDrops:_};r()}catch(u){r(u)}}))},4293:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>v});var n=a(1676),s=a(5043),o=a(4096),i=a(7919),c=a(8687),l=a(8058),d=a(2385),u=a(9550),h=a(4956),p=a(972),m=a(9152),f=a(6016),g=a(4987),y=a(6767),A=a(579),x=t([l]);function v(){const t=(0,s.useContext)(o.B),[e,a]=(0,s.useState)(),[r,x]=(0,s.useState)(null),[_,v]=(0,s.useState)(n.zoomIdentity),{panels:w,setPanels:b,onPanelDragStart:E,getPanelStyle:j}=(0,g.J)(_),R=(0,s.useRef)(),I=(0,s.useRef)();return(0,s.useEffect)((function(){const e=n.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","compare-group");e.append("text").attr("id","member-variable"),e.append("text").attr("id","member-label"),t.addZoomHandler((function(t){v(t)}))}),[]),(0,s.useEffect)((function(){if((0,h.ad)(t.state,"CompareView")){const e=n.select("#compare-group"),{viewCenter:r,transitionDuration:s=0}=t.state;return I.current=r,R.current=f._.getWaterdropGroups(t.activeWaterdrops,t.waterdrops,r),f._.updateDropsSVG(e,R.current,s/5,{onHover:t=>{a({key:t.key})}}),(0,p.f2)(".large-green-text, .baseline-pointer, .circlet, .comp-line, .highlight-circle",e),setTimeout((()=>{a({key:R.current.groups[0].nodes[0].key}),(0,p.YB)("#member-variable, #member-label, .large-green-text, .baseline-pointer, .circlet, .comp-line, .highlight-circle",e),(0,p.YB)(".comp-settings",n,"flex")}),s+500),t.setGoBack((()=>()=>{const e=t.resetCamera();t.setState({state:"WideView",transitionDuration:e})})),v(t.camera.curTransform),function(){(0,p.h7)(".large-drop, .circlet, .comp-line",e),(0,p.f2)("#member-variable, #member-label, .baseline-pointer",e),(0,p.f2)(".comp-settings"),b([]),t.setGoBack(null)}}}),[t.state]),(0,s.useEffect)((function(){if(e){const[t,a,r]=f._.calcLinesAndPositions(R.current,e.key);b(function(t){return e=>t.map(((t,a)=>{let r=0,n=0;e[a]&&(r=e[a].offsetX,n=e[a].offsetY);const[s,o,i]=function(t){let{x:e,y:a,isLeft:r}=t,n=e,s=a;const o=R.current.groups[0].height*d.W.SPREAD_1_2;r?n-=o:n+=o;return[n,s,r]}(R.current.groupPositions[a]);return{text:t.key,x:s,y:o,id:R.current.groups[a].key,nodeID:t.id,isLeft:i,offsetX:r,offsetY:n}}))}(r)),f._.updateLabelSVG((0,u.p6)(t),e.key.slice(4),R.current.groups[0].height*d.W.SPREAD_1_2),f._.updateScenIndicatorsSVG(t,a)}}),[e]),(0,s.useEffect)((function(){const t=n.select("#compare-group");if(null===r)return(0,p.f2)(".color-drop-group",t),void(0,p.YB)(".large-drop",t);f._.updateColorDrops(t,R.current,(t=>l.j.KEY_SETTINGS_MAP[t][r]),["red","orange","blue","green","magenta"][r]),(0,p.YB)(".color-drop-group",t),(0,p.f2)(".large-drop",t)}),[r]),(0,A.jsxs)(A.Fragment,{children:[e&&(0,A.jsx)(c.A,{settings:(0,m.iu)(e.key.slice(4)),setColorSetting:x}),w.map(((e,a)=>{let{x:r,y:n,id:s,isLeft:o,offsetX:c,offsetY:d,nodeID:u}=e;const{objective:h}=l.j.FLATTENED_DATA[u],p=l.j.FLATTENED_DATA[u].deliveries,[f,g]=l.j.MIN_MAXES[h],x=(0,m.Dy)(p,f,g);return(0,A.jsx)("div",{className:"panel compare-panel"+(o?" left":""),style:j({x:r,y:n,offsetX:c,offsetY:d}),onMouseDown:t=>E(t,{id:s}),children:(0,A.jsxs)("div",{className:"panel-main-container",children:[(0,A.jsx)(i.A,{width:420,height:280,data:p,range:[f,g],goal:t.goals[s],setGoal:e=>{t.setGoals((t=>(t[s]=e,{...t})))}}),(0,A.jsx)(y.A,{levelInterp:x,height:200,resolution:4})]})},a)}))]})}l=(x.then?(await x)():x)[0],r()}catch(_){r(_)}}))},5621:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>w});var n=a(1676),s=a(5043),o=a(4096),i=a(7919),c=a(9083),l=a(8058),d=a(2385),u=a(4956),h=a(972),p=a(9152),m=a(9550),f=a(9060),g=a(4987),y=a(6767),A=a(7187),x=a(579),_=t([l]);function w(){const t=(0,s.useContext)(o.B),e=(0,s.useRef)([]),a=(0,s.useRef)(null),[r,_]=(0,s.useState)(null),[v,w]=(0,s.useState)(n.zoomIdentity),{panels:b,panelsRef:E,setPanels:j,onPanelDragStart:R,getPanelStyle:I}=(0,g.J)(v),[T,D]=(0,s.useState)(null),S=(0,s.useRef)(null);function k(){const t=a.current.height*d.W.SPREAD_1_2/20;n.select("#examine-group .instruction-text").attr("x",a.current.x-a.current.height*d.W.SPREAD_1_2*.8).attr("y",a.current.y-t).attr("opacity",0).attr("text-anchor","end").attr("font-size",t).call((0,h.Y_)(["click to keep panels open.","you can drag panels."],1.6)).call((t=>{t.transition().attr("opacity",1)})).selectAll("tspan").each((function(e,a){n.select(this).attr("dx",a*t)}));const e=a.current.height*d.W.SPREAD_1_2/15;n.select("#examine-group .drop-label").attr("x",a.current.x).attr("y",a.current.y+a.current.height/2*d.W.SPREAD_1_2*.9).attr("opacity",0).attr("text-anchor","middle").attr("font-size",e).call((0,h.Y_)(a.current.display_name,1.2,30)).transition().attr("opacity",1),n.selectAll("#examine-group .highlight-circle, #examine-group .baseline-pointer").attr("opacity",0).transition().attr("opacity",1)}function C(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{x:s,y:o}=a.current,{x:i,y:c,id:l,key:h}=t.waterdrops.nodes[e];j((t=>{if(-1!==t.findIndex((t=>{let{id:e}=t;return l===e}))){if(!n)return t;(0,u.od)(t,(t=>t.id===l))}const a={text:h.slice(4),x:s+i*d.W.SPREAD_1_2,y:o+c*d.W.SPREAD_1_2,offsetX:20,offsetY:40,id:l,preview:r,panelKey:r?-1:e};return[...t,a]}))}function L(t){j((e=>((0,u.od)(e,(e=>{let{id:a}=e;return t===a})),[...e])))}function P(t){const a=n.select("#examine-group");e.current.includes(t.id)?((0,u.od)(e.current,t.id),a.select(".circlet#i".concat(t.id)).classed("active",!1),L(t.id),D(null)):(L(t.id),e.current.push(t.id),a.select(".circlet#i".concat(t.id)).classed("active",!0),C(t.id),D(t.id))}function O(t){e.current.includes(t.id)?(n.select(".examine-panel#p".concat(t.id)).style("z-index",100),D(t.id)):(S.current&&(clearTimeout(S.current),j((t=>((0,u.od)(t,(t=>{let{panelKey:e}=t;return-1===e})),[...t])))),C(t.id,!0))}function N(t){e.current.includes(t.id)||(S.current=setTimeout((()=>{L(t.id),S.current=null}),100)),D((e=>e===t.id?null:e)),n.select(".examine-panel#p".concat(t.id)).style("z-index",0)}if((0,s.useEffect)((function(){const e=n.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","examine-group");e.append("circle").attr("class","highlight-circle").attr("opacity",0),e.append("g").attr("class","baseline-pointer").call((function(t){t.append("path"),t.append("text").text("baseline")})).attr("opacity",0),e.append("text").attr("class","instruction-text large-green-text fancy-font"),e.append("text").attr("class","drop-label fancy-font"),t.addZoomHandler((function(t){w(t)}))}),[]),(0,s.useEffect)((function(){if((0,u.ad)(t.state,"ExamineView")){const{transitionDuration:r=0}=t.state,s=n.select("#examine-group");return a.current=t.waterdrops.groups.find((e=>e.key===t.activeWaterdrops[0])),f._.updateSmallDropSVG(s,a.current,r/2,{onClick:P,onHover:O,onUnhover:N}),setTimeout(k,1.2*r),t.setGoBack((()=>()=>{const e=t.resetCamera();t.setState({state:"WideView",transitionDuration:e})})),w(t.camera.curTransform),(0,h.YB)("#examine-group"),function(){(0,h.h7)(".small-drop, .circlet",s),(0,h.f2)("#examine-group"),n.selectAll("#examine-group .instruction-text, #examine-group .drop-label, #examine-group .highlight-circle, #examine-group .baseline-pointer").attr("opacity",0),j([]),e.current=[],a.current=null,t.setGoBack(null)}}}),[t.state]),(0,s.useEffect)((function(){const t=n.select("#examine-group");if(null===r)return(0,h.f2)(".color-drop",t),void(0,h.YB)(".small-drop",t);f._.updateColorDrops(t,a.current,(t=>l.j.KEY_SETTINGS_MAP[t][r]),["red","orange","blue","green","magenta"][r]),(0,h.YB)(".color-drop",t),(0,h.f2)(".small-drop",t)}),[r]),(0,u.ad)(t.state,"ExamineView"))return(0,x.jsxs)(x.Fragment,{children:[b.map((e=>{let{text:a,x:r,y:n,id:s,offsetX:o,offsetY:d,panelKey:u,preview:h}=e;const{objective:m,scenario:f}=l.j.FLATTENED_DATA[s],g=l.j.FLATTENED_DATA[s].deliveries,[A,v]=l.j.MIN_MAXES[m],w=(0,p.Dy)(g,A,v);return(0,x.jsxs)("div",{className:"panel examine-panel ".concat(h?"preview":""),id:"p".concat(s),style:I({x:r,y:n,offsetX:o,offsetY:d}),onMouseDown:t=>!h&&R(t,{id:s}),onMouseEnter:()=>!h&&O({id:s}),onMouseLeave:()=>!h&&N({id:s}),children:[(0,x.jsxs)("div",{className:"panel-tab",children:["scenario ",(0,x.jsx)("span",{children:a})]}),(0,x.jsxs)("div",{className:"panel-main-container",children:[(0,x.jsx)(i.A,{width:480,height:320,data:g,range:[A,v],goal:t.goals[t.activeWaterdrops[0]],setGoal:e=>{t.setGoals((a=>(a[t.activeWaterdrops[0]]=e,{...a})))}}),(0,x.jsx)(y.A,{levelInterp:w,height:200,resolution:4})]}),(0,x.jsx)(c.A,{settings:(0,p.iu)(a),setColorSetting:_})]},h?-1:s)})),T&&(0,x.jsx)(A.P,{connectLine:function(e){if(-1===E.current.findIndex((t=>{let{id:a}=t;return e===a})))return;const{x:a,y:r}=E.current.find((t=>t.id===e)),[s,o]=t.camera.worldToScreen(a,r),i=n.select(".examine-panel#p".concat(e)).node().getBoundingClientRect(),[c,l]=[i.left+i.width/2,i.top+i.height/2],d=c-s,u=l-o;let h,p;return Math.abs(d)>Math.abs(u)?(p=0,h=(d<0?1:-1)*(i.width/2-5)):(h=0,p=(u<0?1:-1)*(i.height/2-5)),(0,m.D5)([[s,o],[c+h,l+p]],8,0)}(T)})]})}l=(_.then?(await _)():_)[0],r()}catch(v){r(v)}}))},4654:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>j});var n=a(5043),s=a(3999),o=a(4096),i=a(4956),c=a(4757),l=a(972),d=a(3362),u=a(6332),h=a(5831),p=a(8272),m=a(9246),f=a(4636),g=a(5829),y=a(2288),A=a(1802),x=a(6531),_=a(6924),v=a(579),w=t([c,p,m,g,y,A,x]);[c,p,m,g,y,A,x]=w.then?(await w)():w;const E=(0,_.c)(x.j,A.G,"objective");function j(){const t=(0,n.useContext)(o.B),{hookAnimations:e,getSlidesInRange:a,storyVars:r}=(0,c.R)(E,t.camera);if((0,n.useLayoutEffect)((function(){if((0,i.ad)(t.state,"TutorialView"))return(0,l.f2)(".bucket-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-comparer-graphics-wrapper"),e(),function(){t.resetCamera(!1),(0,l.f2)(".tutorial-view")}}),[t.state]),(0,i.ad)(t.state,"TutorialView"))return(0,v.jsxs)("div",{className:"tutorial-view",children:[(0,v.jsx)(y.A,{appCtx:t}),(0,v.jsxs)("div",{className:"scrollama scrollama-create-buckets",children:[(0,v.jsx)(p.m,{appCtx:t,storyVars:r}),(0,v.jsx)(f.m,{children:a("barsExplain","comparingTheTwo").map(((t,e)=>(0,v.jsx)(s.p,{data:t,children:(0,v.jsx)(u.Y,{children:t.script})},e)))})]}),(0,v.jsxs)("div",{className:"scrollama scrollama-compare-scenobjs scenarios-section",children:[(0,v.jsx)(m.k,{storyVars:r,size:.4*t.appHeight}),(0,v.jsx)(h.D,{}),(0,v.jsx)(f.m,{children:a("forNowLetsFocus","letsBringRefuge").map(((t,e)=>(0,v.jsx)(s.p,{data:t,children:(0,v.jsx)(u.Y,{children:t.script})},e)))})]}),(0,v.jsx)(d.S,{onClick:()=>t.setState({state:"WideView"})})]})}r()}catch(b){r(b)}}))},6313:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>_});var n=a(1676),s=a(5043),o=a(7192),i=a.n(o),c=a(4096),l=a(3693),d=a(4082),u=a(2385),h=a(9550),p=a(4956),m=a(972),f=a(8330),g=a(3054),y=a(579),A=t([l,d,f]);function _(){const t=(0,s.useContext)(c.B),[e,a]=(0,s.useState)({zoom:1,mouseX:0,mouseY:0}),[r,o]=(0,s.useState)(null),[A,x]=(0,s.useState)(null),_=(0,s.useRef)(!1),v=(0,s.useRef)([]);(0,s.useEffect)((function(){!function(){(0,m.f2)("#infobox, #mosaic-webgl, #mosaic-svg");n.select("#mosaic-svg").select(".svg-trans").append("g").attr("id","wide-group").append("text").attr("class","instruction-text large-green-text fancy-font").attr("x",0-.6*t.waterdrops.height)}();const e=function(){const e=t=>{a((e=>({...e,zoom:t.k})))},r=t=>{a((e=>({...e,mouseX:t.x,mouseY:t.y})))};return t.addZoomHandler(e),window.addEventListener("mousemove",r),function(){window.removeEventListener("mousemove",r)}}();return f._.drawMinimapSVG(),e}),[]),(0,s.useEffect)((function(){if((0,p.ad)(t.state,"WideView")){const{transitionDuration:e=0}=t.state;return n.select("body").style("overflow","hidden"),_.current=!0,a((e=>({...e,zoom:t.camera.curTransform.k}))),console.time("drawing"),t.dropsMesh.draw(t.scene),console.timeEnd("drawing"),t.dropsMesh.updateVisibility(1),t.dropsMesh.updateOutlineVisibility(t.getOutlineOpacity(t.camera.curTransform.k)),function(){const e=n.select("#wide-group");f._.updateLargeDropSVG(e,t.waterdrops,{onClick:j,onHover:R,onUnhover:I});for(const t of v.current)e.select(".circlet#b".concat(t.key)).classed("active",!0);const a=40*t.camera.getZFromFarHeight(t.waterdrops.height)/t.camera.height;e.select(".instruction-text").attr("y",5*-a).attr("text-anchor","end").attr("font-size",a).call((0,m.Y_)(["click to interact.","scroll to zoom.","drag to pan."],2)).selectAll("tspan").each((function(t,e){n.select(this).attr("dx",e*a)}))}(),(0,m.YB)("#infobox, #mosaic-webgl, #mosaic-svg, #wide-group"),function(){(0,m.f2)("#infobox, #wide-group"),_.current=!1}}}),[t.state]),(0,s.useEffect)((function(){_.current&&n.select("#wide-group").selectAll(".cloud-text").each(f._.fontSizer(e,t.camera,t.waterdrops.height))}),[e]);const w=(0,s.useCallback)((function(){t.setDisableCamAdjustments(!0);const{x:e,y:a,height:r}=v.current[0],n=[e,a,t.camera.getZFromFarHeight(r*u.W.SPREAD_1_2*1.5)],[s,o]=t.zoomTo(n,(function(){t.setDisableCamAdjustments(!1)}));s(),t.setState({state:"ExamineView",transitionDuration:o});const i=t.getOutlineOpacity(t.camera.curTransform.k);f._.fadeOutDrops(t.dropsMesh,t.scene,i,o/2)}),[]),b=(0,s.useCallback)((function(){t.setDisableCamAdjustments(!0);const e=(0,h.p6)(v.current.map((t=>[t.x,t.y]))),a=[...e,t.camera.getZFromFarHeight(2*t.waterdrops.groups[0].height*u.W.SPREAD_1_2*.75*2)],[r,n]=t.zoomTo(a,(function(){t.setDisableCamAdjustments(!1)}));r(),t.setState({state:"CompareView",transitionDuration:n,viewCenter:e});const s=t.getOutlineOpacity(t.camera.curTransform.k);f._.fadeOutDrops(t.dropsMesh,t.scene,s,n/5)}),[]),E=(0,s.useCallback)((function(){t.setActiveWaterdrops([]),v.current=[],n.selectAll("#wide-group .circlet").classed("active",!1)}),[]);function j(e){const a=n.select("#wide-group");t.setActiveWaterdrops((t=>(t.includes(e.key)?(t=(0,p.od)(t,e.key),v.current=(0,p.od)(v.current,e),a.select(".circlet#b".concat(e.key)).classed("active",!1)):(t.push(e.key),v.current.push(e),a.select(".circlet#b".concat(e.key)).classed("active",!0)),[...t])))}function R(t){var e;o({id:t.key,description:(null===(e=l.G[t.key])||void 0===e?void 0:e.desc)||t.key}),n.select("#minimap").select(".outline."+t.key).attr("fill","gray")}function I(t){o(null),n.select("#minimap").select(".outline."+t.key).attr("fill","transparent")}const T=(0,s.useMemo)((()=>null===A?[]:i().go(A,t.waterdrops.groups,{keys:[t=>l.G[t.key].id,t=>l.G[t.key].display_name,t=>l.G[t.key].desc],limit:10,all:!0})),[A,t.waterdrops]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{id:"infobox",children:[(0,y.jsx)("svg",{id:"minimap"}),r&&(0,y.jsxs)("div",{className:"details",children:[!d.l.SPATIAL_FEATURES[r.id]&&(0,y.jsx)("p",{className:"no-loc-data",children:"No Location Data"}),(0,y.jsx)("p",{className:"curDesc",children:r.description}),(0,y.jsxs)("p",{className:"curKey",children:["id: ",(0,y.jsxs)("span",{children:[" ",r.id," "]})]})]}),!r&&(0,y.jsxs)("div",{className:"searchbox",children:[(0,y.jsx)("input",{type:"text",placeholder:"search",value:A||"",onChange:t=>x(t.target.value),onFocus:()=>{x(""),n.select(".results").style("display","flex")},onBlur:()=>{setTimeout((()=>{x(null),n.select(".results").style("display","none")}),100)}}),(0,y.jsx)("div",{className:"results",style:{display:"none"},children:T.map((t=>{let{obj:e}=t;return(0,y.jsx)("button",{onClick:()=>j(e),children:e.display_name},e.key)}))})]})]}),(0,y.jsx)("div",{className:"action-btn-wrapper",children:(0,y.jsx)(g.w,{appCtx:t,handleClickExamine:w,handleClickDeselectAll:E,handleClickCompare:b})})]})}[l,d,f]=A.then?(await A)():A,r()}catch(x){r(x)}}))}}]);
//# sourceMappingURL=805.1b6a4dd2.chunk.js.map