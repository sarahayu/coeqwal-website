"use strict";(self.webpackChunkcoeqwal_website=self.webpackChunkcoeqwal_website||[]).push([[805],{805:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.r(e),n.d(e,{default:()=>w});var r=n(894),s=n(43),o=n(96),i=n(956),c=n(251),l=n(313),d=n(621),h=n(293),u=n(68),f=n(579),p=t([c,l,d,h]);[c,l,d,h]=p.then?(await p)():p;const g=(0,c.c)("objective"),v=window.innerWidth,y=window.innerHeight;function w(){const[t,e,n]=(0,i.iJ)({}),[a,c,p]=(0,i.iJ)([]),[m,w]=(0,s.useState)([]),[x,b]=(0,s.useState)(null),[k,M,L]=(0,i.iJ)(!1),[j,A]=(0,s.useState)(200),Y=(0,s.useCallback)(r.m4Y().domain([y/g.height,y/g.groups[0].height]).range([.1,1]).clamp(!0),[]);(0,s.useEffect)((function(){document.querySelector("#mosaic-webgl").appendChild(u.Uk.domElement),r.Ltv("#mosaic-svg").attr("width",v).attr("height",y),u.UI.mount(r.Ltv(".bubbles-wrapper").node(),r.Ltv("#mosaic-svg").select(".svg-trans").node()),u.UI.setZoomFn((t=>{L.current||u.Q7.updateOutlineVisibility(Y(t.k));for(const e of p.current)e(t)})),u.UI.setSize(v,y),u.Uk.setAnimationLoop((()=>{u.Uk.render(u.JH,u.UI.camera)})),X(!1),e({state:"WideView"})}),[]);const X=(0,s.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;const n=[0,.08*-g.height,u.UI.getZFromFarHeight(g.height)];if(t){const{start:t}=S(n,e);t()}else u.UI.callZoomFromWorldViewport({worldX:n[0],worldY:-n[1],farHeight:g.height}),e&&e()}),[]),S=(0,s.useCallback)((function(t,e){const n=u.UI.interpolateZoomCamera(t),a=n.duration/2;return{start:()=>{const t=r.O1W((r=>{const s=Math.min(r/a,1);u.UI.callZoom(n(s)),1===s&&(t.stop(),e&&e())}))},duration:a}}),[]),T=(0,s.useCallback)((function(t){c((e=>[...e,t]))}),[]);return(0,f.jsxs)(o.B.Provider,{value:{appWidth:v,appHeight:y,state:t,setState:e,activeWaterdrops:m,setActiveWaterdrops:w,setDisableCamAdjustments:M,waterdrops:g,scene:u.JH,camera:u.UI,renderer:u.Uk,pointsMesh:u.XA,dropsMesh:u.Q7,setGoBack:b,zoomTo:S,resetCamera:X,getOutlineOpac:Y,addZoomHandler:T,goal:j,setGoal:A},children:[(0,f.jsxs)("div",{className:"bubbles-wrapper",children:[(0,f.jsx)("div",{id:"mosaic-webgl"}),(0,f.jsx)("svg",{id:"mosaic-svg",children:(0,f.jsx)("g",{className:"svg-trans"})})]}),(0,f.jsx)(l.A,{}),(0,f.jsx)(d.A,{}),(0,f.jsx)(h.A,{}),x&&(0,f.jsx)("button",{className:"go-back-btn",onClick:x,children:"\u2190"})]})}u.Uk.setSize(v,y),console.time("drops mesh creating"),u.Q7.createMesh(g),console.timeEnd("drops mesh creating"),a()}catch(m){a(m)}}))},96:(t,e,n)=>{n.d(e,{B:()=>a});const a=(0,n(43).createContext)({})},987:(t,e,n)=>{n.d(e,{u:()=>s});var a=n(894),r=n(684);function s(t,e,n,s,o){const i=t.length/n;let c=a.JWi().value((t=>t)).domain(e).thresholds((0,r.kd)(...e,Math.ceil(s/(o/i))))(t),l=(0,r.Q2)(c,n,i),d=[];for(let a=0;a<l.length;a++)for(let e=0;e<l[a];e++)d.push([(c[a].x1+c[a].x0)/2,(e+.5)/i*t.length]);return d}},684:(t,e,n)=>{n.d(e,{Q2:()=>s,YW:()=>o,kd:()=>r});var a=n(894);n(43);function r(t,e,n){return a.y17(n).map((a=>a/(n-1)*(e-t)+t))}function s(t,e,n){let r=t.map((t=>Math.round(t.length/e))),s=a.czq(r);for(;s>n;)r[a.z94(t,((t,n)=>0!==t.length?t.length/e-r[n]:1/0))]-=1,s=a.czq(r);for(;s<n;)r[a.P2Z(t,((t,n)=>0!==t.length?t.length/e-r[n]:-1/0))]+=1,s=a.czq(r);return r}const o=t=>a.dM(a.m4Y([.2,1])(t))},342:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{A:()=>m});var r=n(894),s=n(43),o=n(987),i=n(58),c=n(579),l=t([i]);i=(l.then?(await l)():l)[0];const h=20,u={top:10,right:10,bottom:20,left:10},f=[0,i.pk],p={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}};function m(t){let{data:e,goal:n,setGoal:a,width:i=600,height:l=400}=t;const{current:d}=(0,s.useRef)(Math.floor(1e9*Math.random())),{current:m}=(0,s.useRef)(Math.floor(1e9*Math.random())),g=(0,s.useRef)(),v=(0,s.useMemo)((()=>(0,o.u)(e,f,e.length/h,i,l)),[e]),y=[0,e.length],w=r.m4Y().domain(f).range([0,i]),x=r.m4Y().domain(y).range([l,0]),b=v.filter((t=>t[0]>n)).length;return(0,s.useEffect)((()=>{g.current.attr("width",i+u.left+u.right).attr("height",l+u.top+u.bottom).style("pointer-events","none").append("g").attr("class","graph-area").attr("transform","translate(".concat(u.left,",").concat(u.top,")")).append("g").attr("transform","translate(0, ".concat(l,")")).call(r.l78().scale(r.m4Y().domain(f).range([0,i])).tickFormat(r.GPZ(".2s"))).call((t=>{t.selectAll("line").attr("stroke","gray"),t.selectAll("path").attr("stroke","gray"),t.selectAll("text").attr("fill","gray")})).append("text").attr("fill","black").attr("transform","translate(".concat(i/2,", ",30,")")).text("Delivery (TAF)");const t=document.querySelector("#i".concat(d));t.style.transform="translateX(".concat(r.m4Y().domain(f).range([u.left,i+u.left]).clamp(!0)(n),"px)");const e=t=>t.preventDefault();let s=!1;document.querySelector("#i".concat(d)).addEventListener("mousedown",(()=>{s=!0,window.addEventListener("selectstart",e)})),document.addEventListener("mouseup",(()=>{s=!1,window.removeEventListener("selectstart",e)})),document.querySelector("#i".concat(m)).addEventListener("mousemove",(e=>{s&&e.target.id==="i".concat(m)&&(t.style.transform="translateX(".concat(Math.min(Math.max(e.offsetX,u.left),u.left+i),"px)\n            "),a(r.m4Y().domain([u.left,i+u.left]).range(f).clamp(!0)(e.offsetX)))}))}),[]),(0,s.useEffect)((()=>{const t=g.current.select(".graph-area").selectAll(".icons").data(v).join((t=>t.append("g").call((t=>t.append("path"))))).attr("class","icons").call((t=>{t.selectAll("path").attr("d",r.HRO(p,l/h))}));t.attr("transform",(t=>"translate(".concat(w(t[0]),",").concat(x(t[1]),")"))),t.attr("fill",(t=>t[0]>n?"steelblue":"black"));document.querySelector("#i".concat(d)).style.transform="translateX(".concat(r.m4Y().domain(f).range([u.left,i+u.left]).clamp(!0)(n),"px)")}),[n,v]),(0,c.jsxs)("div",{className:"dot-".concat(m),id:"i".concat(m),children:[(0,c.jsx)("div",{className:"pdf-razor",id:"i".concat(d),children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("span",{children:[v.length-b," / ",h," yrs WILL NOT meet demand"]}),(0,c.jsxs)("span",{children:[b," / ",h," yrs WILL meet demand"]})]})}),(0,c.jsx)("svg",{ref:t=>{g.current=r.Ltv(t)}})]})}a()}catch(d){a(d)}}))},693:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{R:()=>t});var r=n(956);const t=await async function(){const t=await(await fetch("./descriptions.json")).json();return console.log("DATA: loading descriptions data"),(0,r.Et)(t,(t=>{let{id:e}=t;return e}))}();a()}catch(s){a(s)}}),1)},58:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{ZS:()=>h,pk:()=>i,uV:()=>u,vR:()=>f,wP:()=>p});var r=n(894),s=n(550),o=n(956);const t=1,i=1200,c="scens",l="delivs",d=await async function(){const t=await(await fetch("./objectives.json")).json();for(const e of t){e[c]=e[c];for(const t of e[c]){const e=t[l].map((t=>(0,s.qE)(t,0,i)));t[l]=Array.from(e).sort(((t,e)=>e-t))}e[c]=(0,o.Et)(e[c],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,o.Et)(t,(t=>{let{obj:e}=t;return e}))}(),h=Object.keys(d),u=Object.keys(Object.values(d)[0][c]).filter(((e,n)=>n%t===0)),[f,p]=function(){const t=[],e={objective:{},scenario:{}},n=[];let a=0;for(const o of h)for(const s of u){e.objective[o]||(e.objective[o]=[]),e.scenario[s]||(e.scenario[s]=[]),e.objective[o].push(a),e.scenario[s].push(a);const i=d[o][c][s][l];t.push({id:a,objective:o,scenario:s,deliveries:i}),n.push(r.i2o(i)),a++}const s={};for(const o of Object.keys(e)){const a=[];for(const s of Object.keys(e[o])){const i=e[o][s],c=i.sort(((t,e)=>n[e]-n[t]));a.push({key:s,sorted:c,mean:r.i2o(i.map((e=>t[e].deliveries)).flat())})}const i=a.sort(((t,e)=>e.mean-t.mean));s[o]={};for(let t=0;t<i.length;t++){const{key:e,sorted:n}=i[t],a={};for(let t=0;t<n.length;t++)a[n[t]]=t;s[o][e]=a,s[o][e].rank=t}}return[t,s]}();a()}catch(i){a(i)}}),1)},82:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{KW:()=>t,X8:()=>s,Zy:()=>i,wU:()=>o});var r=n(956);const t=await async function(){const t=await(await fetch("./callite_spatial.json")).json();return console.log("DATA: loading callite spatial data"),t}(),s=(0,r.Et)(t.features,(t=>{let{properties:e}=t;return e.CalLiteID})),o=await async function(){const t=await(await fetch("./california.json")).json();return console.log("DATA: loading california spatial data"),t}(),i=[-119,37.7749];a()}catch(s){a(s)}}),1)},385:(t,e,n)=>{n.d(e,{Kn:()=>a,N3:()=>s,N7:()=>l,NU:()=>r,pC:()=>c,w5:()=>o,w9:()=>i});const a=5,r=1,s=.1,o=1.3,i=1.2,c=3,l=1.1/(1+Math.SQRT1_2)},68:(t,e,n)=>{n.d(e,{JH:()=>s,Q7:()=>o,UI:()=>c,Uk:()=>l,XA:()=>i});var a=n(408),r=(n(894),n(972));const s=function(){const t=new a.Z58;return t.background=new a.Q1f(15724527),t}(),o=new r.e8,i=new r._9,c=new r.i7({fov:45,near:1,far:3e3}),l=new a.JeP({antialias:!0})},251:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{c:()=>u});var r=n(684),s=n(385),o=n(58),i=n(152),c=n(550),l=n(956),d=t([o,i]);function u(t){const e="objective"===t?o.ZS:o.uV,n="objective"===t?o.uV:o.ZS,a=(e.length,n.length),d=Math.sqrt(a/Math.PI)*s.NU*2*s.w5*s.w9,h=s.NU*s.w5,u=(0,c.hh)(0,0,e.map(((t,e)=>({r:d,id:e})))),f=(0,l.Et)(u,(t=>{let{id:e}=t;return e})),p=(0,c.hh)(0,0,n.map(((t,e)=>({r:h,id:e})))),m=(0,l.Et)(p,(t=>{let{id:e}=t;return e})),g=[],v=[],y={};for(const c of o.vR){const{id:e,objective:n,scenario:a,deliveries:l}=c,d=(0,i.Dy)(l,o.pk),h=(0,r.kd)(0,1,s.Kn+1).map((t=>d(t))).map(((t,e)=>Math.max(t,0==e?s.N3:0)*s.NU)),u="objective"===t?n:a,p="objective"===t?a:n,v=o.wP[t][u].rank,w=o.wP[t][u][e],x={id:e,levs:h,maxLev:s.NU,domLev:(0,i.Dq)(h),tilt:50*Math.random()-25,dur:100*Math.random()+400,x:m[w].x,y:m[w].y,group:u,key:p,globalX:f[v].x+m[w].x,globalY:f[v].y+m[w].y};g.push(x),y[u]||(y[u]=[]),y[u].push(x)}for(const r of e)v.push({x:f[o.wP[t][r].rank].x,y:f[o.wP[t][r].rank].y,tilt:50*Math.random()-25,key:r,height:p.height,nodes:y[r]});return{nodes:g,groups:v,height:u.height}}[o,i]=d.then?(await d)():d,a()}catch(h){a(h)}}))},152:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{Dq:()=>d,Dy:()=>l});var r=n(894),s=n(684),o=n(58),i=t([o]);function l(t,e){return r.m4Y().domain((0,s.kd)(0,1,t.length)).range(t.map((t=>Math.min(1,t/e)))).clamp(!0)}function d(t){t=[1,...t,0];let e=0;for(let n=0;n<t.length-1;n++){e+=(t[n]-t[n+1])*(n-1)/(t.length+4)}return e}o=(i.then?(await i)():i)[0],a()}catch(c){a(c)}}))},550:(t,e,n)=>{n.d(e,{D5:()=>y,eh:()=>m,hh:()=>p,jF:()=>w,kt:()=>v,qE:()=>i,xg:()=>g});var a=n(894),r=n(783),s=n.n(r),o=n(972);function i(t,e,n){return Math.max(e,Math.min(n,t))}function c(t){const e=t/2,n=3*Math.PI/2/16,a=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let r=0;r<=16;r++)a.push({x:Math.cos(r*n-Math.PI/4)*e,y:Math.sin(r*n-Math.PI/4)*e});return a}const l=function(){const t=c(3),e=c(1),n=[];for(let a=0;a<t.length-2;a++)n.push([t[a],t[a+(a<2?1:2)],e[a+(a<2?1:2)],e[a]]);return n}();let d,h,u,f;function p(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&u&&n.length===f)return u;d&&n.length===h||(d=a.y17(4).map((()=>function(t,e){const n=s().Bounds.create(t),r=n.min.x,o=n.max.x,i=n.min.y,c=n.max.y,l=a.m4Y([r,o]),d=a.m4Y([i,c]),h=[];for(let a=0;a<e;a++)for(;;){const e=l(Math.random()),n=d(Math.random());if(s().Vertices.contains(t,{x:e,y:n})){h.push([e,n]);break}}return h}(c(1),h=n.length))));const i=function(t){const e=a.czq(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}(n.map((t=>{let{r:e}=t;return e}))),p=d[Math.floor(Math.random()*d.length)].map((t=>{let[e,n]=t;return[e*i,n*i]})),m=s().Engine,g=s().Bodies,v=s().Composite,y=m.create(),w=p.sort(((t,e)=>e[1]-t[1])),x=n.map(((t,e)=>{let{r:n,id:a}=t;const[r,s]=w[e];return g.circle(r,s,n,{restitution:0,id:a})})),b=l.map((t=>s().Body.create({position:s().Vertices.centre(t),vertices:t,isStatic:!0}))),k=s().Body.create({isStatic:!0});s().Body.setParts(k,b),s().Body.setCentre(k,{x:0,y:0}),s().Body.scale(k,i,i),v.add(y.world,[...x,k]);for(let a=0,s=60,o=.1;a<s*o;a++)m.update(y,1e3/s);const M=x.map((n=>{let{position:a,id:r}=n;return{id:r,x:a.x+t,y:a.y+e}}));return M.height=i/2/o.Sz*o.IC,!r||u&&M.length===f||(u=M,f=M.length),M}function m(t){return t*Math.PI/180}function g(t,e){let[n,a]=t,[r,s]=e;return Math.sqrt(function(t,e){let[n,a]=t,[r,s]=e;return(r-n)**2+(s-a)**2}([n,a],[r,s]))}function v(t){return[t.left+t.width/2,t.top+t.height/2]}function y(t,e){let[n,a]=t;const r=Math.sqrt((n[0]-a[0])**2+(n[1]-a[1])**2),s=[(a[0]-n[0])/r,(a[1]-n[1])/r];return n[0]+=s[0]*e,n[1]+=s[1]*e,a[0]-=s[0]*e,a[1]-=s[1]*e,[n,a]}function w(t){let{rad:e,height:n}=t;return void 0!==e?.08*function(t){return(1+Math.SQRT2)*t}(e):.08*n}},956:(t,e,n)=>{n.d(e,{Et:()=>r,LV:()=>c,Ul:()=>s,ad:()=>i,iJ:()=>o});var a=n(43);function r(t,e){const n=Object.groupBy(t,e);for(const a of Object.keys(n))n[a]=n[a][0];return n}function s(t,e){return e=function(t){return"string"===typeof t?e=>function(t,e,n){var a;const r=e.split(".");for(let s of r){if(!t)return n;t=t[s]}return null!==(a=t)&&void 0!==a?a:n}(e,t):t}(e),t.sort(((t,n)=>{const a=e(t),r=e(n);return a<r?-1:a>r?1:0}))}function o(t){const[e,n]=(0,a.useState)(t),r=(0,a.useRef)(t);(0,a.useEffect)((()=>{r.current=e}),[e]);const s=(0,a.useCallback)((t=>{n("function"===typeof t?e=>r.current=t(e):r.current=t)}),[]);return[e,s,r]}function i(t,e){return t&&t.state===e}function c(t){return t.replace(/(?![^\n]{1,15}$)([^\n]{1,15})\s/g,"$1\n")}},972:(t,e,n)=>{n.d(e,{IC:()=>f,JB:()=>M,Sz:()=>d,_9:()=>b,e8:()=>x,i7:()=>k,js:()=>l});var a=n(894),r=n(408),s=n(684),o=n(385),i=n(956),c=n(550);const l="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z",d=Math.SQRT1_2,h=1,u=d+d,f=h+d,p=.75;function m(t){if(t>=p){return Math.SQRT1_2*(1-t)/(1-p)}const e=2*(1-t/(u/f))-1,n=Math.acos(e);return Math.sin(n)}function g(t){return(t-d/f)*(1+Math.SQRT2)}function v(t){return t/(1+Math.SQRT2)+d/f}function y(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const a=n/2/h*d,r=.1,s=[];let o,i,c,l;for(let d=1;d<=Math.ceil(10)&&(o=m(t+(d-1)*r),i=g(t+(d-1)*r),c=m(t+d*r),l=g(t+d*r),!(v(l)>=e));d++){const t=[-o*a,-i*a],e=[o*a,-i*a],n=[c*a,-l*a],r=[-c*a,-l*a];s.push([t,e,n]),s.push([t,n,r])}c=m(e),l=g(e);const u=[-o*a,-i*a],f=[o*a,-i*a],p=[c*a,-l*a],y=[-c*a,-l*a];return s.push([u,f,p]),s.push([u,p,y]),s}class w{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.threeGeom=new r.LoY,this.triangleIdx=0,this.threeGeom.setAttribute("position",new r.THS(new Float32Array(3*t),3)),e&&this.threeGeom.setAttribute("color",new r.THS(new Float32Array(3*t),3)),this.positionAttribute=this.threeGeom.getAttribute("position"),this.colorAttribute=this.threeGeom.getAttribute("color")}addMeshCoords(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(let r=0;r<t.length;r++){const[s,o,i]=t[r];this.positionAttribute.setXYZ(3*this.triangleIdx+0,e.x+s[0],e.y-s[1],a),this.positionAttribute.setXYZ(3*this.triangleIdx+1,e.x+o[0],e.y-o[1],a),this.positionAttribute.setXYZ(3*this.triangleIdx+2,e.x+i[0],e.y-i[1],a),n&&(this.colorAttribute.setXYZ(3*this.triangleIdx+0,n.r,n.g,n.b),this.colorAttribute.setXYZ(3*this.triangleIdx+1,n.r,n.g,n.b),this.colorAttribute.setXYZ(3*this.triangleIdx+2,n.r,n.g,n.b)),this.triangleIdx++}}finish(){this.threeGeom.setDrawRange(0,3*this.triangleIdx)}}class x{constructor(){this.added=!1}createMesh(t){this.dropsMesh?this.updateMeshes(t):this.initializeMeshes(t)}draw(t){this.added||(t.add(this.dropsMesh),t.add(this.outlineMesh),this.added=!0)}remove(t){this.added&&(t.remove(this.dropsMesh),t.remove(this.outlineMesh),this.added=!1)}initializeMeshes(t){const e=new w(x.MAX_POINTS_DROPS),n=[],a=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const a=n/2/h*d,r=.1,s=[],o=[];let i,c,l,u;for(let d=1;d<=Math.ceil(10)&&(i=m(t+(d-1)*r),c=g(t+(d-1)*r),l=m(t+d*r),u=g(t+d*r),!(v(u)>=e));d++){const t=[-i*a,-c*a],e=[i*a,-c*a],n=[l*a,-u*a],r=[-l*a,-u*a];s.push(e,n),o.push(t,r)}l=m(e),u=g(e);const f=[-i*a,-c*a],p=[i*a,-c*a],y=[l*a,-u*a],w=[-l*a,-u*a];return s.push(p,y),o.push(f,w),s.push(...o.reverse()),s}(0,1,2*o.NU*.975);for(let i=0;i<t.nodes.length;i++){const{id:c,globalX:l,globalY:d,levs:h,maxLev:u}=t.nodes[i];for(let t=h.length-1;t>=0;t--){const n=y((t!==h.length-1?h[t+1]:0)/u,h[t]/u,2*o.NU),a=new r.Q1f((0,s.YW)(t/o.Kn));e.addMeshCoords(n,{x:l,y:-d},a,i%5/50+.02)}n.push(...a.map((t=>{let[e,n]=t;return new r.Pq0(l+e,-d-n,i%5/50+.01)})))}e.finish(),this.dropsMesh=new r.eaF(e.threeGeom,new r.V9B({vertexColors:!0,transparent:!0,opacity:1})),this.outlineMesh=new r.DXC((new r.LoY).setFromPoints(n),new r.mrM({color:13421772,transparent:!0,opacity:0}))}updateOutlineVisibility(t){this.outlineMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0)}updateVisibility(t){this.outlineMesh&&this.dropsMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0,this.dropsMesh.material.opacity=t,this.dropsMesh.material.needsUpdate=!0)}updateMeshes(t){}}x.MAX_POINTS_DROPS=78e5,x.MAX_POINTS_OUTLINE=52e5;class b{constructor(){this.added=!1,this.vertToId={},this.idToVert={}}draw(t){this.added||(t.add(this.mesh),this.added=!0)}remove(t){this.added&&(t.remove(this.mesh),this.added=!1)}createMesh(t){return this.mesh||this.initializeMesh(t),this.updateMesh(t),this.mesh}initializeMesh(t){const e=new r.LoY,n=[],a=[];for(let o=0;o<t.nodes.length;o++){const{id:e,globalX:i,globalY:c,levs:l,domLev:d}=t.nodes[o],h=d>0?(0,s.YW)(d):"white";n.push(i,-c,0);const u=new r.Q1f(h);a.push(u.r,u.g,u.b),this.vertToId[o]=e,this.idToVert[e]=o}const i=new r.BH$({size:2*o.NU,sizeAttenuation:!0,vertexColors:!0,map:(new r.Tap).load("drop.png"),transparent:!0});e.setAttribute("position",new r.THS(new Float32Array(n),3)),e.setAttribute("color",new r.THS(new Float32Array(a),3)),this.mesh=new r.ONl(e,i)}updateMesh(t){const e=this.mesh.geometry.getAttribute("position");for(let n=0;n<t.nodes.length;n++){const{id:a,globalX:r,globalY:s}=t.nodes[n],o=this.idToVert[a];e.setXY(o,r,-s)}e.needsUpdate=!0}updatePoints(t,e,n){const a=this.mesh.geometry.vertices;for(let r=0;r<t.nodes.length;r++){const{id:s}=t.nodes[r],o=this.idToVert[s],[i,c]=e[s],l=a[o].x,d=a[o].y;a[o].setX(l+n*i),a[o].setY(d-n*c)}this.mesh.geometry.verticesNeedUpdate=!0}intersectObject(t,e,n){const a=t.intersectObject(e,n,this.mesh);if(a[0]){const t=(0,i.Ul)(a,"distanceToRay")[0];return this.vertToId[t.index]}return null}}class k{constructor(t){let{fov:e,near:n,far:a}=t;this.raycaster=new r.tBo,this.fov=e,this.near=n,this.far=a}setZoomFn(t){this.zoom=a.s_O().on("zoom",(e=>{this.curTransform=e.transform,this._THREEZoomHandler(e.transform),a.Ltv(this._svgElement).attr("transform",e.transform),t&&t(e.transform)}))}callZoom(t){this.zoom.transform(this.view,a.GSI.translate(t.x,t.y).scale(t.k))}callZoomFromWorldViewport(t){let{worldX:e,worldY:n,farHeight:a}=t;const r=this.height/a,s=-e*r+this.width/2,o=n*r+this.height/2;this.callZoom({x:s,y:o,k:r})}getZFromFarHeight(t){return Math.tan((0,c.eh)(90-this.fov/2))*t/2}getFarHeightFromZ(t){return Math.tan((0,c.eh)(this.fov)/2)*t*2}interpolateZoomCamera(t){let[e,n,r]=t;const s=a.p7([this.camera.position.x,this.camera.position.y,this.height/this.curTransform.k],[e,-n,this.getFarHeightFromZ(r)]),o=t=>{const[e,n,a]=s(t),r=this.height/a;return{x:-e*r+this.width/2,y:n*r+this.height/2,k:r}};return o.duration=s.duration,o}mount(t,e){this.view=a.Ltv(t),this._svgElement=e}setSize(t,e){this.width=t,this.height=e,this.zoom=this.zoom.scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]),this.camera=new r.ubm(this.fov,t/e,this.near,this.far+1),this.camera.position.set(0,0,this.far),this.view.call(this.zoom),this.zoom.transform(this.view,a.GSI.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}_THREEZoomHandler(t){const e=t.k,n=-(t.x-this.width/2)/e,a=(t.y-this.height/2)/e,r=this.getZFromScale(e);this.camera.position.set(n,a,r)}getScaleFromZ(t){const e=this.fov/2,n=(0,c.eh)(e),a=2*(Math.tan(n)*t);return this.height/a}getZFromScale(t){const e=this.fov/2,n=(0,c.eh)(e);return this.height/t/(2*Math.tan(n))}intersectObject(t,e,n){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(n)}}function M(t){t.attr("fill","transparent").attr("stroke","orange").attr("stroke-dasharray",3).attr("stroke-width",3).attr("vector-effect","non-scaling-stroke")}},293:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{A:()=>y});var r=n(96),s=n(684),o=n(342),i=n(894),c=n(58),l=n(43),d=n(385),h=n(550),u=n(956),f=n(972),p=n(579),m=t([o,c]);[o,c]=m.then?(await m)():m;const v=d.pC/d.w5;function y(){const{state:t,setState:e,setGoBack:n,resetCamera:a,activeWaterdrops:s,waterdrops:h,camera:m,goal:g,setGoal:v,addZoomHandler:y}=(0,l.useContext)(r.B),[k,M]=(0,l.useState)(),L=(0,l.useRef)(),[j,A]=(0,l.useState)([]),Y=(0,l.useRef)(),[X,S]=(0,l.useState)(!1),T=(0,l.useRef)({});return(0,l.useEffect)((function(){i.Ltv("#mosaic-svg").select(".svg-trans").append("g").attr("id","compare-group"),y((function(){S((t=>!t))})),window.addEventListener("mousemove",(t=>{void 0!==T.current.startX&&(T.current.deltaX=t.x-T.current.startX,T.current.deltaY=t.y-T.current.startY,A((t=>{if(void 0===T.current.startX)return t;const e=t.find((t=>t.id===T.current.id));return e.offsetX=e.oldOffsetX+T.current.deltaX,e.offsetY=e.oldOffsetY+T.current.deltaY,[...t]})))})),window.addEventListener("mouseup",(t=>{void 0!==T.current.startX&&(T.current={})}))}),[]),(0,l.useEffect)((function(){if(k){const[t,e,n]=b(L.current,k);A((t=>n.map(((e,n)=>{let a=0,r=0;t[n]&&(a=t[n].offsetX,r=t[n].offsetY);const s=function(t,e){let[n,a]=t,[r,s]=e,o=n,i=a;const c=L.current.groups[0].height;return o<r?o-=c:o+=c,[o,i,o<r]}(L.current.groupPositions[n],Y.current);return{text:e.key,x:s[0],y:s[1],id:e.id,isLeft:s[2],offsetX:a,offsetY:r}})))),i.Ltv("#compare-group").selectAll(".circlet").data(t).join("circle").attr("class","circlet").call(f.JB).attr("display","initial").attr("r",1.5*d.NU).transition().duration(100).attr("cx",(t=>t[0])).attr("cy",(t=>t[1])),i.Ltv("#compare-group").selectAll(".comp-line").data(e).join("path").attr("class","comp-line").attr("stroke","orange").attr("stroke-dasharray",3).attr("opacity",.5).attr("stroke-width",1).attr("vector-effect","non-scaling-stroke").transition().duration(100).attr("d",(t=>i.n8j()(t)))}}),[k]),(0,l.useEffect)((function(){if((0,u.ad)(t,"CompareView")){const r=i.Ltv("#compare-group");return x(r,L.current=w(s,h,Y.current=t.avgCoord),t.transitionDuration/5,{onHover:t=>{M(t.key)}}),setTimeout((()=>{M(L.current.groups[0].nodes[0].key)}),t.transitionDuration+500),n((()=>()=>{e({state:"WideView"}),a()})),function(){r.selectAll(".large-drop").remove(),r.selectAll(".circlet").remove(),r.selectAll(".comp-line").remove(),A([]),n(null)}}}),[t]),(0,p.jsx)(p.Fragment,{children:j.map(((t,e)=>{let{x:n,y:a,id:r,isLeft:s,offsetX:i,offsetY:l}=t;return(0,p.jsx)("div",{className:"panel compare-panel"+(s?" left":""),style:{left:"".concat(n*m.curTransform.k+m.curTransform.x+i,"px"),top:"".concat(a*m.curTransform.k+m.curTransform.y+l,"px")},onMouseDown:t=>function(t,e){""!==t.target.className&&(T.current={startX:t.clientX,startY:t.clientY,id:e},A((t=>{const n=t.find((t=>t.id===e));return n.oldOffsetX=n.offsetX,n.oldOffsetY=n.offsetY,[...t]})))}(t,r),children:(0,p.jsx)(o.A,{width:300,height:200,data:c.vR[r].deliveries,goal:g,setGoal:v})},e)}))})}function w(t,e,n){const a=e.groups.filter((e=>t.includes(e.key))),r=[],s=a[0].height*v*.75;for(let o=0,i=a.length;o<i;o++)r.push([n[0]+Math.cos(2*Math.PI/i*o)*s,n[1]+Math.sin(2*Math.PI/i*o)*s]);return{groups:a,groupPositions:r}}function x(t,e,n,a){let{onClick:r,onHover:o,onUnhover:c}=a;t.selectAll(".large-drop").data(e.groups).join((t=>t.append("g").attr("class","large-drop").each((function(t){let{nodes:e}=t;i.Ltv(this).selectAll(".small-drop").data(e).enter().append("g").attr("class","small-drop").each((function(t){let{levs:e}=t;const n=i.Ltv(this);n.append("rect").attr("class","bbox").style("visibility","hidden");const a=Math.floor(1e9*Math.random()),r=i.Ltv(this).append("defs").append("linearGradient").attr("id","".concat(a)).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");r.append("stop").attr("stop-color","transparent"),r.append("stop").attr("stop-color","transparent"),e.forEach(((t,e)=>{r.append("stop").attr("stop-color",(0,s.YW)(e/d.Kn)),r.append("stop").attr("stop-color",(0,s.YW)(e/d.Kn))})),n.append("path").attr("d",f.js).attr("class","outline").attr("fill","none").attr("stroke","lightgray").attr("stroke-width",.05),n.append("path").attr("class","fill").attr("d",f.js).attr("fill","url(#".concat(a,")"))}))})))).attr("display","initial").attr("transform",((t,e)=>{let{x:n,y:a}=t;return"translate(".concat(n,", ").concat(a,")")})).each((function(t){let{nodes:e}=t;i.Ltv(this).selectAll(".small-drop").data(e).attr("display","initial").attr("transform",(t=>{let{x:e,y:n}=t;return"translate(".concat(e,", ").concat(n,")")})).on("click",(function(t,e){r&&r(e)})).on("mouseenter",(function(t,e){o&&o(e)})).on("mouseleave",(function(t,e){c&&c(e)})).each((function(t,e){let{levs:n,maxLev:a}=t;const r=i.Ltv(this);r.select(".outline").attr("transform","scale(".concat(.95*d.NU,")")),r.select(".fill").attr("transform","scale(".concat(d.NU,")")),r.selectAll("stop").each((function(t,e){let r=Math.floor(e/2);0===e%2&&(r-=1),-1===r?i.Ltv(this).attr("offset","".concat(0,"%")):r===n.length?i.Ltv(this).attr("offset","100%"):i.Ltv(this).attr("offset","".concat(100*(1-n[r]/a),"%"))}));const s=r.select(".fill");r.select(".bbox").attr("x",s.node().getBBox().x).attr("y",s.node().getBBox().y).attr("width",s.node().getBBox().width).attr("height",s.node().getBBox().height)})).transition().delay(n).duration(1e3).attr("transform",(t=>{let{x:e,y:n}=t;return"translate(".concat(e*v,", ").concat(n*v,")")}))})).transition().delay(n).duration(1e3).attr("transform",((t,n)=>"translate(".concat(e.groupPositions[n][0],", ").concat(e.groupPositions[n][1],")")))}function b(t,e){const n=[],a=[];for(let s=0;s<t.groups.length;s++){const r=t.groups[s],o=t.groupPositions[s],i=r.nodes.find((t=>t.key===e));a.push(i),n.push([i.x*v+o[0],i.y*v+o[1]-(0,h.jF)({rad:d.NU})])}const r=[];for(let s=0;s<n.length;s++){const t=Array.from(n[s]),e=Array.from(n[s+1==n.length?0:s+1]);(0,h.D5)([t,e],2*d.NU),r.push([t,e])}return[n,r,a]}a()}catch(g){a(g)}}))},621:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{A:()=>y});var r=n(894),s=n(43),o=n(96),i=n(684),c=n(385),l=n(956),d=n(972),h=n(58),u=n(342),f=n(550),p=n(579),m=t([h,u]);[h,u]=m.then?(await m)():m;const v=c.pC/c.w5;function y(){const{state:t,setState:e,setGoBack:n,resetCamera:a,activeWaterdrops:i,waterdrops:c,camera:d,addZoomHandler:f,goal:m,setGoal:g}=(0,s.useContext)(o.B),[y,x,b]=(0,l.iJ)([]),[k,M,L]=(0,l.iJ)(null),[j,A]=(0,s.useState)([]),[Y,X]=(0,s.useState)(!1),S=(0,s.useRef)({});function T(t){const{globalX:e,globalY:n,x:a,y:r,id:s,key:o}=c.nodes[t];A((t=>[...t,{text:o,x:e+a*(v-1),y:n+r*(v-1),offsetX:20,offsetY:40,id:s}]))}function C(t){const{id:e}=c.nodes[t];A((t=>(t.splice(t.findIndex((t=>t.id===e)),1),[...t])))}return(0,s.useEffect)((function(){r.Ltv("#mosaic-svg").select(".svg-trans").append("g").attr("id","examine-group"),f((function(){X((t=>!t))})),window.addEventListener("mousemove",(t=>{void 0!==S.current.startX&&(S.current.deltaX=t.x-S.current.startX,S.current.deltaY=t.y-S.current.startY,A((t=>{if(void 0===S.current.startX)return t;const e=t.find((t=>t.id===S.current.id));return e.offsetX=e.oldOffsetX+S.current.deltaX,e.offsetY=e.oldOffsetY+S.current.deltaY,[...t]})))})),window.addEventListener("mouseup",(t=>{void 0!==S.current.startX&&(S.current={})}))}),[]),(0,s.useEffect)((function(){if((0,l.ad)(t,"ExamineView")){const s=t.transitionDuration,o=r.Ltv("#examine-group");return w(o,c.groups.find((t=>t.key===i[0])).nodes,s/2,{onClick:t=>{x((e=>(e.includes(t.id)?(e.splice(e.indexOf(t.id),1),o.select(".circlet.i"+t.id).classed("active",!1),C(t.id)):(e.push(t.id),o.select(".circlet.i"+t.id).classed("active",!0),T(t.id)),[...e])))},onHover:t=>{b.current.includes(t.id)||(M(t.id),T(t.id))},onUnhover:t=>{L.current===t.id&&(M(null),C(t.id))}}),n((()=>()=>{e({state:"WideView"}),a()})),function(){o.selectAll(".small-drop").attr("display","none"),o.selectAll(".circlet").classed("active",!1).select("circle").attr("display","none"),A([]),x([]),M(null),n(null)}}}),[t]),(0,p.jsx)(p.Fragment,{children:j.map((t=>{let{x:e,y:n,id:a,offsetX:r,offsetY:s}=t;return(0,p.jsx)("div",{className:"panel",style:{left:"".concat(e*d.curTransform.k+d.curTransform.x+r,"px"),top:"".concat(n*d.curTransform.k+d.curTransform.y+s,"px")},onMouseDown:t=>function(t,e){""!==t.target.className&&(S.current={startX:t.clientX,startY:t.clientY,id:e},A((t=>{const n=t.find((t=>t.id===e));return n.oldOffsetX=n.offsetX,n.oldOffsetY=n.offsetY,[...t]})))}(t,a),children:(0,p.jsx)(u.A,{width:300,height:200,data:h.vR[a].deliveries,goal:m,setGoal:g})},a)}))})}function w(t,e,n,a){let{onClick:s,onHover:o,onUnhover:l}=a;t.selectAll(".small-drop").data(e).join((t=>t.append("g").attr("class","small-drop").each((function(t,e){let{levs:n}=t;const a=r.Ltv(this);a.append("rect").attr("class","bbox").style("visibility","hidden");const s=r.Ltv(this).append("defs").append("linearGradient").attr("id","drop-fill-".concat(e)).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");s.append("stop").attr("stop-color","transparent"),s.append("stop").attr("stop-color","transparent"),n.forEach(((t,e)=>{s.append("stop").attr("stop-color",(0,i.YW)(e/c.Kn)),s.append("stop").attr("stop-color",(0,i.YW)(e/c.Kn))})),a.append("path").attr("d",d.js).attr("class","outline").attr("fill","none").attr("stroke","lightgray").attr("stroke-width",.05),a.append("path").attr("class","fill").attr("d",d.js).attr("fill","url(#drop-fill-".concat(e,")")),a.append("g").attr("class","circlet").append("circle").call(d.JB).attr("display","none").attr("cy",-(0,f.jF)({rad:1})).attr("r",1.5)})))).attr("display","initial").attr("transform",(t=>{let{globalX:e,globalY:n}=t;return"translate(".concat(e,", ").concat(n,")")})).each((function(t,e){let{levs:n,maxLev:a,key:s,id:o}=t;const i=r.Ltv(this);i.select(".outline").attr("transform","scale(".concat(.95*c.NU,")")),i.select(".fill").attr("transform","scale(".concat(c.NU,")")),i.select(".circlet").attr("class",null).attr("class","circlet i"+o),i.selectAll("stop").each((function(t,e){let s=Math.floor(e/2);0===e%2&&(s-=1),-1===s?r.Ltv(this).attr("offset","".concat(0,"%")):s===n.length?r.Ltv(this).attr("offset","100%"):r.Ltv(this).attr("offset","".concat(100*(1-n[s]/a),"%"))}));const l=i.select(".fill");i.select(".bbox").attr("x",l.node().getBBox().x).attr("y",l.node().getBBox().y).attr("width",l.node().getBBox().width).attr("height",l.node().getBBox().height)})).on("click",(function(t,e){s&&s(e)})).on("mouseenter",(function(t,e){r.Ltv(this).select(".circlet").classed("active")||r.Ltv(this).select("circle").attr("display","initial"),o&&o(e)})).on("mouseleave",(function(t,e){r.Ltv(this).select(".circlet").classed("active")||r.Ltv(this).select("circle").attr("display","none"),l&&l(e)})).transition().delay(n).duration(1e3).attr("transform",(t=>{let{globalX:e,globalY:n,x:a,y:r}=t;return"translate(".concat(e+a*(v-1),", ").concat(n+r*(v-1),") rotate(",0,")")}))}a()}catch(g){a(g)}}))},313:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{A:()=>y});var r=n(894),s=n(43),o=n(96),i=n(385),c=n(68),l=n(956),d=n(128),h=n(693),u=n(550),f=n(82),p=n(972),m=n(579),g=t([h,f]);function y(){const{waterdrops:t,state:e,setState:n,camera:a,zoomTo:p,setActiveWaterdrops:g,activeWaterdrops:v,setDisableCamAdjustments:y,getOutlineOpac:x,addZoomHandler:b,appWidth:k,appHeight:M}=(0,s.useContext)(o.B),[L,j]=(0,s.useState)([]),[A,Y,X]=(0,l.iJ)(!1),[S,T]=(0,s.useState)({zoom:1,mouseX:0,mouseY:0}),[C,E]=(0,s.useState)(null);(0,s.useEffect)((function(){r.Ltv(".infobox").attr("display","none"),X.current&&r.Ltv("#wide-group").selectAll("text").each((function(){const e=r.Ltv(this),n=e.node(),[s,o]=(0,u.kt)(n.getBoundingClientRect()),i=n.getBBox().width*a.height/a.far*8,c=n.getBBox().height*a.height/a.far*10,l=(0,u.xg)([s,o],[S.mouseX,S.mouseY]);e.attr("font-size",((e,n)=>{const s=window.innerHeight/9,o=1/n*a.height/t.height;return((i=e*o)>s?0:r.m4Y().domain([0,s]).range([1,.4]).clamp(!0)(i))*Math.min(o,.4);var i})(l,S.zoom)),r.Ltv(this.parentNode.parentNode).select("image").attr("x",-i/2).attr("y",-c/2).attr("width",i).attr("height",c)}))}),[S]),(0,s.useEffect)((function(){r.Ltv("#mosaic-svg").select(".svg-trans").append("g").attr("id","wide-group"),b((function(t){T((e=>({...e,zoom:t.k})))}));const t=t=>{T((e=>({...e,mouseX:t.x,mouseY:t.y})))};window.addEventListener("mousemove",t);const e=r.Ltv("#minimap").attr("width",200).attr("height",250),n=r.bAh().scale(1e3).center(f.Zy).translate([100,125]),a=[...f.KW.features.filter(((t,e)=>"MultiPolygon"===t.geometry.type)),f.wU],s=f.KW.features.filter(((t,e)=>"MultiPoint"===t.geometry.type));return e.selectAll("path").data(a).join("path").attr("d",(t=>r.zFW().projection(n)(t))).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("stroke",(t=>t.properties.CalLiteID?"transparent":"lightgray")).attr("stroke-width",1).attr("fill","transparent"),e.selectAll("circle").data(s).join("circle").each((function(t){const e=r.Ltv(this),[a,s]=n(t.geometry.coordinates[0]);e.attr("cx",a),e.attr("cy",s)})).attr("r",2).attr("class",(t=>"outline "+t.properties.CalLiteID)).attr("fill","transparent"),function(){window.removeEventListener("mousemove",t)}}),[]),(0,s.useEffect)((function(){if((0,l.ad)(e,"WideView")){Y(!0),T((t=>({...t,zoom:a.curTransform.k}))),console.time("drawing"),c.Q7.draw(c.JH),console.timeEnd("drawing");const e=x(a.curTransform.k);c.Q7.updateVisibility(1),c.Q7.updateOutlineVisibility(e);const n=r.Ltv("#wide-group");r.Ltv(".infobox").style("display","initial"),w(n,t,{onClick:t=>{j((e=>{const n=e.findIndex((e=>e.key===t.key));return-1!==n?e.splice(n,1):e.push(t),[...e]})),g((e=>(e.includes(t.key)?(e.splice(e.indexOf(t.key),1),n.select(".circlet."+t.key).classed("active",!1)):(e.push(t.key),n.select(".circlet."+t.key).classed("active",!0)),[...e])))},onHover:t=>{E({id:t.key,description:h.R[t.key].desc}),f.X8[t.key]&&r.Ltv("#minimap").select(".outline."+t.key).attr("fill","gray")},onUnhover:t=>{E(null),f.X8[t.key]&&r.Ltv("#minimap").select(".outline."+t.key).attr("fill","transparent")}});for(const t of L)n.select(".circlet."+t.key).classed("active",!0);return function(){r.Ltv("#wide-group").selectAll(".large-drop").attr("display","none"),r.Ltv(".infobox").style("display","none"),Y(!1)}}}),[e]);const I=(0,s.useCallback)((function(){if(1===L.length){const t=L[0],{start:e,duration:s}=p([t.x,t.y-.08*t.height,a.getZFromFarHeight(t.height*i.pC/i.w5*1.5)],(()=>{y(!1)}));e(),n({state:"ExamineView",transitionDuration:s});const o=x(a.curTransform.k);y(!0);const l=r.O1W((t=>{const e=Math.min(1,t/(s/2));c.Q7.updateVisibility(1-e),c.Q7.updateOutlineVisibility(o*(1-e)),e>=1&&(l.stop(),c.Q7.remove(c.JH))}))}else if(L.length>1){const e=L.map((t=>[t.x,t.y])),s=r.i2o(e,(t=>t[0])),o=r.i2o(e,(t=>t[1])),{start:l,duration:d}=p([s,o,a.getZFromFarHeight(2*t.groups[0].height*i.pC/i.w5*.75*2)],(()=>{y(!1)}));l(),n({state:"CompareView",transitionDuration:d,avgCoord:[s,o]});const h=x(a.curTransform.k);y(!0);const u=r.O1W((t=>{const e=Math.min(1,t/(d/5));c.Q7.updateVisibility(1-e),c.Q7.updateOutlineVisibility(h*(1-e)),e>=1&&(u.stop(),c.Q7.remove(c.JH))}))}}),[L]);let U;return(0,l.ad)(e,"WideView")&&v.length&&(U=(0,m.jsxs)("button",{onClick:I,className:"wide-view-action-btn fancy-font",children:[1===v.length?(0,m.jsx)(d.WEK,{}):(0,m.jsx)(d.IS1,{}),1===v.length?"examine":"compare"]})),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"infobox",children:[(0,m.jsx)("svg",{id:"minimap"}),C&&(0,m.jsxs)("div",{className:"details",children:[!f.X8[C.id]&&(0,m.jsx)("p",{className:"no-loc-data",children:"No Location Data"}),(0,m.jsx)("p",{className:"curDesc",children:C.description}),(0,m.jsxs)("p",{className:"curKey",children:["id: ",(0,m.jsxs)("span",{children:[" ",C.id," "]})]})]})]}),U]})}function w(t,e,n){let{onClick:a,onHover:s,onUnhover:o}=n;console.log("updating svg"),t.selectAll(".large-drop").data(e.groups).join((t=>t.append("g").attr("class","large-drop").each((function(t){const e=r.Ltv(this);e.append("g").attr("class","circlet").append("circle").call(p.JB).attr("display","none").attr("r",1);const n=e.append("g");n.append("g").append("image").attr("href","glow.png").attr("preserveAspectRatio","none").attr("opacity",.8),n.append("g").append("text").attr("class","fancy-font").attr("text-anchor","middle").attr("font-size",0)})))).each((function(t){r.Ltv(this).select(".circlet").attr("class",null).attr("class","circlet "+t.key),r.Ltv(this).select("text").call((e=>{e.selectAll("*").remove();const n=(0,l.LV)(h.R[t.key].display_name||h.R[t.key].id).split("\n");n.forEach(((t,a)=>{e.append("tspan").attr("x",0).attr("y","".concat(-n.length/2+.5,"em")).attr("dy","".concat(a,"em")).text(t)}))}))})).attr("display","initial").attr("transform",(t=>{let{x:e,y:n,height:a}=t;return"translate(".concat(e,", ").concat(n-(0,u.jF)({height:a}),") scale(").concat(a*i.N7,")")})).on("click",(function(t,e){a&&a(e)})).on("mouseenter",(function(t,e){r.Ltv(this).select(".circlet").classed("active")||r.Ltv(this).select("circle").attr("display","initial"),s&&s(e)})).on("mouseleave",(function(t,e){r.Ltv(this).select(".circlet").classed("active")||r.Ltv(this).select("circle").attr("display","none"),o&&o(e)}))}[h,f]=g.then?(await g)():g,a()}catch(v){a(v)}}))}}]);
//# sourceMappingURL=805.3c9c531a.chunk.js.map